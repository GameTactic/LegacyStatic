var $jscomp={scope:{},getGlobal:function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global?global:b}};$jscomp.global=$jscomp.getGlobal(this);$jscomp.patches={};$jscomp.patch=function(b,a){($jscomp.patches[b]=$jscomp.patches[b]||[]).push(a);for(var m=$jscomp.global,d=b.split("."),f=0;f<d.length-1&&m;f++)m=m[d[f]];d=d[d.length-1];m&&m[d]instanceof Function&&(m[d]=a(m[d]))};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};if(!$jscomp.global.Symbol){$jscomp.global.Symbol=$jscomp.Symbol;var b=[],a=function(a){return function(d){b=[];d=a(d);for(var f=[],k=0,n=d.length;k<n;k++){var h;a:if(h=d[k],h.length<$jscomp.SYMBOL_PREFIX.length)h=!1;else{for(var e=0;e<$jscomp.SYMBOL_PREFIX.length;e++)if(h[e]!=$jscomp.SYMBOL_PREFIX[e]){h=!1;break a}h=!0}h?b.push(d[k]):f.push(d[k])}return f}};$jscomp.patch("Object.keys",a);$jscomp.patch("Object.getOwnPropertyNames",a);$jscomp.patch("Object.getOwnPropertySymbols",
function(m){return function(d){a.unused=Object.getOwnPropertyNames(d);b.push.apply(m(d));return b}})}};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(b){return $jscomp.SYMBOL_PREFIX+b+$jscomp.symbolCounter_++};$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();$jscomp.global.Symbol.iterator||($jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));$jscomp.initSymbolIterator=function(){}};
(function(b){var a=function(a,b){this.init("simplecolorpicker",a,b)};a.prototype={constructor:a,init:function(a,d,f){var k=this;k.type=a;k.$select=b(d);k.$select.hide();k.options=b.extend({},b.fn.simplecolorpicker.defaults,f);k.$colorList=null;!0===k.options.picker?(a=k.$select.find("> option:selected").text(),k.$icon=b('<span class="simplecolorpicker icon" title="'+a+'" style="background-color: '+k.$select.val()+';" role="button" tabindex="0"></span>').insertAfter(k.$select),k.$icon.on("click."+
k.type,b.proxy(k.showPicker,k)),k.$picker=b('<span class="simplecolorpicker picker '+k.options.theme+'"></span>').appendTo(document.body),k.$colorList=k.$picker,b(document).on("mousedown."+k.type,b.proxy(k.hidePicker,k)),k.$picker.on("mousedown."+k.type,b.proxy(k.mousedown,k))):(k.$inline=b('<span class="simplecolorpicker inline '+k.options.theme+'"></span>').insertAfter(k.$select),k.$colorList=k.$inline);k.$select.find("> option").each(function(){var a=b(this),h=a.val(),e=a.is(":selected"),g=a.is(":disabled"),
c="";!0===e&&(c=" data-selected");e="";!0===g&&(e=" data-disabled");var p="";!1===g&&(p=' title="'+a.text()+'"');var y="";!1===g&&(y=' role="button" tabindex="0"');h=b('<span class="color"'+p+' style="background-color: '+h+';" data-color="'+h+'"'+c+e+y+"></span>");k.$colorList.append(h);h.on("click."+k.type,b.proxy(k.colorSpanClicked,k));!0===a.next().is("optgroup")&&k.$colorList.append('<span class="vr"></span>')})},selectColor:function(a){var d=this.$colorList.find("> span.color").filter(function(){return b(this).data("color").toLowerCase()===
a.toLowerCase()});0<d.length?this.selectColorSpan(d):console.error("The given color '"+a+"' could not be found")},showPicker:function(){var a=this.$icon.offset();this.$picker.css({left:a.left-6,top:a.top+this.$icon.outerHeight()});this.$picker.show(this.options.pickerDelay)},hidePicker:function(){this.$picker.hide(this.options.pickerDelay)},selectColorSpan:function(a){var b=a.data("color"),f=a.prop("title");a.siblings().removeAttr("data-selected");a.attr("data-selected","");!0===this.options.picker&&
(this.$icon.css("background-color",b),this.$icon.prop("title",f),this.hidePicker());this.$select.val(b)},colorSpanClicked:function(a){!1===b(a.target).is("[data-disabled]")&&(this.selectColorSpan(b(a.target)),this.$select.trigger("change"))},mousedown:function(a){a.stopPropagation();a.preventDefault()},destroy:function(){!0===this.options.picker&&(this.$icon.off("."+this.type),this.$icon.remove(),b(document).off("."+this.type));this.$colorList.off("."+this.type);this.$colorList.remove();this.$select.removeData(this.type);
this.$select.show()}};b.fn.simplecolorpicker=function(m){var d=b.makeArray(arguments);d.shift();return this.each(function(){var f=b(this),k=f.data("simplecolorpicker"),n="object"===typeof m&&m;void 0===k&&f.data("simplecolorpicker",k=new a(this,n));"string"===typeof m&&k[m].apply(k,d)})};b.fn.simplecolorpicker.defaults={theme:"",picker:!1,pickerDelay:0}})(jQuery);/*
: http://creativecommons.org/publicdomain/zero/1.0/
*/
(function(b){"object"===typeof exports&&"undefined"!==typeof module?module.exports=b():"function"===typeof define&&define.amd?define([],b):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).PIXI=b()})(function(){return function a(b,d,f){function k(e,g){if(!d[e]){if(!b[e]){var c="function"==typeof require&&require;if(!g&&c)return c(e,!0);if(n)return n(e,!0);c=Error("Cannot find module '"+e+"'");throw c.code="MODULE_NOT_FOUND",c;}c=d[e]={exports:{}};
b[e][0].call(c.exports,function(g){var c=b[e][1][g];return k(c?c:g)},c,c.exports,a,b,d,f)}return d[e].exports}for(var n="function"==typeof require&&require,h=0;h<f.length;h++)k(f[h]);return k}({1:[function(a,b,d){function f(a){var h=32;(a&=-a)&&h--;a&65535&&(h-=16);a&16711935&&(h-=8);a&252645135&&(h-=4);a&858993459&&(h-=2);a&1431655765&&--h;return h}"use restrict";d.INT_BITS=32;d.INT_MAX=2147483647;d.INT_MIN=-2147483648;d.sign=function(a){return(0<a)-(0>a)};d.abs=function(a){var h=a>>31;return(a^
h)-h};d.min=function(a,h){return h^(a^h)&-(a<h)};d.max=function(a,h){return a^(a^h)&-(a<h)};d.isPow2=function(a){return!(a&a-1)&&!!a};d.log2=function(a){var h,e;h=(65535<a)<<4;a>>>=h;e=(255<a)<<3;a>>>=e;h|=e;e=(15<a)<<2;a>>>=e;h|=e;e=(3<a)<<1;return h|e|a>>>e>>1};d.log10=function(a){return 1E9<=a?9:1E8<=a?8:1E7<=a?7:1E6<=a?6:1E5<=a?5:1E4<=a?4:1E3<=a?3:100<=a?2:10<=a?1:0};d.popCount=function(a){a-=a>>>1&1431655765;a=(a&858993459)+(a>>>2&858993459);return 16843009*(a+(a>>>4)&252645135)>>>24};d.countTrailingZeros=
f;d.nextPow2=function(a){a+=0===a;--a;a|=a>>>1;a|=a>>>2;a|=a>>>4;a|=a>>>8;return(a|a>>>16)+1};d.prevPow2=function(a){a|=a>>>1;a|=a>>>2;a|=a>>>4;a|=a>>>8;a|=a>>>16;return a-(a>>>1)};d.parity=function(a){a^=a>>>16;a^=a>>>8;return 27030>>>((a^a>>>4)&15)&1};var k=Array(256);(function(a){for(var h=0;256>h;++h){for(var e=h,g=h,c=7,e=e>>>1;e;e>>>=1)g<<=1,g|=e&1,--c;a[h]=g<<c&255}})(k);d.reverse=function(a){return k[a&255]<<24|k[a>>>8&255]<<16|k[a>>>16&255]<<8|k[a>>>24&255]};d.interleave2=function(a,h){a&=
65535;a=(a|a<<8)&16711935;a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;h&=65535;h=(h|h<<8)&16711935;h=(h|h<<4)&252645135;h=(h|h<<2)&858993459;return(a|a<<1)&1431655765|((h|h<<1)&1431655765)<<1};d.deinterleave2=function(a,h){a=a>>>h&1431655765;a=(a|a>>>1)&858993459;a=(a|a>>>2)&252645135;a=(a|a>>>4)&16711935;return((a|a>>>16)&65535)<<16>>16};d.interleave3=function(a,h,e){a&=1023;a=(a|a<<16)&4278190335;a=(a|a<<8)&251719695;a=(a|a<<4)&3272356035;h&=1023;h=(h|h<<16)&4278190335;h=(h|h<<8)&251719695;h=(h|h<<
4)&3272356035;e&=1023;e=(e|e<<16)&4278190335;e=(e|e<<8)&251719695;e=(e|e<<4)&3272356035;return(a|a<<2)&1227133513|((h|h<<2)&1227133513)<<1|((e|e<<2)&1227133513)<<2};d.deinterleave3=function(a,h){a=a>>>h&1227133513;a=(a|a>>>2)&3272356035;a=(a|a>>>4)&251719695;a=(a|a>>>8)&4278190335;return((a|a>>>16)&1023)<<22>>22};d.nextCombination=function(a){var h=a|a-1;return h+1|(~h&-~h)-1>>>f(a)+1}},{}],2:[function(a,b,d){function f(a,c,b){b=b||2;var q=c&&c.length,y=q?c[0]*b:a.length,f=k(a,0,y,b,!0),m=[];if(!f)return m;
var d,A,z,t;if(q){var r=b,q=[],x,u,w;t=0;for(x=c.length;t<x;t++)u=c[t]*r,w=t<x-1?c[t+1]*r:a.length,u=k(a,u,w,r,!1),u===u.next&&(u.steiner=!0),q.push(p(u));q.sort(e);for(t=0;t<q.length;t++){c=q[t];r=f;if(r=g(c,r))c=v(r,c),n(c,c.next);f=n(f,f.next)}}if(a.length>80*b){d=z=a[0];A=q=a[1];for(r=b;r<y;r+=b)t=a[r],c=a[r+1],t<d&&(d=t),c<A&&(A=c),t>z&&(z=t),c>q&&(q=c);z=Math.max(z-d,q-A)}h(f,m,b,d,A,z);return m}function k(a,g,c,e,h){var p;if(h===0<w(a,g,c,e))for(h=g;h<c;h+=e)p=r(h,a[h],a[h+1],p);else for(h=
c-e;h>=g;h-=e)p=r(h,a[h],a[h+1],p);p&&A(p,p.next)&&(x(p),p=p.next);return p}function n(a,g){if(!a)return a;g||(g=a);var c=a,e;do if(e=!1,c.steiner||!A(c,c.next)&&0!==q(c.prev,c,c.next))c=c.next;else{x(c);c=g=c.prev;if(c===c.next)return null;e=!0}while(e||c!==g);return g}function h(a,g,e,p,b,f,k){if(a){if(!k&&f){var m=a,d=m;do null===d.z&&(d.z=c(d.x,d.y,p,b,f)),d.prevZ=d.prev,d=d.nextZ=d.next;while(d!==m);d.prevZ.nextZ=null;d.prevZ=null;var m=d,r,u,w,E,D,Q,J=1;do{d=m;w=m=null;for(E=0;d;){E++;u=d;for(r=
D=0;r<J&&(D++,u=u.nextZ,u);r++);for(Q=J;0<D||0<Q&&u;)0===D?(r=u,u=u.nextZ,Q--):0!==Q&&u?d.z<=u.z?(r=d,d=d.nextZ,D--):(r=u,u=u.nextZ,Q--):(r=d,d=d.nextZ,D--),w?w.nextZ=r:m=r,r.prevZ=w,w=r;d=u}w.nextZ=null;J*=2}while(1<E)}for(m=a;a.prev!==a.next;){d=a.prev;u=a.next;if(f)a:{w=a;Q=p;var M=b,S=f;E=w.prev;D=w;J=w.next;if(0<=q(E,D,J))w=!1;else{var T=E.x>D.x?E.x>J.x?E.x:J.x:D.x>J.x?D.x:J.x,U=E.y>D.y?E.y>J.y?E.y:J.y:D.y>J.y?D.y:J.y;r=c(E.x<D.x?E.x<J.x?E.x:J.x:D.x<J.x?D.x:J.x,E.y<D.y?E.y<J.y?E.y:J.y:D.y<J.y?
D.y:J.y,Q,M,S);Q=c(T,U,Q,M,S);for(M=w.nextZ;M&&M.z<=Q;){if(M!==w.prev&&M!==w.next&&y(E.x,E.y,D.x,D.y,J.x,J.y,M.x,M.y)&&0<=q(M.prev,M,M.next)){w=!1;break a}M=M.nextZ}for(M=w.prevZ;M&&M.z>=r;){if(M!==w.prev&&M!==w.next&&y(E.x,E.y,D.x,D.y,J.x,J.y,M.x,M.y)&&0<=q(M.prev,M,M.next)){w=!1;break a}M=M.prevZ}w=!0}}else a:if(w=a,E=w.prev,D=w,J=w.next,0<=q(E,D,J))w=!1;else{for(r=w.next.next;r!==w.prev;){if(y(E.x,E.y,D.x,D.y,J.x,J.y,r.x,r.y)&&0<=q(r.prev,r,r.next)){w=!1;break a}r=r.next}w=!0}if(w)g.push(d.i/e),
g.push(a.i/e),g.push(u.i/e),x(a),m=a=u.next;else if(a=u,a===m){if(!k)h(n(a),g,e,p,b,f,1);else if(1===k){k=g;m=e;d=a;do u=d.prev,w=d.next.next,!A(u,w)&&z(u,d,d.next,w)&&t(u,w)&&t(w,u)&&(k.push(u.i/m),k.push(d.i/m),k.push(w.i/m),x(d),x(d.next),d=a=w),d=d.next;while(d!==a);a=d;h(a,g,e,p,b,f,2)}else if(2===k)a:{k=a;do{for(m=k.next.next;m!==k.prev;){if(d=k.i!==m.i){d=k;u=m;if(w=d.next.i!==u.i&&d.prev.i!==u.i){b:{w=d;do{if(w.i!==d.i&&w.next.i!==d.i&&w.i!==u.i&&w.next.i!==u.i&&z(w,w.next,d,u)){w=!0;break b}w=
w.next}while(w!==d);w=!1}w=!w}if(w=w&&t(d,u)&&t(u,d)){w=d;E=!1;D=(d.x+u.x)/2;u=(d.y+u.y)/2;do w.y>u!==w.next.y>u&&D<(w.next.x-w.x)*(u-w.y)/(w.next.y-w.y)+w.x&&(E=!E),w=w.next;while(w!==d);w=E}d=w}if(d){a=v(k,m);k=n(k,k.next);a=n(a,a.next);h(k,g,e,p,b,f);h(a,g,e,p,b,f);break a}m=m.next}k=k.next}while(k!==a)}break}}}}function e(a,g){return a.x-g.x}function g(a,g){var c=g,e=a.x,h=a.y,p=-Infinity,n;do{if(h<=c.y&&h>=c.next.y){var b=c.x+(h-c.y)*(c.next.x-c.x)/(c.next.y-c.y);if(b<=e&&b>p){p=b;if(b===e){if(h===
c.y)return c;if(h===c.next.y)return c.next}n=c.x<c.next.x?c:c.next}}c=c.next}while(c!==g);if(!n)return null;if(e===p)return n.prev;for(var b=n,q=n.x,f=n.y,d=Infinity,k,c=n.next;c!==b;)e>=c.x&&c.x>=q&&y(h<f?e:p,h,q,f,h<f?p:e,h,c.x,c.y)&&(k=Math.abs(h-c.y)/(e-c.x),(k<d||k===d&&c.x>n.x)&&t(c,a)&&(n=c,d=k)),c=c.next;return n}function c(a,c,g,e,h){a=32767*(a-g)/h;c=32767*(c-e)/h;a=(a|a<<8)&16711935;a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;c=(c|c<<8)&16711935;c=(c|c<<4)&252645135;c=(c|c<<2)&858993459;
return(a|a<<1)&1431655765|((c|c<<1)&1431655765)<<1}function p(a){var c=a,g=a;do c.x<g.x&&(g=c),c=c.next;while(c!==a);return g}function y(a,c,g,e,h,p,n,b){return 0<=(h-n)*(c-b)-(a-n)*(p-b)&&0<=(a-n)*(e-b)-(g-n)*(c-b)&&0<=(g-n)*(p-b)-(h-n)*(e-b)}function q(a,c,g){return(c.y-a.y)*(g.x-c.x)-(c.x-a.x)*(g.y-c.y)}function A(a,c){return a.x===c.x&&a.y===c.y}function z(a,c,g,e){return A(a,c)&&A(g,e)||A(a,e)&&A(g,c)?!0:0<q(a,c,g)!==0<q(a,c,e)&&0<q(g,e,a)!==0<q(g,e,c)}function t(a,c){return 0>q(a.prev,a,a.next)?
0<=q(a,c,a.next)&&0<=q(a,a.prev,c):0>q(a,c,a.prev)||0>q(a,a.next,c)}function v(a,c){var g=new u(a.i,a.x,a.y),e=new u(c.i,c.x,c.y),h=a.next,p=c.prev;a.next=c;c.prev=a;g.next=h;h.prev=g;e.next=g;g.prev=e;p.next=e;e.prev=p;return e}function r(a,c,g,e){a=new u(a,c,g);e?(a.next=e.next,a.prev=e,e.next.prev=a,e.next=a):(a.prev=a,a.next=a);return a}function x(a){a.next.prev=a.prev;a.prev.next=a.next;a.prevZ&&(a.prevZ.nextZ=a.nextZ);a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function u(a,c,g){this.i=a;this.x=c;this.y=
g;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}function w(a,c,g,e){for(var h=0,p=g-e;c<g;c+=e)h+=(a[p]-a[c])*(a[c+1]+a[p+1]),p=c;return h}b.exports=f;f.deviation=function(a,c,g,e){var h=c&&c.length,p=Math.abs(w(a,0,h?c[0]*g:a.length,g));if(h)for(var h=0,n=c.length;h<n;h++)p-=Math.abs(w(a,c[h]*g,h<n-1?c[h+1]*g:a.length,g));for(h=c=0;h<e.length;h+=3){var n=e[h]*g,b=e[h+1]*g,q=e[h+2]*g;c+=Math.abs((a[n]-a[q])*(a[b+1]-a[n+1])-(a[n]-a[b])*(a[q+1]-a[n+1]))}return 0===p&&0===c?0:
Math.abs((c-p)/p)};f.flatten=function(a){for(var c=a[0][0].length,g={vertices:[],holes:[],dimensions:c},e=0,h=0;h<a.length;h++){for(var p=0;p<a[h].length;p++)for(var n=0;n<c;n++)g.vertices.push(a[h][p][n]);0<h&&(e+=a[h-1].length,g.holes.push(e))}return g}},{}],3:[function(a,b,d){function f(){}function k(a,c,e){this.fn=a;this.context=c;this.once=e||!1}function n(){this._events=new f;this._eventsCount=0}var h=Object.prototype.hasOwnProperty,e="~";Object.create&&(f.prototype=Object.create(null),(new f).__proto__||
(e=!1));n.prototype.eventNames=function(){var a=[],c,p;if(0===this._eventsCount)return a;for(p in c=this._events)h.call(c,p)&&a.push(e?p.slice(1):p);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(c)):a};n.prototype.listeners=function(a,c){var h=this._events[e?e+a:a];if(c)return!!h;if(!h)return[];if(h.fn)return[h.fn];for(var n=0,b=h.length,f=Array(b);n<b;n++)f[n]=h[n].fn;return f};n.prototype.emit=function(a,c,h,n,b,f){var d=e?e+a:a;if(!this._events[d])return!1;var d=this._events[d],
k=arguments.length,m,r;if(d.fn){d.once&&this.removeListener(a,d.fn,void 0,!0);switch(k){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,c),!0;case 3:return d.fn.call(d.context,c,h),!0;case 4:return d.fn.call(d.context,c,h,n),!0;case 5:return d.fn.call(d.context,c,h,n,b),!0;case 6:return d.fn.call(d.context,c,h,n,b,f),!0}r=1;for(m=Array(k-1);r<k;r++)m[r-1]=arguments[r];d.fn.apply(d.context,m)}else{var x=d.length,u;for(r=0;r<x;r++)switch(d[r].once&&this.removeListener(a,d[r].fn,
void 0,!0),k){case 1:d[r].fn.call(d[r].context);break;case 2:d[r].fn.call(d[r].context,c);break;case 3:d[r].fn.call(d[r].context,c,h);break;case 4:d[r].fn.call(d[r].context,c,h,n);break;default:if(!m)for(u=1,m=Array(k-1);u<k;u++)m[u-1]=arguments[u];d[r].fn.apply(d[r].context,m)}}return!0};n.prototype.on=function(a,c,h){c=new k(c,h||this);a=e?e+a:a;this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],c]:this._events[a].push(c):(this._events[a]=c,this._eventsCount++);return this};n.prototype.once=
function(a,c,h){c=new k(c,h||this,!0);a=e?e+a:a;this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],c]:this._events[a].push(c):(this._events[a]=c,this._eventsCount++);return this};n.prototype.removeListener=function(a,c,h,n){a=e?e+a:a;if(!this._events[a])return this;if(!c)return 0===--this._eventsCount?this._events=new f:delete this._events[a],this;var b=this._events[a];if(b.fn)b.fn!==c||n&&!b.once||h&&b.context!==h||(0===--this._eventsCount?this._events=new f:delete this._events[a]);
else{for(var d=0,k=[],m=b.length;d<m;d++)(b[d].fn!==c||n&&!b[d].once||h&&b[d].context!==h)&&k.push(b[d]);k.length?this._events[a]=1===k.length?k[0]:k:0===--this._eventsCount?this._events=new f:delete this._events[a]}return this};n.prototype.removeAllListeners=function(a){a?(a=e?e+a:a,this._events[a]&&(0===--this._eventsCount?this._events=new f:delete this._events[a])):(this._events=new f,this._eventsCount=0);return this};n.prototype.off=n.prototype.removeListener;n.prototype.addListener=n.prototype.on;
n.prototype.setMaxListeners=function(){return this};n.prefixed=e;n.EventEmitter=n;"undefined"!==typeof b&&(b.exports=n)},{}],4:[function(a,b,d){(function(a){var d=/iPhone/i,n=/iPod/i,h=/iPad/i,e=/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,g=/Android/i,c=/(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i,p=/(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i,y=/IEMobile/i,q=/(?=.*\bWindows\b)(?=.*\bARM\b)/i,A=/BlackBerry/i,z=/BB10/i,t=/Opera Mini/i,v=
/(CriOS|Chrome)(?=.*\bMobile\b)/i,r=/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,x=/(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)/i,u=function(a){a=a||navigator.userAgent;var b=a.split("[FBAN");"undefined"!==typeof b[1]&&(a=b[0]);b=a.split("Twitter");"undefined"!==typeof b[1]&&(a=b[0]);this.apple={phone:d.test(a),ipod:n.test(a),tablet:!d.test(a)&&h.test(a),device:d.test(a)||n.test(a)||h.test(a)};this.amazon={phone:c.test(a),tablet:!c.test(a)&&p.test(a),device:c.test(a)||p.test(a)};this.android={phone:c.test(a)||
e.test(a),tablet:!c.test(a)&&!e.test(a)&&(p.test(a)||g.test(a)),device:c.test(a)||p.test(a)||e.test(a)||g.test(a)};this.windows={phone:y.test(a),tablet:q.test(a),device:y.test(a)||q.test(a)};this.other={blackberry:A.test(a),blackberry10:z.test(a),opera:t.test(a),firefox:r.test(a),chrome:v.test(a),device:A.test(a)||z.test(a)||t.test(a)||r.test(a)||v.test(a)};this.seven_inch=x.test(a);this.any=this.apple.device||this.android.device||this.windows.device||this.other.device||this.seven_inch;this.phone=
this.apple.phone||this.android.phone||this.windows.phone;this.tablet=this.apple.tablet||this.android.tablet||this.windows.tablet;if("undefined"===typeof window)return this},w=function(){var a=new u;a.Class=u;return a};"undefined"!==typeof b&&b.exports&&"undefined"===typeof window?b.exports=u:"undefined"!==typeof b&&b.exports&&"undefined"!==typeof window?b.exports=w():a.isMobile=w()})(this)},{}],5:[function(a,b,d){var f=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable;b.exports=
function(){try{if(!Object.assign)return!1;var a=new String("abc");a[5]="de";if("5"===Object.getOwnPropertyNames(a)[0])return!1;for(var h={},a=0;10>a;a++)h["_"+String.fromCharCode(a)]=a;if("0123456789"!==Object.getOwnPropertyNames(h).map(function(a){return h[a]}).join(""))return!1;var e={};"abcdefghijklmnopqrst".split("").forEach(function(a){e[a]=a});return"abcdefghijklmnopqrst"!==Object.keys(Object.assign({},e)).join("")?!1:!0}catch(g){return!1}}()?Object.assign:function(a,h){var e,g;if(null===a||
void 0===a)throw new TypeError("Object.assign cannot be called with null or undefined");g=Object(a);for(var c,p=1;p<arguments.length;p++){e=Object(arguments[p]);for(var b in e)f.call(e,b)&&(g[b]=e[b]);if(Object.getOwnPropertySymbols){c=Object.getOwnPropertySymbols(e);for(var q=0;q<c.length;q++)k.call(e,c[q])&&(g[c[q]]=e[c[q]])}}return g}},{}],6:[function(a,b,d){var f=new ArrayBuffer(0),k=function(a,h,e,g){this.gl=a;this.buffer=a.createBuffer();this.type=h||a.ARRAY_BUFFER;this.drawType=g||a.STATIC_DRAW;
this.data=f;e&&this.upload(e)};k.prototype.upload=function(a,h,e){e||this.bind();e=this.gl;a=a||this.data;this.data.byteLength>=a.byteLength?e.bufferSubData(this.type,h||0,a):e.bufferData(this.type,a,this.drawType);this.data=a};k.prototype.bind=function(){this.gl.bindBuffer(this.type,this.buffer)};k.createVertexBuffer=function(a,h,e){return new k(a,a.ARRAY_BUFFER,h,e)};k.createIndexBuffer=function(a,h,e){return new k(a,a.ELEMENT_ARRAY_BUFFER,h,e)};k.create=function(a,h,e,g){return new k(a,h,g)};k.prototype.destroy=
function(){this.gl.deleteBuffer(this.buffer)};b.exports=k},{}],7:[function(a,b,d){var f=a("./GLTexture"),k=function(a,h,e){this.gl=a;this.framebuffer=a.createFramebuffer();this.texture=this.stencil=null;this.width=h||100;this.height=e||100};k.prototype.enableTexture=function(a){var h=this.gl;this.texture=a||new f(h);this.texture.bind();this.bind();h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,this.texture.texture,0)};k.prototype.enableStencil=function(){if(!this.stencil){var a=
this.gl;this.stencil=a.createRenderbuffer();a.bindRenderbuffer(a.RENDERBUFFER,this.stencil);a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,this.stencil);a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_STENCIL,this.width,this.height)}};k.prototype.clear=function(a,h,e,g){this.bind();var c=this.gl;c.clearColor(a,h,e,g);c.clear(c.COLOR_BUFFER_BIT)};k.prototype.bind=function(){var a=this.gl;this.texture&&this.texture.unbind();a.bindFramebuffer(a.FRAMEBUFFER,this.framebuffer)};
k.prototype.unbind=function(){var a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,null)};k.prototype.resize=function(a,h){var e=this.gl;this.width=a;this.height=h;this.texture&&this.texture.uploadData(null,a,h);this.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,this.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,a,h))};k.prototype.destroy=function(){var a=this.gl;this.texture&&this.texture.destroy();a.deleteFramebuffer(this.framebuffer);this.texture=this.stencil=this.gl=null};k.createRGBA=
function(a,h,e){var g=f.fromData(a,null,h,e);g.enableNearestScaling();g.enableWrapClamp();a=new k(a,h,e);a.enableTexture(g);a.unbind();return a};k.createFloat32=function(a,h,e,g){g=new f.fromData(a,g,h,e);g.enableNearestScaling();g.enableWrapClamp();a=new k(a,h,e);a.enableTexture(g);a.unbind();return a};b.exports=k},{"./GLTexture":9}],8:[function(a,b,d){var f=a("./shader/compileProgram"),k=a("./shader/extractAttributes"),n=a("./shader/extractUniforms"),h=a("./shader/generateUniformAccessObject");
a=function(a,g,c){this.gl=a;this.program=f(a,g,c);this.attributes=k(a,this.program);g=n(a,this.program);this.uniforms=h(a,g)};a.prototype.bind=function(){this.gl.useProgram(this.program)};a.prototype.destroy=function(){};b.exports=a},{"./shader/compileProgram":14,"./shader/extractAttributes":16,"./shader/extractUniforms":17,"./shader/generateUniformAccessObject":18}],9:[function(a,b,d){var f=function(a,h,e,g,c){this.gl=a;this.texture=a.createTexture();this.premultiplyAlpha=this.mipmap=!1;this.width=
h||0;this.height=e||0;this.format=g||a.RGBA;this.type=c||a.UNSIGNED_BYTE};f.prototype.upload=function(a){this.bind();var h=this.gl;this.width=a.videoWidth||a.width;this.height=a.videoHeight||a.height;h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha);h.texImage2D(h.TEXTURE_2D,0,this.format,this.format,this.type,a)};var k=!1;f.prototype.uploadData=function(a,h,e){this.bind();var g=this.gl;this.width=h||this.width;this.height=e||this.height;if(a instanceof Float32Array){if(!k)if(g.getExtension("OES_texture_float"))k=
!0;else throw Error("floating point textures not available");this.type=g.FLOAT}else this.type=g.UNSIGNED_BYTE;g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha);g.texImage2D(g.TEXTURE_2D,0,this.format,this.width,this.height,0,this.format,this.type,a||null)};f.prototype.bind=function(a){var h=this.gl;void 0!==a&&h.activeTexture(h.TEXTURE0+a);h.bindTexture(h.TEXTURE_2D,this.texture)};f.prototype.unbind=function(){var a=this.gl;a.bindTexture(a.TEXTURE_2D,null)};f.prototype.minFilter=
function(a){var h=this.gl;this.bind();this.mipmap?h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,a?h.LINEAR_MIPMAP_LINEAR:h.NEAREST_MIPMAP_NEAREST):h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,a?h.LINEAR:h.NEAREST)};f.prototype.magFilter=function(a){var h=this.gl;this.bind();h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,a?h.LINEAR:h.NEAREST)};f.prototype.enableMipmap=function(){var a=this.gl;this.bind();this.mipmap=!0;a.generateMipmap(a.TEXTURE_2D)};f.prototype.enableLinearScaling=function(){this.minFilter(!0);
this.magFilter(!0)};f.prototype.enableNearestScaling=function(){this.minFilter(!1);this.magFilter(!1)};f.prototype.enableWrapClamp=function(){var a=this.gl;this.bind();a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE)};f.prototype.enableWrapRepeat=function(){var a=this.gl;this.bind();a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT)};f.prototype.enableWrapMirrorRepeat=
function(){var a=this.gl;this.bind();a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.MIRRORED_REPEAT);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.MIRRORED_REPEAT)};f.prototype.destroy=function(){this.gl.deleteTexture(this.texture)};f.fromSource=function(a,h,e){a=new f(a);a.premultiplyAlpha=e||!1;a.upload(h);return a};f.fromData=function(a,h,e,g){a=new f(a);a.uploadData(h,e,g);return a};b.exports=f},{}],10:[function(a,b,d){function f(a,h){this.nativeVaoExtension=null;f.FORCE_NATIVE||(this.nativeVaoExtension=
a.getExtension("OES_vertex_array_object")||a.getExtension("MOZ_OES_vertex_array_object")||a.getExtension("WEBKIT_OES_vertex_array_object"));this.nativeState=h;if(this.nativeVaoExtension){this.nativeVao=this.nativeVaoExtension.createVertexArrayOES();var e=a.getParameter(a.MAX_VERTEX_ATTRIBS);this.nativeState={tempAttribState:Array(e),attribState:Array(e)}}this.gl=a;this.attributes=[];this.indexBuffer=null;this.dirty=!1}var k=a("./setVertexAttribArrays");f.prototype.constructor=f;b.exports=f;f.FORCE_NATIVE=
!1;f.prototype.bind=function(){this.nativeVao?(this.nativeVaoExtension.bindVertexArrayOES(this.nativeVao),this.dirty&&(this.dirty=!1,this.activate())):this.activate();return this};f.prototype.unbind=function(){this.nativeVao&&this.nativeVaoExtension.bindVertexArrayOES(null);return this};f.prototype.activate=function(){for(var a=this.gl,h=null,e=0;e<this.attributes.length;e++){var g=this.attributes[e];h!==g.buffer&&(g.buffer.bind(),h=g.buffer);a.vertexAttribPointer(g.attribute.location,g.attribute.size,
g.type||a.FLOAT,g.normalized||!1,g.stride||0,g.start||0)}k(a,this.attributes,this.nativeState);this.indexBuffer.bind();return this};f.prototype.addAttribute=function(a,h,e,g,c,p){this.attributes.push({buffer:a,attribute:h,location:h.location,type:e||this.gl.FLOAT,normalized:g||!1,stride:c||0,start:p||0});this.dirty=!0;return this};f.prototype.addIndex=function(a){this.indexBuffer=a;this.dirty=!0;return this};f.prototype.clear=function(){this.nativeVao&&this.nativeVaoExtension.bindVertexArrayOES(this.nativeVao);
this.attributes.length=0;this.indexBuffer=null;return this};f.prototype.draw=function(a,h,e){var g=this.gl;g.drawElements(a,h,g.UNSIGNED_SHORT,e||0);return this};f.prototype.destroy=function(){this.nativeState=this.attributes=this.indexBuffer=this.gl=null;this.nativeVao&&this.nativeVaoExtension.deleteVertexArrayOES(this.nativeVao);this.nativeVao=this.nativeVaoExtension=null}},{"./setVertexAttribArrays":13}],11:[function(a,b,d){b.exports=function(a,b){var n=a.getContext("webgl",b)||a.getContext("experimental-webgl",
b);if(!n)throw Error("This browser does not support webGL. Try using the canvas renderer");return n}},{}],12:[function(a,b,d){a={createContext:a("./createContext"),setVertexAttribArrays:a("./setVertexAttribArrays"),GLBuffer:a("./GLBuffer"),GLFramebuffer:a("./GLFramebuffer"),GLShader:a("./GLShader"),GLTexture:a("./GLTexture"),VertexArrayObject:a("./VertexArrayObject"),shader:a("./shader")};"undefined"!==typeof b&&b.exports&&(b.exports=a);"undefined"!==typeof window&&(window.pixi={gl:a})},{"./GLBuffer":6,
"./GLFramebuffer":7,"./GLShader":8,"./GLTexture":9,"./VertexArrayObject":10,"./createContext":11,"./setVertexAttribArrays":13,"./shader":19}],13:[function(a,b,d){b.exports=function(a,b,n){var h;if(n){var e=n.tempAttribState,g=n.attribState;for(h=0;h<e.length;h++)e[h]=!1;for(h=0;h<b.length;h++)e[b[h].attribute.location]=!0;for(h=0;h<g.length;h++)g[h]!==e[h]&&(g[h]=e[h],n.attribState[h]?a.enableVertexAttribArray(h):a.disableVertexAttribArray(h))}else for(h=0;h<b.length;h++)a.enableVertexAttribArray(b[h].attribute.location)}},
{}],14:[function(a,b,d){var f=function(a,n,h){n=a.createShader(n);a.shaderSource(n,h);a.compileShader(n);return a.getShaderParameter(n,a.COMPILE_STATUS)?n:(console.log(a.getShaderInfoLog(n)),null)};b.exports=function(a,n,h){n=f(a,a.VERTEX_SHADER,n);h=f(a,a.FRAGMENT_SHADER,h);var e=a.createProgram();a.attachShader(e,n);a.attachShader(e,h);a.linkProgram(e);a.getProgramParameter(e,a.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",a.getProgramParameter(e,
a.VALIDATE_STATUS)),console.error("gl.getError()",a.getError()),""!==a.getProgramInfoLog(e)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",a.getProgramInfoLog(e)),a.deleteProgram(e),e=null);a.deleteShader(n);a.deleteShader(h);return e}},{}],15:[function(a,b,d){var f=function(a){a=Array(a);for(var n=0;n<a.length;n++)a[n]=!1;return a};b.exports=function(a,n){switch(a){case "float":return 0;case "vec2":return new Float32Array(2*n);case "vec3":return new Float32Array(3*n);case "vec4":return new Float32Array(4*
n);case "int":case "sampler2D":return 0;case "ivec2":return new Int32Array(2*n);case "ivec3":return new Int32Array(3*n);case "ivec4":return new Int32Array(4*n);case "bool":return!1;case "bvec2":return f(2*n);case "bvec3":return f(3*n);case "bvec4":return f(4*n);case "mat2":return new Float32Array([1,0,0,1]);case "mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case "mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}}},{}],16:[function(a,b,d){var f=a("./mapType"),k=a("./mapSize"),
n=function(a,e,g,c){gl.vertexAttribPointer(this.location,this.size,a||gl.FLOAT,e||!1,g||0,c||0)};b.exports=function(a,e){for(var g={},c=a.getProgramParameter(e,a.ACTIVE_ATTRIBUTES),p=0;p<c;p++){var b=a.getActiveAttrib(e,p),q=f(a,b.type);g[b.name]={type:q,size:k(q),location:a.getAttribLocation(e,b.name),pointer:n}}return g}},{"./mapSize":20,"./mapType":21}],17:[function(a,b,d){var f=a("./mapType"),k=a("./defaultValue");b.exports=function(a,h){for(var e={},g=a.getProgramParameter(h,a.ACTIVE_UNIFORMS),
c=0;c<g;c++){var p=a.getActiveUniform(h,c),b=p.name.replace(/\[.*?\]/,""),q=f(a,p.type);e[b]={type:q,size:p.size,location:a.getUniformLocation(h,b),value:k(q,p.size)}}return e}},{"./defaultValue":15,"./mapType":21}],18:[function(a,b,d){var f=function(a){a=n.replace("%%",a);return new Function(a)},k=function(a,p){var n=h.replace(/%%/g,a),b;(b=1===p.size?e[p.type]:g[p.type])&&(n+="\nthis.gl."+b+";");return new Function("value",n)},n="return this.data.%%.value;",h="this.data.%%.value = value;\nvar location = this.data.%%.location;",
e={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",
bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},g={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",
ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"};b.exports=function(a,g){var e={data:{}};e.gl=a;for(var h=Object.keys(g),n=0;n<h.length;n++){for(var b=h[n],d=b.split("."),m=d[d.length-1],r=e,x=0;x<d.length-1;x++)var u=r[d[x]]||{data:{}},r=r[d[x]]=u;d=r;b=g[b];d.data[m]=b;d.gl=a;Object.defineProperty(d,
m,{get:f(m),set:k(m,b)})}return e}},{}],19:[function(a,b,d){b.exports={compileProgram:a("./compileProgram"),defaultValue:a("./defaultValue"),extractAttributes:a("./extractAttributes"),extractUniforms:a("./extractUniforms"),generateUniformAccessObject:a("./generateUniformAccessObject"),mapSize:a("./mapSize"),mapType:a("./mapType")}},{"./compileProgram":14,"./defaultValue":15,"./extractAttributes":16,"./extractUniforms":17,"./generateUniformAccessObject":18,"./mapSize":20,"./mapType":21}],20:[function(a,
b,d){var f={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};b.exports=function(a){return f[a]}},{}],21:[function(a,b,d){var f=null,k={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"};b.exports=function(a,
h){if(!f){var e=Object.keys(k);f={};for(var g=0;g<e.length;++g){var c=e[g];f[a[c]]=k[c]}}return f[h]}},{}],22:[function(a,b,d){(function(a){function b(a,c){for(var e=0,h=a.length-1;0<=h;h--){var n=a[h];"."===n?a.splice(h,1):".."===n?(a.splice(h,1),e++):e&&(a.splice(h,1),e--)}if(c)for(;e--;e)a.unshift("..");return a}function n(a,c){if(a.filter)return a.filter(c);for(var e=[],h=0;h<a.length;h++)c(a[h],h,a)&&e.push(a[h]);return e}var h=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;
d.resolve=function(){for(var g="",c=!1,e=arguments.length-1;-1<=e&&!c;e--){var h=0<=e?arguments[e]:a.cwd();if("string"!==typeof h)throw new TypeError("Arguments to path.resolve must be strings");h&&(g=h+"/"+g,c="/"===h.charAt(0))}g=b(n(g.split("/"),function(a){return!!a}),!c).join("/");return(c?"/":"")+g||"."};d.normalize=function(a){var c=d.isAbsolute(a),h="/"===e(a,-1);(a=b(n(a.split("/"),function(a){return!!a}),!c).join("/"))||c||(a=".");a&&h&&(a+="/");return(c?"/":"")+a};d.isAbsolute=function(a){return"/"===
a.charAt(0)};d.join=function(){var a=Array.prototype.slice.call(arguments,0);return d.normalize(n(a,function(a,g){if("string"!==typeof a)throw new TypeError("Arguments to path.join must be strings");return a}).join("/"))};d.relative=function(a,c){function e(a){for(var c=0;c<a.length&&""===a[c];c++);for(var g=a.length-1;0<=g&&""===a[g];g--);return c>g?[]:a.slice(c,g-c+1)}a=d.resolve(a).substr(1);c=d.resolve(c).substr(1);for(var h=e(a.split("/")),n=e(c.split("/")),b=Math.min(h.length,n.length),f=b,
k=0;k<b;k++)if(h[k]!==n[k]){f=k;break}b=[];for(k=f;k<h.length;k++)b.push("..");b=b.concat(n.slice(f));return b.join("/")};d.sep="/";d.delimiter=":";d.dirname=function(a){var c=h.exec(a).slice(1);a=c[0];c=c[1];if(!a&&!c)return".";c&&(c=c.substr(0,c.length-1));return a+c};d.basename=function(a,c){var e=h.exec(a).slice(1)[2];c&&e.substr(-1*c.length)===c&&(e=e.substr(0,e.length-c.length));return e};d.extname=function(a){return h.exec(a).slice(1)[3]};var e="b"==="ab".substr(-1)?function(a,c,e){return a.substr(c,
e)}:function(a,c,e){0>c&&(c=a.length+c);return a.substr(c,e)}}).call(this,a("_process"))},{_process:23}],23:[function(a,b,d){function f(){throw Error("setTimeout has not been defined");}function k(){throw Error("clearTimeout has not been defined");}function n(a){if(y===setTimeout)return setTimeout(a,0);if((y===f||!y)&&setTimeout)return y=setTimeout,setTimeout(a,0);try{return y(a,0)}catch(c){try{return y.call(null,a,0)}catch(g){return y.call(this,a,0)}}}function h(a){if(q===clearTimeout)return clearTimeout(a);
if((q===k||!q)&&clearTimeout)return q=clearTimeout,clearTimeout(a);try{return q(a)}catch(c){try{return q.call(null,a)}catch(g){return q.call(this,a)}}}function e(){z&&t&&(z=!1,t.length?A=t.concat(A):v=-1,A.length&&g())}function g(){if(!z){var a=n(e);z=!0;for(var c=A.length;c;){t=A;for(A=[];++v<c;)t&&t[v].run();v=-1;c=A.length}t=null;z=!1;h(a)}}function c(a,c){this.fun=a;this.array=c}function p(){}a=b.exports={};var y,q;try{y="function"===typeof setTimeout?setTimeout:f}catch(r){y=f}try{q="function"===
typeof clearTimeout?clearTimeout:k}catch(r){q=k}var A=[],z=!1,t,v=-1;a.nextTick=function(a){var e=Array(arguments.length-1);if(1<arguments.length)for(var h=1;h<arguments.length;h++)e[h-1]=arguments[h];A.push(new c(a,e));1!==A.length||z||n(g)};c.prototype.run=function(){this.fun.apply(null,this.array)};a.title="browser";a.browser=!0;a.env={};a.argv=[];a.version="";a.versions={};a.on=p;a.addListener=p;a.once=p;a.off=p;a.removeListener=p;a.removeAllListeners=p;a.emit=p;a.binding=function(a){throw Error("process.binding is not supported");
};a.cwd=function(){return"/"};a.chdir=function(a){throw Error("process.chdir is not supported");};a.umask=function(){return 0}},{}],24:[function(a,b,d){(function(a){(function(k){function n(a){throw new RangeError(w[a]);}function h(a,c){for(var g=a.length,e=[];g--;)e[g]=c(a[g]);return e}function e(a,c){var g=a.split("@"),e="";1<g.length&&(e=g[0]+"@",a=g[1]);a=a.replace(u,".");g=a.split(".");g=h(g,c).join(".");return e+g}function g(a){for(var c=[],g=0,e=a.length,h,p;g<e;)h=a.charCodeAt(g++),55296<=
h&&56319>=h&&g<e?(p=a.charCodeAt(g++),56320==(p&64512)?c.push(((h&1023)<<10)+(p&1023)+65536):(c.push(h),g--)):c.push(h);return c}function c(a){return h(a,function(a){var c="";65535<a&&(a-=65536,c+=G(a>>>10&1023|55296),a=56320|a&1023);return c+=G(a)}).join("")}function p(a,c){return a+22+75*(26>a)-((0!=c)<<5)}function y(a,c,g){var e=0;a=g?B(a/700):a>>1;for(a+=B(a/c);455<a;e+=36)a=B(a/35);return B(e+36*a/(a+38))}function q(a){var g=[],e=a.length,h,p=0,b=128,q=72,d,f,k,m,A;d=a.lastIndexOf("-");0>d&&
(d=0);for(f=0;f<d;++f)128<=a.charCodeAt(f)&&n("not-basic"),g.push(a.charCodeAt(f));for(d=0<d?d+1:0;d<e;){f=p;h=1;for(k=36;;k+=36){d>=e&&n("invalid-input");m=a.charCodeAt(d++);m=10>m-48?m-22:26>m-65?m-65:26>m-97?m-97:36;(36<=m||m>B((2147483647-p)/h))&&n("overflow");p+=m*h;A=k<=q?1:k>=q+26?26:k-q;if(m<A)break;m=36-A;h>B(2147483647/m)&&n("overflow");h*=m}h=g.length+1;q=y(p-f,h,0==f);B(p/h)>2147483647-b&&n("overflow");b+=B(p/h);p%=h;g.splice(p++,0,b)}return c(g)}function A(a){var c,e,h,b,q,d,f,k,m,A=
[],z,t,v;a=g(a);z=a.length;c=128;e=0;q=72;for(d=0;d<z;++d)m=a[d],128>m&&A.push(G(m));for((h=b=A.length)&&A.push("-");h<z;){f=2147483647;for(d=0;d<z;++d)m=a[d],m>=c&&m<f&&(f=m);t=h+1;f-c>B((2147483647-e)/t)&&n("overflow");e+=(f-c)*t;c=f;for(d=0;d<z;++d)if(m=a[d],m<c&&2147483647<++e&&n("overflow"),m==c){k=e;for(f=36;;f+=36){m=f<=q?1:f>=q+26?26:f-q;if(k<m)break;v=k-m;k=36-m;A.push(G(p(m+v%k,0)));k=B(v/k)}A.push(G(p(k,0)));q=y(e,t,h==b);e=0;++h}++e;++c}return A.join("")}var z="object"==typeof d&&d&&!d.nodeType&&
d,t="object"==typeof b&&b&&!b.nodeType&&b,v="object"==typeof a&&a;if(v.global===v||v.window===v||v.self===v)k=v;var r=/^xn--/,x=/[^\x20-\x7E]/,u=/[\x2E\u3002\uFF0E\uFF61]/g,w={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},B=Math.floor,G=String.fromCharCode,K,v={version:"1.4.1",ucs2:{decode:g,encode:c},decode:q,encode:A,toASCII:function(a){return e(a,function(a){return x.test(a)?"xn--"+A(a):a})},
toUnicode:function(a){return e(a,function(a){return r.test(a)?q(a.slice(4).toLowerCase()):a})}};if(z&&t)if(b.exports==z)t.exports=v;else for(K in v)v.hasOwnProperty(K)&&(z[K]=v[K]);else k.punycode=v})(this)}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],25:[function(a,b,d){b.exports=function(a,n,h,e){h=h||"=";var g={};if("string"!==typeof a||0===a.length)return g;var c=/\+/g;a=a.split(n||"&");n=1E3;e&&"number"===typeof e.maxKeys&&
(n=e.maxKeys);e=a.length;0<n&&e>n&&(e=n);for(n=0;n<e;++n){var p=a[n].replace(c,"%20"),b=p.indexOf(h),d;0<=b?(d=p.substr(0,b),p=p.substr(b+1)):(d=p,p="");d=decodeURIComponent(d);p=decodeURIComponent(p);Object.prototype.hasOwnProperty.call(g,d)?f(g[d])?g[d].push(p):g[d]=[g[d],p]:g[d]=p}return g};var f=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}},{}],26:[function(a,b,d){function f(a,g){if(a.map)return a.map(g);for(var c=[],h=0;h<a.length;h++)c.push(g(a[h],h));
return c}var k=function(a){switch(typeof a){case "string":return a;case "boolean":return a?"true":"false";case "number":return isFinite(a)?a:"";default:return""}};b.exports=function(a,g,c,p){g=g||"&";c=c||"=";null===a&&(a=void 0);return"object"===typeof a?f(h(a),function(h){var p=encodeURIComponent(k(h))+c;return n(a[h])?f(a[h],function(a){return p+encodeURIComponent(k(a))}).join(g):p+encodeURIComponent(k(a[h]))}).join(g):p?encodeURIComponent(k(p))+c+encodeURIComponent(k(a)):""};var n=Array.isArray||
function(a){return"[object Array]"===Object.prototype.toString.call(a)},h=Object.keys||function(a){var g=[],c;for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&g.push(c);return g}},{}],27:[function(a,b,d){d.decode=d.parse=a("./decode");d.encode=d.stringify=a("./encode")},{"./decode":25,"./encode":26}],28:[function(a,b,d){function f(){this.href=this.path=this.pathname=this.query=this.search=this.hash=this.hostname=this.port=this.host=this.auth=this.slashes=this.protocol=null}function k(a,c,g){if(a&&
h.isObject(a)&&a instanceof f)return a;var e=new f;e.parse(a,c,g);return e}var n=a("punycode"),h=a("./util");d.parse=k;d.resolve=function(a,c){return k(a,!1,!0).resolve(c)};d.resolveObject=function(a,c){return a?k(a,!1,!0).resolveObject(c):c};d.format=function(a){h.isString(a)&&(a=k(a));return a instanceof f?a.format():f.prototype.format.call(a)};d.Url=f;var e=/^([a-z0-9.+-]+:)/i,g=/:[0-9]*$/,c=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/;b="{}|\\^`".split("").concat('<>"` \r\n\t'.split(""));var p=["'"].concat(b),
y=["%","/","?",";","#"].concat(p),q=["/","?","#"],A=/^[+a-z0-9A-Z_-]{0,63}$/,z=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,t={javascript:!0,"javascript:":!0},v={javascript:!0,"javascript:":!0},r={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},x=a("querystring");f.prototype.parse=function(a,g,b){if(!h.isString(a))throw new TypeError("Parameter 'url' must be a string, not "+typeof a);var d=a.indexOf("?"),d=-1!==d&&d<a.indexOf("#")?"?":"#";a=a.split(d);a[0]=a[0].replace(/\\/g,
"/");a=a.join(d);d=a.trim();if(!b&&1===a.split("#").length&&(a=c.exec(d)))return this.href=this.path=d,this.pathname=a[1],a[2]?(this.search=a[2],this.query=g?x.parse(this.search.substr(1)):this.search.substr(1)):g&&(this.search="",this.query={}),this;if(a=e.exec(d)){a=a[0];var f=a.toLowerCase();this.protocol=f;d=d.substr(a.length)}if(b||a||d.match(/^\/\/[^@\/]+@[^@\/]+/)){var k="//"===d.substr(0,2);!k||a&&v[a]||(d=d.substr(2),this.slashes=!0)}if(!v[a]&&(k||a&&!r[a])){k=-1;for(b=0;b<q.length;b++)a=
d.indexOf(q[b]),-1!==a&&(-1===k||a<k)&&(k=a);k=-1===k?d.lastIndexOf("@"):d.lastIndexOf("@",k);-1!==k&&(b=d.slice(0,k),d=d.slice(k+1),this.auth=decodeURIComponent(b));k=-1;for(b=0;b<y.length;b++)a=d.indexOf(y[b]),-1!==a&&(-1===k||a<k)&&(k=a);-1===k&&(k=d.length);this.host=d.slice(0,k);d=d.slice(k);this.parseHost();this.hostname=this.hostname||"";k="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!k){var m=this.hostname.split(/\./);b=0;for(a=m.length;b<a;b++){var I=m[b];if(I&&
!I.match(A)){for(var L="",F=0,P=I.length;F<P;F++)L=127<I.charCodeAt(F)?L+"x":L+I[F];if(!L.match(A)){a=m.slice(0,b);b=m.slice(b+1);if(I=I.match(z))a.push(I[1]),b.unshift(I[2]);b.length&&(d="/"+b.join(".")+d);this.hostname=a.join(".");break}}}}this.hostname=255<this.hostname.length?"":this.hostname.toLowerCase();k||(this.hostname=n.toASCII(this.hostname));b=this.port?":"+this.port:"";this.host=(this.hostname||"")+b;this.href+=this.host;k&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),
"/"!==d[0]&&(d="/"+d))}if(!t[f])for(b=0,a=p.length;b<a;b++)k=p[b],-1!==d.indexOf(k)&&(I=encodeURIComponent(k),I===k&&(I=escape(k)),d=d.split(k).join(I));b=d.indexOf("#");-1!==b&&(this.hash=d.substr(b),d=d.slice(0,b));b=d.indexOf("?");-1!==b?(this.search=d.substr(b),this.query=d.substr(b+1),g&&(this.query=x.parse(this.query)),d=d.slice(0,b)):g&&(this.search="",this.query={});d&&(this.pathname=d);r[f]&&this.hostname&&!this.pathname&&(this.pathname="/");if(this.pathname||this.search)b=this.pathname||
"",this.path=b+(this.search||"");this.href=this.format();return this};f.prototype.format=function(){var a=this.auth||"";a&&(a=encodeURIComponent(a),a=a.replace(/%3A/i,":"),a+="@");var c=this.protocol||"",g=this.pathname||"",e=this.hash||"",p=!1,n="";this.host?p=a+this.host:this.hostname&&(p=a+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(p+=":"+this.port));this.query&&h.isObject(this.query)&&Object.keys(this.query).length&&(n=x.stringify(this.query));a=this.search||
n&&"?"+n||"";c&&":"!==c.substr(-1)&&(c+=":");this.slashes||(!c||r[c])&&!1!==p?(p="//"+(p||""),g&&"/"!==g.charAt(0)&&(g="/"+g)):p||(p="");e&&"#"!==e.charAt(0)&&(e="#"+e);a&&"?"!==a.charAt(0)&&(a="?"+a);g=g.replace(/[?#]/g,function(a){return encodeURIComponent(a)});a=a.replace("#","%23");return c+p+g+a+e};f.prototype.resolve=function(a){return this.resolveObject(k(a,!1,!0)).format()};f.prototype.resolveObject=function(a){if(h.isString(a)){var c=new f;c.parse(a,!1,!0);a=c}for(var c=new f,g=Object.keys(this),
e=0;e<g.length;e++){var p=g[e];c[p]=this[p]}c.hash=a.hash;if(""===a.href)return c.href=c.format(),c;if(a.slashes&&!a.protocol){g=Object.keys(a);for(e=0;e<g.length;e++)p=g[e],"protocol"!==p&&(c[p]=a[p]);r[c.protocol]&&c.hostname&&!c.pathname&&(c.path=c.pathname="/");c.href=c.format();return c}if(a.protocol&&a.protocol!==c.protocol){if(!r[a.protocol]){g=Object.keys(a);for(e=0;e<g.length;e++)p=g[e],c[p]=a[p];c.href=c.format();return c}c.protocol=a.protocol;if(a.host||v[a.protocol])c.pathname=a.pathname;
else{for(var n=(a.pathname||"").split("/");n.length&&!(a.host=n.shift()););a.host||(a.host="");a.hostname||(a.hostname="");""!==n[0]&&n.unshift("");2>n.length&&n.unshift("");c.pathname=n.join("/")}c.search=a.search;c.query=a.query;c.host=a.host||"";c.auth=a.auth;c.hostname=a.hostname||a.host;c.port=a.port;if(c.pathname||c.search)c.path=(c.pathname||"")+(c.search||"");c.slashes=c.slashes||a.slashes;c.href=c.format();return c}var g=c.pathname&&"/"===c.pathname.charAt(0),b=a.host||a.pathname&&"/"===
a.pathname.charAt(0),d=g=b||g||c.host&&a.pathname,e=c.pathname&&c.pathname.split("/")||[],n=a.pathname&&a.pathname.split("/")||[];if(p=c.protocol&&!r[c.protocol])c.hostname="",c.port=null,c.host&&(""===e[0]?e[0]=c.host:e.unshift(c.host)),c.host="",a.protocol&&(a.hostname=null,a.port=null,a.host&&(""===n[0]?n[0]=a.host:n.unshift(a.host)),a.host=null),g=g&&(""===n[0]||""===e[0]);if(b)c.host=a.host||""===a.host?a.host:c.host,c.hostname=a.hostname||""===a.hostname?a.hostname:c.hostname,c.search=a.search,
c.query=a.query,e=n;else if(n.length)e||(e=[]),e.pop(),e=e.concat(n),c.search=a.search,c.query=a.query;else if(!h.isNullOrUndefined(a.search))return p&&(c.hostname=c.host=e.shift(),p=c.host&&0<c.host.indexOf("@")?c.host.split("@"):!1)&&(c.auth=p.shift(),c.host=c.hostname=p.shift()),c.search=a.search,c.query=a.query,h.isNull(c.pathname)&&h.isNull(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.href=c.format(),c;if(!e.length)return c.pathname=null,c.path=c.search?"/"+c.search:
null,c.href=c.format(),c;for(var b=e.slice(-1)[0],n=(c.host||a.host||1<e.length)&&("."===b||".."===b)||""===b,q=0,k=e.length;0<=k;k--)b=e[k],"."===b?e.splice(k,1):".."===b?(e.splice(k,1),q++):q&&(e.splice(k,1),q--);if(!g&&!d)for(;q--;q)e.unshift("..");!g||""===e[0]||e[0]&&"/"===e[0].charAt(0)||e.unshift("");n&&"/"!==e.join("/").substr(-1)&&e.push("");d=""===e[0]||e[0]&&"/"===e[0].charAt(0);p&&(c.hostname=c.host=d?"":e.length?e.shift():"",p=c.host&&0<c.host.indexOf("@")?c.host.split("@"):!1)&&(c.auth=
p.shift(),c.host=c.hostname=p.shift());(g=g||c.host&&e.length)&&!d&&e.unshift("");e.length?c.pathname=e.join("/"):(c.pathname=null,c.path=null);h.isNull(c.pathname)&&h.isNull(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:""));c.auth=a.auth||c.auth;c.slashes=c.slashes||a.slashes;c.href=c.format();return c};f.prototype.parseHost=function(){var a=this.host,c=g.exec(a);c&&(c=c[0],":"!==c&&(this.port=c.substr(1)),a=a.substr(0,a.length-c.length));a&&(this.hostname=a)}},{"./util":29,punycode:24,
querystring:27}],29:[function(a,b,d){b.exports={isString:function(a){return"string"===typeof a},isObject:function(a){return"object"===typeof a&&null!==a},isNull:function(a){return null===a},isNullOrUndefined:function(a){return null==a}}},{}],30:[function(a,b,d){arguments[4][3][0].apply(d,arguments)},{dup:3}],31:[function(a,b,d){b.exports=function(a,b){b=b||{};for(var n="source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),h={strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,
loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}[b.strictMode?"strict":"loose"].exec(a),e={},g=14;g--;)e[n[g]]=h[g]||"";e.queryKey={};e[n[12]].replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(a,g,h){g&&(e.queryKey[g]=h)});return e}},{}],32:[function(a,b,d){function f(a,c){e.call(this);c=c||10;this.baseUrl=a||"";this.progress=0;this.loading=!1;this._progressChunk=
0;this._beforeMiddleware=[];this._afterMiddleware=[];this._boundLoadResource=this._loadResource.bind(this);this._buffer=[];this._numToLoad=0;this._queue=n.queue(this._boundLoadResource,c);this.resources={}}var k=a("parse-uri"),n=a("./async"),h=a("./Resource"),e=a("eventemitter3");f.prototype=Object.create(e.prototype);f.prototype.constructor=f;b.exports=f;f.prototype.add=f.prototype.enqueue=function(a,c,e,n){if(Array.isArray(a)){for(c=0;c<a.length;++c)this.add(a[c]);return this}"object"===typeof a&&
(n=c||a.callback||a.onComplete,e=a,c=a.url,a=a.name||a.key||a.url);"string"!==typeof c&&(n=e,e=c,c=a);if("string"!==typeof c)throw Error("No url passed to add resource to loader.");"function"===typeof e&&(n=e,e=null);if(this.resources[a])throw Error('Resource with name "'+a+'" already exists.');c=this._prepareUrl(c);this.resources[a]=new h(a,c,e);if("function"===typeof n)this.resources[a].once("afterMiddleware",n);this._numToLoad++;this._queue.started?(this._queue.push(this.resources[a]),this._progressChunk=
(100-this.progress)/(this._queue.length()+this._queue.running())):(this._buffer.push(this.resources[a]),this._progressChunk=100/this._buffer.length);return this};f.prototype.before=f.prototype.pre=function(a){this._beforeMiddleware.push(a);return this};f.prototype.after=f.prototype.use=function(a){this._afterMiddleware.push(a);return this};f.prototype.reset=function(){this.progress=0;this.loading=!1;this._progressChunk=0;this._numToLoad=this._buffer.length=0;this._queue.kill();this._queue.started=
!1;for(var a in this.resources){var c=this.resources[a];c.off("complete",this._onLoad,this);c.isLoading&&c.abort()}this.resources={};return this};f.prototype.load=function(a){if("function"===typeof a)this.once("complete",a);if(this._queue.started)return this;this.emit("start",this);this.loading=!0;for(a=0;a<this._buffer.length;++a)this._queue.push(this._buffer[a]);this._buffer.length=0;return this};f.prototype._prepareUrl=function(a){var c=k(a,{strictMode:!0});return c.protocol||!c.path||0===c.path.indexOf("//")?
a:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==a.charAt(0)?this.baseUrl+"/"+a:this.baseUrl+a};f.prototype._loadResource=function(a,c){var e=this;a._dequeue=c;n.eachSeries(this._beforeMiddleware,function(c,h){c.call(e,a,function(){h(a.isComplete?{}:null)})},function(){a.isComplete?e._onLoad(a):(a.once("complete",e._onLoad,e),a.load())})};f.prototype._onComplete=function(){this.loading=!1;this.emit("complete",this,this.resources)};f.prototype._onLoad=function(a){var c=
this;n.eachSeries(this._afterMiddleware,function(e,h){e.call(c,a,h)},function(){a.emit("afterMiddleware",a);c._numToLoad--;c.progress+=c._progressChunk;c.emit("progress",c,a);a.error?c.emit("error",a.error,c,a):c.emit("load",c,a);0===c._numToLoad&&(c.progress=100,c._onComplete())});a._dequeue()};f.LOAD_TYPE=h.LOAD_TYPE;f.XHR_RESPONSE_TYPE=h.XHR_RESPONSE_TYPE},{"./Resource":33,"./async":34,eventemitter3:30,"parse-uri":31}],33:[function(a,b,d){function f(a,c,e){h.call(this);e=e||{};if("string"!==typeof a||
"string"!==typeof c)throw Error("Both name and url are required for constructing a resource.");this.name=a;this.url=c;this.isDataUrl=0===this.url.indexOf("data:");this.data=null;this.crossOrigin=!0===e.crossOrigin?"anonymous":e.crossOrigin;this.loadType=e.loadType||this._determineLoadType();this.xhrType=e.xhrType;this.metadata=e.metadata||{};this.xhr=this.error=null;this.isLoading=this.isComplete=this.isVideo=this.isAudio=this.isImage=this.isXml=this.isJson=!1;this._dequeue=null;this._boundComplete=
this.complete.bind(this);this._boundOnError=this._onError.bind(this);this._boundOnProgress=this._onProgress.bind(this);this._boundXhrOnError=this._xhrOnError.bind(this);this._boundXhrOnAbort=this._xhrOnAbort.bind(this);this._boundXhrOnLoad=this._xhrOnLoad.bind(this);this._boundXdrOnTimeout=this._xdrOnTimeout.bind(this)}function k(a){return a.toString().replace("object ","")}function n(a,c,e){c&&0===c.indexOf(".")&&(c=c.substring(1));c&&(a[c]=e)}var h=a("eventemitter3"),e=a("parse-uri"),g=!(!window.XDomainRequest||
"withCredentials"in new XMLHttpRequest),c=null;f.prototype=Object.create(h.prototype);f.prototype.constructor=f;b.exports=f;f.prototype.complete=function(){this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1));this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",
this._boundXhrOnError,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null));if(this.isComplete)throw Error("Complete called again for an already completed resource.");this.isComplete=!0;this.isLoading=!1;this.emit("complete",this)};f.prototype.abort=function(a){if(!this.error){this.error=
Error(a);if(this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if("undefined"!==typeof this.data.src)this.data.src="";else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this.complete()}};f.prototype.load=function(a){if(!this.isLoading)if(this.isComplete){if(a){var c=this;setTimeout(function(){a(c)},1)}}else{if(a)this.once("complete",a);this.isLoading=!0;this.emit("start",this);if(!1===this.crossOrigin||"string"!==typeof this.crossOrigin)this.crossOrigin=
this._determineCrossOrigin(this.url);switch(this.loadType){case f.LOAD_TYPE.IMAGE:this._loadElement("image");break;case f.LOAD_TYPE.AUDIO:this._loadSourceElement("audio");break;case f.LOAD_TYPE.VIDEO:this._loadSourceElement("video");break;default:g&&this.crossOrigin?this._loadXdr():this._loadXhr()}}};f.prototype._loadElement=function(a){this.data=this.metadata.loadElement?this.metadata.loadElement:"image"===a&&"undefined"!==typeof window.Image?new Image:document.createElement(a);this.crossOrigin&&
(this.data.crossOrigin=this.crossOrigin);this.metadata.skipSource||(this.data.src=this.url);a="is"+a[0].toUpperCase()+a.substring(1);!1===this[a]&&(this[a]=!0);this.data.addEventListener("error",this._boundOnError,!1);this.data.addEventListener("load",this._boundComplete,!1);this.data.addEventListener("progress",this._boundOnProgress,!1)};f.prototype._loadSourceElement=function(a){this.data=this.metadata.loadElement?this.metadata.loadElement:"audio"===a&&"undefined"!==typeof window.Audio?new Audio:
document.createElement(a);if(null===this.data)this.abort("Unsupported element "+a);else{if(!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var c=0;c<this.url.length;++c)this.data.appendChild(this._createSource(a,this.url[c]));else this.data.appendChild(this._createSource(a,this.url));this["is"+a[0].toUpperCase()+a.substring(1)]=!0;this.data.addEventListener("error",this._boundOnError,!1);this.data.addEventListener("load",
this._boundComplete,!1);this.data.addEventListener("progress",this._boundOnProgress,!1);this.data.addEventListener("canplaythrough",this._boundComplete,!1);this.data.load()}};f.prototype._loadXhr=function(){"string"!==typeof this.xhrType&&(this.xhrType=this._determineXhrType());var a=this.xhr=new XMLHttpRequest;a.open("GET",this.url,!0);a.responseType=this.xhrType===f.XHR_RESPONSE_TYPE.JSON||this.xhrType===f.XHR_RESPONSE_TYPE.DOCUMENT?f.XHR_RESPONSE_TYPE.TEXT:this.xhrType;a.addEventListener("error",
this._boundXhrOnError,!1);a.addEventListener("abort",this._boundXhrOnAbort,!1);a.addEventListener("progress",this._boundOnProgress,!1);a.addEventListener("load",this._boundXhrOnLoad,!1);a.send()};f.prototype._loadXdr=function(){"string"!==typeof this.xhrType&&(this.xhrType=this._determineXhrType());var a=this.xhr=new XDomainRequest;a.timeout=5E3;a.onerror=this._boundXhrOnError;a.ontimeout=this._boundXdrOnTimeout;a.onprogress=this._boundOnProgress;a.onload=this._boundXhrOnLoad;a.open("GET",this.url,
!0);setTimeout(function(){a.send()},0)};f.prototype._createSource=function(a,c,e){e||(e=a+"/"+c.substr(c.lastIndexOf(".")+1));a=document.createElement("source");a.src=c;a.type=e;return a};f.prototype._onError=function(a){this.abort("Failed to load element using "+a.target.nodeName)};f.prototype._onProgress=function(a){a&&a.lengthComputable&&this.emit("progress",this,a.loaded/a.total)};f.prototype._xhrOnError=function(){var a=this.xhr;this.abort(k(a)+" Request failed. Status: "+a.status+', text: "'+
a.statusText+'"')};f.prototype._xhrOnAbort=function(){this.abort(k(this.xhr)+" Request was aborted by the user.")};f.prototype._xdrOnTimeout=function(){this.abort(k(this.xhr)+" Request timed out.")};f.prototype._xhrOnLoad=function(){var a=this.xhr,c="undefined"===typeof a.status?a.status:200;if(200===c||204===c||0===c&&0<a.responseText.length){if(this.xhrType===f.XHR_RESPONSE_TYPE.TEXT)this.data=a.responseText;else if(this.xhrType===f.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(a.responseText),
this.isJson=!0}catch(e){this.abort("Error trying to parse loaded json:",e);return}else if(this.xhrType===f.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser)this.data=(new DOMParser).parseFromString(a.responseText,"text/xml");else{var g=document.createElement("div");g.innerHTML=a.responseText;this.data=g}this.isXml=!0}catch(e){this.abort("Error trying to parse loaded xml:",e);return}else this.data=a.response||a.responseText;this.complete()}else this.abort("["+a.status+"]"+a.statusText+":"+a.responseURL)};
f.prototype._determineCrossOrigin=function(a,g){if(0===a.indexOf("data:"))return"";g=g||window.location;c||(c=document.createElement("a"));c.href=a;a=e(c.href,{strictMode:!0});var h=!a.port&&""===g.port||a.port===g.port,n=a.protocol?a.protocol+":":"";return a.host===g.hostname&&h&&n===g.protocol?"":"anonymous"};f.prototype._determineXhrType=function(){return f._xhrTypeMap[this._getExtension()]||f.XHR_RESPONSE_TYPE.TEXT};f.prototype._determineLoadType=function(){return f._loadTypeMap[this._getExtension()]||
f.LOAD_TYPE.XHR};f.prototype._getExtension=function(){var a=this.url;if(this.isDataUrl)var c=a.indexOf("/"),a=a.substring(c+1,a.indexOf(";",c));else c=a.indexOf("?"),-1!==c&&(a=a.substring(0,c)),a=a.substring(a.lastIndexOf(".")+1);return a.toLowerCase()};f.prototype._getMimeFromXhrType=function(a){switch(a){case f.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case f.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case f.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case f.XHR_RESPONSE_TYPE.JSON:return"application/json";
default:return"text/plain"}};f.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4};f.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"};f._loadTypeMap={gif:f.LOAD_TYPE.IMAGE,png:f.LOAD_TYPE.IMAGE,bmp:f.LOAD_TYPE.IMAGE,jpg:f.LOAD_TYPE.IMAGE,jpeg:f.LOAD_TYPE.IMAGE,tif:f.LOAD_TYPE.IMAGE,tiff:f.LOAD_TYPE.IMAGE,webp:f.LOAD_TYPE.IMAGE,tga:f.LOAD_TYPE.IMAGE,"svg+xml":f.LOAD_TYPE.IMAGE};f._xhrTypeMap={xhtml:f.XHR_RESPONSE_TYPE.DOCUMENT,html:f.XHR_RESPONSE_TYPE.DOCUMENT,
htm:f.XHR_RESPONSE_TYPE.DOCUMENT,xml:f.XHR_RESPONSE_TYPE.DOCUMENT,tmx:f.XHR_RESPONSE_TYPE.DOCUMENT,tsx:f.XHR_RESPONSE_TYPE.DOCUMENT,svg:f.XHR_RESPONSE_TYPE.DOCUMENT,gif:f.XHR_RESPONSE_TYPE.BLOB,png:f.XHR_RESPONSE_TYPE.BLOB,bmp:f.XHR_RESPONSE_TYPE.BLOB,jpg:f.XHR_RESPONSE_TYPE.BLOB,jpeg:f.XHR_RESPONSE_TYPE.BLOB,tif:f.XHR_RESPONSE_TYPE.BLOB,tiff:f.XHR_RESPONSE_TYPE.BLOB,webp:f.XHR_RESPONSE_TYPE.BLOB,tga:f.XHR_RESPONSE_TYPE.BLOB,json:f.XHR_RESPONSE_TYPE.JSON,text:f.XHR_RESPONSE_TYPE.TEXT,txt:f.XHR_RESPONSE_TYPE.TEXT};
f.setExtensionLoadType=function(a,c){n(f._loadTypeMap,a,c)};f.setExtensionXhrType=function(a,c){n(f._xhrTypeMap,a,c)}},{eventemitter3:30,"parse-uri":31}],34:[function(a,b,d){function f(){}function k(a){return function(){if(null===a)throw Error("Callback was already called.");var h=a;a=null;h.apply(this,arguments)}}b.exports={eachSeries:function(a,h,e){var g=0,c=a.length;(function y(b){b||g===c?e&&e(b):h(a[g++],y)})()},queue:function(a,h){function e(a,c,e){if(null!=e&&"function"!==typeof e)throw Error("task callback must be a function");
p.started=!0;null==a&&p.idle()?setTimeout(function(){p.drain()},1):(a={data:a,callback:"function"===typeof e?e:f},c?p._tasks.unshift(a):p._tasks.push(a),setTimeout(function(){p.process()},1))}function g(a){return function(){--c;a.callback.apply(a,arguments);null!=arguments[0]&&p.error(arguments[0],a.data);c<=p.concurrency-p.buffer&&p.unsaturated();p.idle()&&p.drain();p.process()}}if(null==h)h=1;else if(0===h)throw Error("Concurrency must not be zero");var c=0,p={_tasks:[],concurrency:h,saturated:f,
unsaturated:f,buffer:h/4,empty:f,drain:f,error:f,started:!1,paused:!1,push:function(a,c){e(a,!1,c)},kill:function(){p.drain=f;p._tasks=[]},unshift:function(a,c){e(a,!0,c)},process:function(){for(;!p.paused&&c<p.concurrency&&p._tasks.length;){var e=p._tasks.shift();0===p._tasks.length&&p.empty();c+=1;c===p.concurrency&&p.saturated();a(e.data,k(g(e)))}},length:function(){return p._tasks.length},running:function(){return c},idle:function(){return 0===p._tasks.length+c},pause:function(){!0!==p.paused&&
(p.paused=!0)},resume:function(){if(!1!==p.paused){p.paused=!1;for(var a=1;a<=p.concurrency;a++)p.process()}}};return p}}},{}],35:[function(a,b,d){b.exports={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encodeBinary:function(a){for(var b="",n,h=Array(4),e=0,g;e<a.length;){n=Array(3);for(g=0;g<n.length;g++)n[g]=e<a.length?a.charCodeAt(e++)&255:0;h[0]=n[0]>>2;h[1]=(n[0]&3)<<4|n[1]>>4;h[2]=(n[1]&15)<<2|n[2]>>6;h[3]=n[2]&63;n=e-(a.length-1);switch(n){case 2:h[3]=64;h[2]=
64;break;case 1:h[3]=64}for(g=0;g<h.length;g++)b+=this._keyStr.charAt(h[g])}return b}}},{}],36:[function(a,b,d){b.exports=a("./Loader");b.exports.Resource=a("./Resource");b.exports.middleware={caching:{memory:a("./middlewares/caching/memory")},parsing:{blob:a("./middlewares/parsing/blob")}};b.exports.async=a("./async")},{"./Loader":32,"./Resource":33,"./async":34,"./middlewares/caching/memory":37,"./middlewares/parsing/blob":38}],37:[function(a,b,d){var f={};b.exports=function(){return function(a,
b){if(f[a.url])a.data=f[a.url],a.complete();else a.once("complete",function(){f[this.url]=this.data});b()}}},{}],38:[function(a,b,d){var f=a("../../Resource"),k=a("../../b64"),n=window.URL||window.webkitURL;b.exports=function(){return function(a,e){if(a.data&&a.xhr&&a.xhrType===f.XHR_RESPONSE_TYPE.BLOB)if(!window.Blob||"string"===typeof a.data){var g=a.xhr.getResponseHeader("content-type");if(g&&0===g.indexOf("image")){a.data=new Image;a.data.src="data:"+g+";base64,"+k.encodeBinary(a.xhr.responseText);
a.isImage=!0;a.data.onload=function(){a.data.onload=null;e()};return}}else if(0===a.data.type.indexOf("image")){var c=n.createObjectURL(a.data);a.blob=a.data;a.data=new Image;a.data.src=c;a.isImage=!0;a.data.onload=function(){n.revokeObjectURL(c);a.data.onload=null;e()};return}e()}}},{"../../Resource":33,"../../b64":35}],39:[function(a,b,d){d.__esModule=!0;var f=function(a){if(a&&a.__esModule)return a;var h={};if(null!=a)for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(h[e]=a[e]);h["default"]=
a;return h}(a("../core")),k=(b=a("ismobilejs"))&&b.__esModule?b:{"default":b};a=a("./accessibleTarget");Object.assign(f.DisplayObject.prototype,(a&&a.__esModule?a:{"default":a})["default"]);a=function(){function a(h){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");!k["default"].tablet&&!k["default"].phone||navigator.isCocoonJS||this.createTouchHook();var e=document.createElement("div");e.style.width="100px";e.style.height="100px";e.style.position="absolute";e.style.top=
"0px";e.style.left="0px";e.style.zIndex=2;this.div=e;this.pool=[];this.renderId=0;this.debug=!1;this.renderer=h;this.children=[];this._onKeyDown=this._onKeyDown.bind(this);this._onMouseMove=this._onMouseMove.bind(this);this.isMobileAccessabillity=this.isActive=!1;window.addEventListener("keydown",this._onKeyDown,!1)}a.prototype.createTouchHook=function(){var a=this,e=document.createElement("button");e.style.width="1px";e.style.height="1px";e.style.position="absolute";e.style.top="-1000px";e.style.left=
"-1000px";e.style.zIndex=2;e.style.backgroundColor="#FF0000";e.title="HOOK DIV";e.addEventListener("focus",function(){a.isMobileAccessabillity=!0;a.activate();document.body.removeChild(e)});document.body.appendChild(e)};a.prototype.activate=function(){this.isActive||(this.isActive=!0,window.document.addEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode&&this.renderer.view.parentNode.appendChild(this.div))};
a.prototype.deactivate=function(){this.isActive&&!this.isMobileAccessabillity&&(this.isActive=!1,window.document.removeEventListener("mousemove",this._onMouseMove),window.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode&&this.div.parentNode.removeChild(this.div))};a.prototype.updateAccessibleObjects=function(a){if(a.visible){a.accessible&&a.interactive&&(a._accessibleActive||this.addChild(a),a.renderId=this.renderId);a=a.children;for(var e=
a.length-1;0<=e;e--)this.updateAccessibleObjects(a[e])}};a.prototype.update=function(){if(this.renderer.renderingToScreen){this.updateAccessibleObjects(this.renderer._lastObjectRendered);var a=this.renderer.view.getBoundingClientRect(),e=a.width/this.renderer.width,g=a.height/this.renderer.height,c=this.div;c.style.left=a.left+"px";c.style.top=a.top+"px";c.style.width=this.renderer.width+"px";c.style.height=this.renderer.height+"px";for(a=0;a<this.children.length;a++){var p=this.children[a];if(p.renderId!==
this.renderId)p._accessibleActive=!1,f.utils.removeItems(this.children,a,1),this.div.removeChild(p._accessibleDiv),this.pool.push(p._accessibleDiv),p._accessibleDiv=null,a--,0===this.children.length&&this.deactivate();else{var c=p._accessibleDiv,b=p.hitArea,n=p.worldTransform;p.hitArea?(c.style.left=(n.tx+b.x*n.a)*e+"px",c.style.top=(n.ty+b.y*n.d)*g+"px",c.style.width=b.width*n.a*e+"px",c.style.height=b.height*n.d*g+"px"):(b=p.getBounds(),this.capHitArea(b),c.style.left=b.x*e+"px",c.style.top=b.y*
g+"px",c.style.width=b.width*e+"px",c.style.height=b.height*g+"px")}}this.renderId++}};a.prototype.capHitArea=function(a){0>a.x&&(a.width+=a.x,a.x=0);0>a.y&&(a.height+=a.y,a.y=0);a.x+a.width>this.renderer.width&&(a.width=this.renderer.width-a.x);a.y+a.height>this.renderer.height&&(a.height=this.renderer.height-a.y)};a.prototype.addChild=function(a){var e=this.pool.pop();e||(e=document.createElement("button"),e.style.width="100px",e.style.height="100px",e.style.backgroundColor=this.debug?"rgba(255,0,0,0.5)":
"transparent",e.style.position="absolute",e.style.zIndex=2,e.style.borderStyle="none",e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this)));a.accessibleTitle?e.title=a.accessibleTitle:a.accessibleTitle||a.accessibleHint||(e.title="displayObject "+this.tabIndex);a.accessibleHint&&e.setAttribute("aria-label",a.accessibleHint);a._accessibleActive=!0;a._accessibleDiv=e;e.displayObject=a;this.children.push(a);
this.div.appendChild(a._accessibleDiv);a._accessibleDiv.tabIndex=a.tabIndex};a.prototype._onClick=function(a){var e=this.renderer.plugins.interaction;e.dispatchEvent(a.target.displayObject,"click",e.eventData)};a.prototype._onFocus=function(a){var e=this.renderer.plugins.interaction;e.dispatchEvent(a.target.displayObject,"mouseover",e.eventData)};a.prototype._onFocusOut=function(a){var e=this.renderer.plugins.interaction;e.dispatchEvent(a.target.displayObject,"mouseout",e.eventData)};a.prototype._onKeyDown=
function(a){9===a.keyCode&&this.activate()};a.prototype._onMouseMove=function(){this.deactivate()};a.prototype.destroy=function(){this.div=null;for(var a=0;a<this.children.length;a++)this.children[a].div=null;window.document.removeEventListener("mousemove",this._onMouseMove);window.removeEventListener("keydown",this._onKeyDown);this.renderer=this.children=this.pool=null};return a}();d["default"]=a;f.WebGLRenderer.registerPlugin("accessibility",a);f.CanvasRenderer.registerPlugin("accessibility",a)},
{"../core":62,"./accessibleTarget":40,ismobilejs:4}],40:[function(a,b,d){d.__esModule=!0;d["default"]={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:!1}},{}],41:[function(a,b,d){d.__esModule=!0;var f=a("./accessibleTarget");Object.defineProperty(d,"accessibleTarget",{enumerable:!0,get:function(){return(f&&f.__esModule?f:{"default":f})["default"]}});var k=a("./AccessibilityManager");Object.defineProperty(d,"AccessibilityManager",{enumerable:!0,
get:function(){return(k&&k.__esModule?k:{"default":k})["default"]}})},{"./AccessibilityManager":39,"./accessibleTarget":40}],42:[function(a,b,d){function f(a,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);a.prototype=Object.create(e&&e.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(a,e):a.__proto__=e)}function k(a){if(a instanceof Array)"precision"!==
a[0].substring(0,9)&&(a=a.slice(0),a.unshift("precision "+n.PRECISION.DEFAULT+" float;"));else if("precision"!==a.substring(0,9))return"precision "+n.PRECISION.DEFAULT+" float;\n"+a;return a}d.__esModule=!0;b=a("pixi-gl-core");var n=a("./const");a=function(a){function e(g,c,p){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");g=a.call(this,g,k(c),k(p));if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!g||"object"!==
typeof g&&"function"!==typeof g?this:g}f(e,a);return e}(b.GLShader);d["default"]=a},{"./const":43,"pixi-gl-core":12}],43:[function(a,b,d){d.__esModule=!0;d.SPRITE_MAX_TEXTURES=d.SPRITE_BATCH_SIZE=d.TEXT_GRADIENT=d.TRANSFORM_MODE=d.PRECISION=d.SHAPES=d.SVG_SIZE=d.DATA_URI=d.URL_FILE_EXTENSION=d.DEFAULT_RENDER_OPTIONS=d.FILTER_RESOLUTION=d.RESOLUTION=d.RETINA_PREFIX=d.MIPMAP_TEXTURES=d.GC_MODES=d.WRAP_MODES=d.SCALE_MODES=d.DRAW_MODES=d.BLEND_MODES=d.RENDERER_TYPE=d.TARGET_FPMS=d.DEG_TO_RAD=d.RAD_TO_DEG=
d.PI_2=d.VERSION=void 0;a=(a=a("./utils/maxRecommendedTextures"))&&a.__esModule?a:{"default":a};d.VERSION="4.1.1";d.PI_2=2*Math.PI;d.RAD_TO_DEG=180/Math.PI;d.DEG_TO_RAD=Math.PI/180;d.TARGET_FPMS=.06;d.RENDERER_TYPE={UNKNOWN:0,WEBGL:1,CANVAS:2};d.BLEND_MODES={NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16};d.DRAW_MODES={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,
TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};d.SCALE_MODES={DEFAULT:0,LINEAR:0,NEAREST:1};d.WRAP_MODES={DEFAULT:0,CLAMP:0,REPEAT:1,MIRRORED_REPEAT:2};d.GC_MODES={DEFAULT:0,AUTO:0,MANUAL:1};d.MIPMAP_TEXTURES=!0;d.RETINA_PREFIX=/@(.+)x/;d.RESOLUTION=1;d.FILTER_RESOLUTION=1;d.DEFAULT_RENDER_OPTIONS={view:null,antialias:!1,forceFXAA:!1,autoResize:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,roundPixels:!1};d.URL_FILE_EXTENSION=/\.(\w{3,4})(?:$|\?|#)/i;d.DATA_URI=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;(charset=[\w-]+|base64))?,(.*)/i;
d.SVG_SIZE=/<svg[^>]*(?:\s(width|height)="(\d*(?:\.\d+)?)(?:px)?")[^>]*(?:\s(width|height)="(\d*(?:\.\d+)?)(?:px)?")[^>]*>/i;d.SHAPES={POLY:0,RECT:1,CIRC:2,ELIP:3,RREC:4};d.PRECISION={DEFAULT:"mediump",LOW:"lowp",MEDIUM:"mediump",HIGH:"highp"};d.TRANSFORM_MODE={DEFAULT:0,STATIC:0,DYNAMIC:1};d.TEXT_GRADIENT={LINEAR_VERTICAL:0,LINEAR_HORIZONTAL:1};d.SPRITE_BATCH_SIZE=4096;d.SPRITE_MAX_TEXTURES=(0,a["default"])(32)},{"./utils/maxRecommendedTextures":117}],44:[function(a,b,d){d.__esModule=!0;var f=a("../math");
a=function(){function a(){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.minY=this.minX=Infinity;this.maxY=this.maxX=-Infinity;this.rect=null}a.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY};a.prototype.clear=function(){this.updateID++;this.minY=this.minX=Infinity;this.maxY=this.maxX=-Infinity};a.prototype.getRectangle=function(a){if(this.minX>this.maxX||this.minY>this.maxY)return f.Rectangle.EMPTY;a=a||new f.Rectangle(0,0,1,1);
a.x=this.minX;a.y=this.minY;a.width=this.maxX-this.minX;a.height=this.maxY-this.minY;return a};a.prototype.addPoint=function(a){this.minX=Math.min(this.minX,a.x);this.maxX=Math.max(this.maxX,a.x);this.minY=Math.min(this.minY,a.y);this.maxY=Math.max(this.maxY,a.y)};a.prototype.addQuad=function(a){var h=this.minX,e=this.minY,g=this.maxX,c=this.maxY,p=a[0],b=a[1],h=p<h?p:h,e=b<e?b:e,g=p>g?p:g,c=b>c?b:c,p=a[2],b=a[3],h=p<h?p:h,e=b<e?b:e,g=p>g?p:g,c=b>c?b:c,p=a[4],b=a[5],h=p<h?p:h,e=b<e?b:e,g=p>g?p:g,
c=b>c?b:c,p=a[6],b=a[7];this.minX=p<h?p:h;this.minY=b<e?b:e;this.maxX=p>g?p:g;this.maxY=b>c?b:c};a.prototype.addFrame=function(a,h,e,g,c){var b=a.worldTransform;a=b.a;var d=b.b,q=b.c,f=b.d,k=b.tx,b=b.ty,m=this.minX,v=this.minY,r=this.maxX,x=this.maxY,u=a*h+q*e+k,w=d*h+f*e+b,m=u<m?u:m,v=w<v?w:v,r=u>r?u:r,x=w>x?w:x,u=a*g+q*e+k,w=d*g+f*e+b,m=u<m?u:m,v=w<v?w:v,r=u>r?u:r,x=w>x?w:x,u=a*h+q*c+k,w=d*h+f*c+b,m=u<m?u:m,v=w<v?w:v,r=u>r?u:r,x=w>x?w:x,u=a*g+q*c+k,w=d*g+f*c+b;this.minX=u<m?u:m;this.minY=w<v?w:
v;this.maxX=u>r?u:r;this.maxY=w>x?w:x};a.prototype.addVertices=function(a,h,e,g){var c=a.worldTransform;a=c.a;for(var b=c.b,d=c.c,q=c.d,f=c.tx,c=c.ty,k=this.minX,m=this.minY,v=this.maxX,r=this.maxY;e<g;e+=2)var x=h[e],u=h[e+1],w=a*x+d*u+f,x=q*u+b*x+c,k=w<k?w:k,m=x<m?x:m,v=w>v?w:v,r=x>r?x:r;this.minX=k;this.minY=m;this.maxX=v;this.maxY=r};a.prototype.addBounds=function(a){var h=this.minX,e=this.minY,g=this.maxX,c=this.maxY;this.minX=a.minX<h?a.minX:h;this.minY=a.minY<e?a.minY:e;this.maxX=a.maxX>g?
a.maxX:g;this.maxY=a.maxY>c?a.maxY:c};a.prototype.addBoundsMask=function(a,h){var e=a.minX>h.minX?a.minX:h.minX,g=a.minY>h.minY?a.minY:h.minY,c=a.maxX<h.maxX?a.maxX:h.maxX,b=a.maxY<h.maxY?a.maxY:h.maxY;if(e<=c&&g<=b){var d=this.minX,q=this.minY,f=this.maxX,k=this.maxY;this.minX=e<d?e:d;this.minY=g<q?g:q;this.maxX=c>f?c:f;this.maxY=b>k?b:k}};a.prototype.addBoundsArea=function(a,h){var e=a.minX>h.x?a.minX:h.x,g=a.minY>h.y?a.minY:h.y,c=a.maxX<h.x+h.width?a.maxX:h.x+h.width,b=a.maxY<h.y+h.height?a.maxY:
h.y+h.height;if(e<=c&&g<=b){var d=this.minX,f=this.minY,k=this.maxX,m=this.maxY;this.minX=e<d?e:d;this.minY=g<f?g:f;this.maxX=c>k?c:k;this.maxY=b>m?b:m}};return a}();d["default"]=a},{"../math":67}],45:[function(a,b,d){function f(a,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);a.prototype=Object.create(e&&e.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(a,
e):a.__proto__=e)}d.__esModule=!0;var k=function(){function a(e,g){for(var c=0;c<g.length;c++){var h=g[c];h.enumerable=h.enumerable||!1;h.configurable=!0;"value"in h&&(h.writable=!0);Object.defineProperty(e,h.key,h)}}return function(e,g,c){g&&a(e.prototype,g);c&&a(e,c);return e}}(),n=a("../utils");a=a("./DisplayObject");a=function(a){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");var g;g=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
g=!g||"object"!==typeof g&&"function"!==typeof g?this:g;g.children=[];return g}f(e,a);e.prototype.onChildrenChange=function(){};e.prototype.addChild=function(){for(var a=arguments.length,c=Array(a),e=0;e<a;e++)c[e]=arguments[e];for(a=0;a<c.length;++a)e=c[a],e.parent&&e.parent.removeChild(e),e.parent=this,this.transform._parentID=-1,this._boundsID++,this.children.push(e),this.onChildrenChange(this.children.length-1),e.emit("added",this);return c[0]};e.prototype.addChildAt=function(a,c){if(0>c||c>this.children.length)throw Error(a+
"addChildAt: The index "+c+" supplied is out of bounds "+this.children.length);a.parent&&a.parent.removeChild(a);a.parent=this;this.children.splice(c,0,a);this.onChildrenChange(c);a.emit("added",this);return a};e.prototype.swapChildren=function(a,c){if(a!==c){var e=this.getChildIndex(a),h=this.getChildIndex(c);this.children[e]=c;this.children[h]=a;this.onChildrenChange(e<h?e:h)}};e.prototype.getChildIndex=function(a){a=this.children.indexOf(a);if(-1===a)throw Error("The supplied DisplayObject must be a child of the caller");
return a};e.prototype.setChildIndex=function(a,c){if(0>c||c>=this.children.length)throw Error("The supplied index is out of bounds");var e=this.getChildIndex(a);(0,n.removeItems)(this.children,e,1);this.children.splice(c,0,a);this.onChildrenChange(c)};e.prototype.getChildAt=function(a){if(0>a||a>=this.children.length)throw Error("getChildAt: Index ("+a+") does not exist.");return this.children[a]};e.prototype.removeChild=function(){for(var a=arguments.length,c=Array(a),e=0;e<a;e++)c[e]=arguments[e];
for(a=0;a<c.length;++a){var e=c[a],h=this.children.indexOf(e);-1!==h&&(e.parent=null,(0,n.removeItems)(this.children,h,1),this.onChildrenChange(h),e.emit("removed",this))}return c[0]};e.prototype.removeChildAt=function(a){var c=this.getChildAt(a);c.parent=null;(0,n.removeItems)(this.children,a,1);this.onChildrenChange(a);c.emit("removed",this);return c};e.prototype.removeChildren=function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,c=arguments[1],c="number"===typeof c?c:this.children.length,
e=c-a;if(0<e&&e<=c){c=this.children.splice(a,e);for(e=0;e<c.length;++e)c[e].parent=null;this.onChildrenChange(a);for(a=0;a<c.length;++a)c[a].emit("removed",this);return c}if(0===e&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.");};e.prototype.updateTransform=function(){this._boundsID++;this.transform.updateTransform(this.parent.transform);this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var a=0,c=this.children.length;a<
c;++a){var e=this.children[a];e.visible&&e.updateTransform()}};e.prototype.calculateBounds=function(){this._bounds.clear();this._calculateBounds();for(var a=0;a<this.children.length;a++){var c=this.children[a];c.visible&&c.renderable&&(c.calculateBounds(),c._mask?(c._mask.calculateBounds(),this._bounds.addBoundsMask(c._bounds,c._mask._bounds)):c.filterArea?this._bounds.addBoundsArea(c._bounds,c.filterArea):this._bounds.addBounds(c._bounds))}this._lastBoundsID=this._boundsID};e.prototype._calculateBounds=
function(){};e.prototype.renderWebGL=function(a){if(this.visible&&!(0>=this.worldAlpha)&&this.renderable)if(this._mask||this._filters)this.renderAdvancedWebGL(a);else{this._renderWebGL(a);for(var c=0,e=this.children.length;c<e;++c)this.children[c].renderWebGL(a)}};e.prototype.renderAdvancedWebGL=function(a){a.currentRenderer.flush();var c=this._filters,e=this._mask;if(c){this._enabledFilters||(this._enabledFilters=[]);for(var h=this._enabledFilters.length=0;h<c.length;h++)c[h].enabled&&this._enabledFilters.push(c[h]);
this._enabledFilters.length&&a.filterManager.pushFilter(this,this._enabledFilters)}e&&a.maskManager.pushMask(this,this._mask);a.currentRenderer.start();this._renderWebGL(a);for(var h=0,b=this.children.length;h<b;h++)this.children[h].renderWebGL(a);a.currentRenderer.flush();e&&a.maskManager.popMask(this,this._mask);c&&this._enabledFilters&&this._enabledFilters.length&&a.filterManager.popFilter();a.currentRenderer.start()};e.prototype._renderWebGL=function(a){};e.prototype._renderCanvas=function(a){};
e.prototype.renderCanvas=function(a){if(this.visible&&!(0>=this.worldAlpha)&&this.renderable){this._mask&&a.maskManager.pushMask(this._mask);this._renderCanvas(a);for(var c=0,e=this.children.length;c<e;++c)this.children[c].renderCanvas(a);this._mask&&a.maskManager.popMask(a)}};e.prototype.destroy=function(e){a.prototype.destroy.call(this);var c="boolean"===typeof e?e:e&&e.children,b=this.removeChildren(0,this.children.length);if(c)for(c=0;c<b.length;++c)b[c].destroy(e)};k(e,[{key:"width",get:function(){return this.scale.x*
this.getLocalBounds().width},set:function(a){var c=this.getLocalBounds().width;this.scale.x=0!==c?a/c:1;this._width=a}},{key:"height",get:function(){return this.scale.y*this.getLocalBounds().height},set:function(a){var c=this.getLocalBounds().height;this.scale.y=0!==c?a/c:1;this._height=a}}]);return e}((a&&a.__esModule?a:{"default":a})["default"]);d["default"]=a;a.prototype.containerUpdateTransform=a.prototype.updateTransform},{"../utils":116,"./DisplayObject":46}],46:[function(a,b,d){function f(a){return a&&
a.__esModule?a:{"default":a}}function k(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}d.__esModule=!0;var n=function(){function a(c,e){for(var g=0;g<e.length;g++){var h=e[g];h.enumerable=h.enumerable||!1;h.configurable=!0;"value"in h&&(h.writable=
!0);Object.defineProperty(c,h.key,h)}}return function(c,e,g){e&&a(c.prototype,e);g&&a(c,g);return c}}();b=a("eventemitter3");b=f(b);var h=a("../const"),e=a("./TransformStatic"),g=f(e),e=a("./Transform"),c=f(e),e=a("./Bounds"),p=f(e),y=a("../math");a=function(a){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");var b;b=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");b=!b||"object"!==typeof b&&"function"!==
typeof b?this:b;var n=h.TRANSFORM_MODE.DEFAULT===h.TRANSFORM_MODE.STATIC?g["default"]:c["default"];b.tempDisplayObjectParent=null;b.transform=new n;b.alpha=1;b.visible=!0;b.renderable=!0;b.parent=null;b.worldAlpha=1;b.filterArea=null;b._filters=null;b._enabledFilters=null;b._bounds=new p["default"];b._boundsID=0;b._lastBoundsID=-1;b._boundsRect=null;b._localBoundsRect=null;b._mask=null;return b}k(e,a);e.prototype.updateTransform=function(){this.transform.updateTransform(this.parent.transform);this.worldAlpha=
this.alpha*this.parent.worldAlpha;this._bounds.updateID++};e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)};e.prototype.getBounds=function(a,c){a||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null));this._boundsID!==
this._lastBoundsID&&this.calculateBounds();c||(this._boundsRect||(this._boundsRect=new y.Rectangle),c=this._boundsRect);return this._bounds.getRectangle(c)};e.prototype.getLocalBounds=function(a){var c=this.transform,e=this.parent;this.parent=null;this.transform=this._tempDisplayObjectParent.transform;a||(this._localBoundsRect||(this._localBoundsRect=new y.Rectangle),a=this._localBoundsRect);a=this.getBounds(!1,a);this.parent=e;this.transform=c;return a};e.prototype.toGlobal=function(a,c){2<arguments.length&&
void 0!==arguments[2]&&arguments[2]||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null));return this.worldTransform.apply(a,c)};e.prototype.toLocal=function(a,c,e,g){c&&(a=c.toGlobal(a,e,g));g||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=
null));return this.worldTransform.applyInverse(a,e)};e.prototype.renderWebGL=function(a){};e.prototype.renderCanvas=function(a){};e.prototype.setParent=function(a){if(!a||!a.addChild)throw Error("setParent: Argument must be a Container");a.addChild(this);return a};e.prototype.setTransform=function(){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,g=4<arguments.length&&
void 0!==arguments[4]?arguments[4]:0,h=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,b=6<arguments.length&&void 0!==arguments[6]?arguments[6]:0,p=7<arguments.length&&void 0!==arguments[7]?arguments[7]:0,n=8<arguments.length&&void 0!==arguments[8]?arguments[8]:0;this.position.x=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;this.position.y=a;this.scale.x=c?c:1;this.scale.y=e?e:1;this.rotation=g;this.skew.x=h;this.skew.y=b;this.pivot.x=p;this.pivot.y=n;return this};e.prototype.destroy=
function(){this.removeAllListeners();this.parent&&this.parent.removeChild(this);this.filterArea=this._mask=this._currentBounds=this._bounds=this.parent=this.transform=null;this.interactiveChildren=this.interactive=!1};n(e,[{key:"_tempDisplayObjectParent",get:function(){null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new e);return this.tempDisplayObjectParent}},{key:"x",get:function(){return this.position.x},set:function(a){this.transform.position.x=a}},{key:"y",get:function(){return this.position.y},
set:function(a){this.transform.position.y=a}},{key:"worldTransform",get:function(){return this.transform.worldTransform}},{key:"localTransform",get:function(){return this.transform.localTransform}},{key:"position",get:function(){return this.transform.position},set:function(a){this.transform.position.copy(a)}},{key:"scale",get:function(){return this.transform.scale},set:function(a){this.transform.scale.copy(a)}},{key:"pivot",get:function(){return this.transform.pivot},set:function(a){this.transform.pivot.copy(a)}},
{key:"skew",get:function(){return this.transform.skew},set:function(a){this.transform.skew.copy(a)}},{key:"rotation",get:function(){return this.transform.rotation},set:function(a){this.transform.rotation=a}},{key:"worldVisible",get:function(){var a=this;do{if(!a.visible)return!1;a=a.parent}while(a);return!0}},{key:"mask",get:function(){return this._mask},set:function(a){this._mask&&(this._mask.renderable=!0);if(this._mask=a)this._mask.renderable=!1}},{key:"filters",get:function(){return this._filters&&
this._filters.slice()},set:function(a){this._filters=a&&a.slice()}}]);return e}(b["default"]);d["default"]=a;a.prototype.displayObjectUpdateTransform=a.prototype.updateTransform},{"../const":43,"../math":67,"./Bounds":44,"./Transform":47,"./TransformStatic":49,eventemitter3:3}],47:[function(a,b,d){function f(a,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);a.prototype=Object.create(e&&e.prototype,{constructor:{value:a,
enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(a,e):a.__proto__=e)}d.__esModule=!0;var k=function(){function a(e,g){for(var c=0;c<g.length;c++){var h=g[c];h.enumerable=h.enumerable||!1;h.configurable=!0;"value"in h&&(h.writable=!0);Object.defineProperty(e,h.key,h)}}return function(e,g,c){g&&a(e.prototype,g);c&&a(e,c);return e}}(),n=a("../math");a=a("./TransformBase");a=function(a){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");
var g;g=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");g=!g||"object"!==typeof g&&"function"!==typeof g?this:g;g.position=new n.Point(0,0);g.scale=new n.Point(1,1);g.skew=new n.ObservablePoint(g.updateSkew,g,0,0);g.pivot=new n.Point(0,0);g._rotation=0;g._sr=Math.sin(0);g._cr=Math.cos(0);g._cy=Math.cos(0);g._sy=Math.sin(0);g._nsx=Math.sin(0);g._cx=Math.cos(0);return g}f(e,a);e.prototype.updateSkew=function(){this._cy=Math.cos(this.skew.y);
this._sy=Math.sin(this.skew.y);this._nsx=Math.sin(this.skew.x);this._cx=Math.cos(this.skew.x)};e.prototype.updateLocalTransform=function(){var a=this.localTransform,c=this._cr*this.scale.x,e=this._sr*this.scale.x,h=-this._sr*this.scale.y,b=this._cr*this.scale.y;a.a=this._cy*c+this._sy*h;a.b=this._cy*e+this._sy*b;a.c=this._nsx*c+this._cx*h;a.d=this._nsx*e+this._cx*b};e.prototype.updateTransform=function(a){a=a.worldTransform;var c=this.worldTransform,e=this.localTransform,h=this._cr*this.scale.x,b=
this._sr*this.scale.x,n=-this._sr*this.scale.y,d=this._cr*this.scale.y;e.a=this._cy*h+this._sy*n;e.b=this._cy*b+this._sy*d;e.c=this._nsx*h+this._cx*n;e.d=this._nsx*b+this._cx*d;e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c);e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d);c.a=e.a*a.a+e.b*a.c;c.b=e.a*a.b+e.b*a.d;c.c=e.c*a.a+e.d*a.c;c.d=e.c*a.b+e.d*a.d;c.tx=e.tx*a.a+e.ty*a.c+a.tx;c.ty=e.tx*a.b+e.ty*a.d+a.ty;this._worldID++};e.prototype.setFromMatrix=function(a){a.decompose(this)};
k(e,[{key:"rotation",get:function(){return this._rotation},set:function(a){this._rotation=a;this._sr=Math.sin(a);this._cr=Math.cos(a)}}]);return e}((a&&a.__esModule?a:{"default":a})["default"]);d["default"]=a},{"../math":67,"./TransformBase":48}],48:[function(a,b,d){d.__esModule=!0;var f=a("../math");a=function(){function a(){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.worldTransform=new f.Matrix;this.localTransform=new f.Matrix;this._parentID=this._worldID=
0}a.prototype.updateLocalTransform=function(){};a.prototype.updateTransform=function(a){a=a.worldTransform;var h=this.worldTransform,e=this.localTransform;h.a=e.a*a.a+e.b*a.c;h.b=e.a*a.b+e.b*a.d;h.c=e.c*a.a+e.d*a.c;h.d=e.c*a.b+e.d*a.d;h.tx=e.tx*a.a+e.ty*a.c+a.tx;h.ty=e.tx*a.b+e.ty*a.d+a.ty;this._worldID++};return a}();d["default"]=a;a.prototype.updateWorldTransform=a.prototype.updateTransform;a.IDENTITY=new a},{"../math":67}],49:[function(a,b,d){function f(a,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+
typeof e);a.prototype=Object.create(e&&e.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(a,e):a.__proto__=e)}d.__esModule=!0;var k=function(){function a(e,g){for(var c=0;c<g.length;c++){var h=g[c];h.enumerable=h.enumerable||!1;h.configurable=!0;"value"in h&&(h.writable=!0);Object.defineProperty(e,h.key,h)}}return function(e,g,c){g&&a(e.prototype,g);c&&a(e,c);return e}}(),n=a("../math");a=a("./TransformBase");a=function(a){function e(){if(!(this instanceof
e))throw new TypeError("Cannot call a class as a function");var g;g=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");g=!g||"object"!==typeof g&&"function"!==typeof g?this:g;g.position=new n.ObservablePoint(g.onChange,g,0,0);g.scale=new n.ObservablePoint(g.onChange,g,1,1);g.pivot=new n.ObservablePoint(g.onChange,g,0,0);g.skew=new n.ObservablePoint(g.updateSkew,g,0,0);g._rotation=0;g._sr=Math.sin(0);g._cr=Math.cos(0);g._cy=Math.cos(0);g._sy=
Math.sin(0);g._nsx=Math.sin(0);g._cx=Math.cos(0);g._localID=0;g._currentLocalID=0;return g}f(e,a);e.prototype.onChange=function(){this._localID++};e.prototype.updateSkew=function(){this._cy=Math.cos(this.skew._y);this._sy=Math.sin(this.skew._y);this._nsx=Math.sin(this.skew._x);this._cx=Math.cos(this.skew._x);this._localID++};e.prototype.updateLocalTransform=function(){var a=this.localTransform;if(this._localID!==this._currentLocalID){var c=this._cr*this.scale._x,e=this._sr*this.scale._x,h=-this._sr*
this.scale._y,b=this._cr*this.scale._y;a.a=this._cy*c+this._sy*h;a.b=this._cy*e+this._sy*b;a.c=this._nsx*c+this._cx*h;a.d=this._nsx*e+this._cx*b;a.tx=this.position._x-(this.pivot._x*a.a+this.pivot._y*a.c);a.ty=this.position._y-(this.pivot._x*a.b+this.pivot._y*a.d);this._currentLocalID=this._localID;this._parentID=-1}};e.prototype.updateTransform=function(a){var c=a.worldTransform,e=this.worldTransform,h=this.localTransform;if(this._localID!==this._currentLocalID){var b=this._cr*this.scale._x,n=this._sr*
this.scale._x,d=-this._sr*this.scale._y,f=this._cr*this.scale._y;h.a=this._cy*b+this._sy*d;h.b=this._cy*n+this._sy*f;h.c=this._nsx*b+this._cx*d;h.d=this._nsx*n+this._cx*f;h.tx=this.position._x-(this.pivot._x*h.a+this.pivot._y*h.c);h.ty=this.position._y-(this.pivot._x*h.b+this.pivot._y*h.d);this._currentLocalID=this._localID;this._parentID=-1}this._parentID!==a._worldID&&(e.a=h.a*c.a+h.b*c.c,e.b=h.a*c.b+h.b*c.d,e.c=h.c*c.a+h.d*c.c,e.d=h.c*c.b+h.d*c.d,e.tx=h.tx*c.a+h.ty*c.c+c.tx,e.ty=h.tx*c.b+h.ty*
c.d+c.ty,this._parentID=a._worldID,this._worldID++)};e.prototype.setFromMatrix=function(a){a.decompose(this);this._localID++};k(e,[{key:"rotation",get:function(){return this._rotation},set:function(a){this._rotation=a;this._sr=Math.sin(a);this._cr=Math.cos(a);this._localID++}}]);return e}((a&&a.__esModule?a:{"default":a})["default"]);d["default"]=a},{"../math":67,"./TransformBase":48}],50:[function(a,b,d){function f(a){return a&&a.__esModule?a:{"default":a}}function k(a,c){if("function"!==typeof c&&
null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}d.__esModule=!0;b=a("../display/Container");b=f(b);var n=a("../textures/RenderTexture"),h=f(n),n=a("../textures/Texture"),e=f(n),n=a("./GraphicsData"),g=f(n),n=a("../sprites/Sprite"),c=f(n),p=a("../math"),y=a("../utils"),q=a("../const"),
n=a("../display/Bounds"),A=f(n),n=a("./utils/bezierCurveTo"),z=f(n);a=a("../renderers/canvas/CanvasRenderer");var t=f(a),v=void 0,r=new p.Matrix,x=new p.Point,u=new Float32Array(4),w=new Float32Array(4);a=function(a){function b(){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var c;c=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");c=!c||"object"!==typeof c&&"function"!==typeof c?this:c;c.fillAlpha=1;c.lineWidth=
0;c.lineColor=0;c.graphicsData=[];c.tint=16777215;c._prevTint=16777215;c.blendMode=q.BLEND_MODES.NORMAL;c.currentPath=null;c._webGL={};c.isMask=!1;c.boundsPadding=0;c._localBounds=new A["default"];c.dirty=0;c.fastRectDirty=-1;c.clearDirty=0;c.boundsDirty=-1;c.cachedSpriteDirty=!1;c._spriteRect=null;c._fastRect=!1;return c}k(b,a);b.prototype.clone=function(){var a=new b;a.renderable=this.renderable;a.fillAlpha=this.fillAlpha;a.lineWidth=this.lineWidth;a.lineColor=this.lineColor;a.tint=this.tint;a.blendMode=
this.blendMode;a.isMask=this.isMask;a.boundsPadding=this.boundsPadding;a.dirty=0;a.cachedSpriteDirty=this.cachedSpriteDirty;for(var c=0;c<this.graphicsData.length;++c)a.graphicsData.push(this.graphicsData[c].clone());a.currentPath=a.graphicsData[a.graphicsData.length-1];a.updateLocalBounds();return a};b.prototype.lineStyle=function(){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;this.lineWidth=0<arguments.length&&void 0!==
arguments[0]?arguments[0]:0;this.lineColor=a;this.lineAlpha=c;this.currentPath&&(this.currentPath.shape.points.length?(a=new p.Polygon(this.currentPath.shape.points.slice(-2)),a.closed=!1,this.drawShape(a)):(this.currentPath.lineWidth=this.lineWidth,this.currentPath.lineColor=this.lineColor,this.currentPath.lineAlpha=this.lineAlpha));return this};b.prototype.moveTo=function(a,c){var e=new p.Polygon([a,c]);e.closed=!1;this.drawShape(e);return this};b.prototype.lineTo=function(a,c){this.currentPath.shape.points.push(a,
c);this.dirty++;return this};b.prototype.quadraticCurveTo=function(a,c,e,g){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var h=this.currentPath.shape.points,b,n;0===h.length&&this.moveTo(0,0);for(var p=h[h.length-2],d=h[h.length-1],f=1;20>=f;++f){var q=f/20;b=p+(a-p)*q;n=d+(c-d)*q;h.push(b+(a+(e-a)*q-b)*q,n+(c+(g-c)*q-n)*q)}this.dirty++;return this};b.prototype.bezierCurveTo=function(a,c,e,g,h,b){this.currentPath?0===this.currentPath.shape.points.length&&
(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var n=this.currentPath.shape.points,p=n[n.length-2],d=n[n.length-1];n.length-=2;(0,z["default"])(p,d,a,c,e,g,h,b,n);this.dirty++;return this};b.prototype.arcTo=function(a,c,e,g,h){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(a,c):this.moveTo(a,c);var b=this.currentPath.shape.points,n=b[b.length-1]-c,p=b[b.length-2]-a;g-=c;e-=a;var d=Math.abs(n*e-p*g);if(1E-8>d||0===h)b[b.length-2]===a&&b[b.length-
1]===c||b.push(a,c);else{var f=n*n+p*p,q=g*g+e*e,k=n*g+p*e,b=h*Math.sqrt(f)/d,d=h*Math.sqrt(q)/d,f=b*k/f,q=d*k/q,k=b*e+d*p,m=b*g+d*n;this.arc(k+a,m+c,h,Math.atan2(n*(d+f)-m,p*(d+f)-k),Math.atan2(g*(b+q)-m,e*(b+q)-k),p*g>e*n)}this.dirty++;return this};b.prototype.arc=function(a,c,e,g,h){var b=5<arguments.length&&void 0!==arguments[5]?arguments[5]:!1;if(g===h)return this;!b&&h<=g?h+=2*Math.PI:b&&g<=h&&(g+=2*Math.PI);var n=b?g-h:h-g,p=40*Math.ceil(Math.abs(n)/(2*Math.PI));if(0===n)return this;var d=
a+Math.cos(g)*e,f=c+Math.sin(g)*e,b=this.currentPath.shape.points;this.currentPath?b[b.length-2]===d&&b[b.length-1]===f||b.push(d,f):this.moveTo(d,f);for(var n=n/(2*p),d=2*n,f=Math.cos(n),q=Math.sin(n),p=p-1,k=p%1/p,m=0;m<=p;++m){var y=n+g+d*(m+k*m),A=Math.cos(y),y=-Math.sin(y);b.push((f*A+q*y)*e+a,(f*-y+q*A)*e+c)}this.dirty++;return this};b.prototype.beginFill=function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;this.filling=
!0;this.fillColor=a;this.fillAlpha=c;this.currentPath&&2>=this.currentPath.shape.points.length&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha);return this};b.prototype.endFill=function(){this.filling=!1;this.fillColor=null;this.fillAlpha=1;return this};b.prototype.drawRect=function(a,c,e,g){this.drawShape(new p.Rectangle(a,c,e,g));return this};b.prototype.drawRoundedRect=function(a,c,e,g,h){this.drawShape(new p.RoundedRectangle(a,
c,e,g,h));return this};b.prototype.drawCircle=function(a,c,e){this.drawShape(new p.Circle(a,c,e));return this};b.prototype.drawEllipse=function(a,c,e,g){this.drawShape(new p.Ellipse(a,c,e,g));return this};b.prototype.drawPolygon=function(a){var c=a,e=!0;c instanceof p.Polygon&&(e=c.closed,c=c.points);if(!Array.isArray(c))for(var c=Array(arguments.length),g=0;g<c.length;++g)c[g]=arguments[g];c=new p.Polygon(c);c.closed=e;this.drawShape(c);return this};b.prototype.clear=function(){if(this.lineWidth||
this.filling||0<this.graphicsData.length)this.lineWidth=0,this.filling=!1,this.dirty++,this.clearDirty++,this.graphicsData.length=0;return this};b.prototype.isFastRect=function(){return 1===this.graphicsData.length&&this.graphicsData[0].shape.type===q.SHAPES.RECT&&!this.graphicsData[0].lineWidth};b.prototype._renderWebGL=function(a){this.dirty!==this.fastRectDirty&&(this.fastRectDirty=this.dirty,this._fastRect=this.isFastRect());this._fastRect?this._renderSpriteRect(a):(a.setObjectRenderer(a.plugins.graphics),
a.plugins.graphics.render(this))};b.prototype._renderSpriteRect=function(a){var g=this.graphicsData[0].shape;if(!this._spriteRect){if(!b._SPRITE_TEXTURE){b._SPRITE_TEXTURE=h["default"].create(10,10);var n=document.createElement("canvas");n.width=10;n.height=10;var p=n.getContext("2d");p.fillStyle="white";p.fillRect(0,0,10,10);b._SPRITE_TEXTURE=e["default"].fromCanvas(n)}this._spriteRect=new c["default"](b._SPRITE_TEXTURE)}16777215===this.tint?this._spriteRect.tint=this.graphicsData[0].fillColor:((0,
y.hex2rgb)(this.graphicsData[0].fillColor,u),(0,y.hex2rgb)(this.tint,w),u[0]*=w[0],u[1]*=w[1],u[2]*=w[2],this._spriteRect.tint=(0,y.rgb2hex)(u));this._spriteRect.alpha=this.graphicsData[0].fillAlpha;this._spriteRect.worldAlpha=this.worldAlpha*this._spriteRect.alpha;b._SPRITE_TEXTURE._frame.width=g.width;b._SPRITE_TEXTURE._frame.height=g.height;this._spriteRect.transform.worldTransform=this.transform.worldTransform;this._spriteRect.anchor.set(-g.x/g.width,-g.y/g.height);this._spriteRect._onAnchorUpdate();
this._spriteRect._renderWebGL(a)};b.prototype._renderCanvas=function(a){!0!==this.isMask&&a.plugins.graphics.render(this)};b.prototype._calculateBounds=function(){this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.updateLocalBounds(),this.dirty++,this.cachedSpriteDirty=!0);var a=this._localBounds;this._bounds.addFrame(this.transform,a.minX,a.minY,a.maxX,a.maxY)};b.prototype.containsPoint=function(a){this.worldTransform.applyInverse(a,x);a=this.graphicsData;for(var c=0;c<a.length;++c){var e=
a[c];if(e.fill&&e.shape&&e.shape.contains(x.x,x.y))return!0}return!1};b.prototype.updateLocalBounds=function(){var a=Infinity,c=-Infinity,e=Infinity,g=-Infinity;if(this.graphicsData.length)for(var h,b,n,p,d,f=0;f<this.graphicsData.length;f++)if(n=this.graphicsData[f],b=n.type,d=n.lineWidth,h=n.shape,b===q.SHAPES.RECT||b===q.SHAPES.RREC)b=h.x-d/2,n=h.y-d/2,p=h.width+d,d=h.height+d,a=b<a?b:a,c=b+p>c?b+p:c,e=n<e?n:e,g=n+d>g?n+d:g;else if(b===q.SHAPES.CIRC)b=h.x,n=h.y,p=h.radius+d/2,d=h.radius+d/2,a=
b-p<a?b-p:a,c=b+p>c?b+p:c,e=n-d<e?n-d:e,g=n+d>g?n+d:g;else if(b===q.SHAPES.ELIP)b=h.x,n=h.y,p=h.width+d/2,d=h.height+d/2,a=b-p<a?b-p:a,c=b+p>c?b+p:c,e=n-d<e?n-d:e,g=n+d>g?n+d:g;else for(h=h.points,p=0;p<h.length;p+=2)b=h[p],n=h[p+1],a=b-d<a?b-d:a,c=b+d>c?b+d:c,e=n-d<e?n-d:e,g=n+d>g?n+d:g;else g=e=c=a=0;f=this.boundsPadding;this._localBounds.minX=a-f;this._localBounds.maxX=c+2*f;this._localBounds.minY=e-f;this._localBounds.maxY=g+2*f};b.prototype.drawShape=function(a){this.currentPath&&2>=this.currentPath.shape.points.length&&
this.graphicsData.pop();this.currentPath=null;a=new g["default"](this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,a);this.graphicsData.push(a);a.type===q.SHAPES.POLY&&(a.shape.closed=a.shape.closed||this.filling,this.currentPath=a);this.dirty++;return a};b.prototype.generateCanvasTexture=function(a){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,g=this.getLocalBounds(),b=h["default"].create(g.width,g.height,a,c);v||(v=new t["default"]);r.tx=-g.x;
r.ty=-g.y;v.render(this,b,!1,r);g=e["default"].fromCanvas(b.baseTexture._canvasRenderTarget.canvas,a);g.baseTexture.resolution=c;g.baseTexture.update();return g};b.prototype.closePath=function(){var a=this.currentPath;a&&a.shape&&a.shape.close();return this};b.prototype.addHole=function(){var a=this.graphicsData.pop();this.currentPath=this.graphicsData[this.graphicsData.length-1];this.currentPath.addHole(a.shape);this.currentPath=null;return this};b.prototype.destroy=function(c){a.prototype.destroy.call(this,
c);for(c=0;c<this.graphicsData.length;++c)this.graphicsData[c].destroy();for(var e in this._webgl)for(c=0;c<this._webgl[e].data.length;++c)this._webgl[e].data[c].destroy();this._spriteRect&&this._spriteRect.destroy();this._localBounds=this._webgl=this.currentPath=this.graphicsData=null};return b}(b["default"]);d["default"]=a;a._SPRITE_TEXTURE=null},{"../const":43,"../display/Bounds":44,"../display/Container":45,"../math":67,"../renderers/canvas/CanvasRenderer":74,"../sprites/Sprite":98,"../textures/RenderTexture":108,
"../textures/Texture":109,"../utils":116,"./GraphicsData":51,"./utils/bezierCurveTo":53}],51:[function(a,b,d){d.__esModule=!0;a=function(){function a(b,n,h,e,g,c,p){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.lineWidth=b;this.lineColor=n;this.lineAlpha=h;this._lineTint=n;this.fillColor=e;this.fillAlpha=g;this._fillTint=e;this.fill=c;this.holes=[];this.shape=p;this.type=p.type}a.prototype.clone=function(){return new a(this.lineWidth,this.lineColor,this.lineAlpha,
this.fillColor,this.fillAlpha,this.fill,this.shape)};a.prototype.addHole=function(a){this.holes.push(a)};a.prototype.destroy=function(){this.holes=this.shape=null};return a}();d["default"]=a},{}],52:[function(a,b,d){d.__esModule=!0;b=(b=a("../../renderers/canvas/CanvasRenderer"))&&b.__esModule?b:{"default":b};var f=a("../../const");a=function(){function a(b){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.renderer=b}a.prototype.render=function(a){var h=this.renderer,
e=h.context,g=a.worldAlpha,c=a.transform.worldTransform,b=h.resolution;this._prevTint!==this.tint&&(this.dirty=!0);e.setTransform(c.a*b,c.b*b,c.c*b,c.d*b,c.tx*b,c.ty*b);a.dirty&&(this.updateGraphicsTint(a),a.dirty=!1);h.setBlendMode(a.blendMode);for(h=0;h<a.graphicsData.length;h++){var c=a.graphicsData[h],d=c.shape,b=c._fillTint,q=c._lineTint;e.lineWidth=c.lineWidth;if(c.type===f.SHAPES.POLY){e.beginPath();this.renderPolygon(d.points,d.closed,e);for(var k=0;k<c.holes.length;k++)this.renderPolygon(c.holes[k].points,
!0,e);c.fill&&(e.globalAlpha=c.fillAlpha*g,e.fillStyle="#"+("00000"+(b|0).toString(16)).substr(-6),e.fill());c.lineWidth&&(e.globalAlpha=c.lineAlpha*g,e.strokeStyle="#"+("00000"+(q|0).toString(16)).substr(-6),e.stroke())}else if(c.type===f.SHAPES.RECT){if(c.fillColor||0===c.fillColor)e.globalAlpha=c.fillAlpha*g,e.fillStyle="#"+("00000"+(b|0).toString(16)).substr(-6),e.fillRect(d.x,d.y,d.width,d.height);c.lineWidth&&(e.globalAlpha=c.lineAlpha*g,e.strokeStyle="#"+("00000"+(q|0).toString(16)).substr(-6),
e.strokeRect(d.x,d.y,d.width,d.height))}else if(c.type===f.SHAPES.CIRC)e.beginPath(),e.arc(d.x,d.y,d.radius,0,2*Math.PI),e.closePath(),c.fill&&(e.globalAlpha=c.fillAlpha*g,e.fillStyle="#"+("00000"+(b|0).toString(16)).substr(-6),e.fill()),c.lineWidth&&(e.globalAlpha=c.lineAlpha*g,e.strokeStyle="#"+("00000"+(q|0).toString(16)).substr(-6),e.stroke());else if(c.type===f.SHAPES.ELIP){var m=2*d.width,t=2*d.height,k=d.x-m/2,d=d.y-t/2;e.beginPath();var v=m/2*.5522848,r=t/2*.5522848,x=k+m,u=d+t,m=k+m/2,t=
d+t/2;e.moveTo(k,t);e.bezierCurveTo(k,t-r,m-v,d,m,d);e.bezierCurveTo(m+v,d,x,t-r,x,t);e.bezierCurveTo(x,t+r,m+v,u,m,u);e.bezierCurveTo(m-v,u,k,t+r,k,t);e.closePath();c.fill&&(e.globalAlpha=c.fillAlpha*g,e.fillStyle="#"+("00000"+(b|0).toString(16)).substr(-6),e.fill());c.lineWidth&&(e.globalAlpha=c.lineAlpha*g,e.strokeStyle="#"+("00000"+(q|0).toString(16)).substr(-6),e.stroke())}else if(c.type===f.SHAPES.RREC){k=d.x;t=d.y;v=d.width;r=d.height;d=d.radius;x=Math.min(v,r)/2|0;d=d>x?x:d;e.beginPath();
e.moveTo(k,t+d);e.lineTo(k,t+r-d);e.quadraticCurveTo(k,t+r,k+d,t+r);e.lineTo(k+v-d,t+r);e.quadraticCurveTo(k+v,t+r,k+v,t+r-d);e.lineTo(k+v,t+d);e.quadraticCurveTo(k+v,t,k+v-d,t);e.lineTo(k+d,t);e.quadraticCurveTo(k,t,k,t+d);e.closePath();if(c.fillColor||0===c.fillColor)e.globalAlpha=c.fillAlpha*g,e.fillStyle="#"+("00000"+(b|0).toString(16)).substr(-6),e.fill();c.lineWidth&&(e.globalAlpha=c.lineAlpha*g,e.strokeStyle="#"+("00000"+(q|0).toString(16)).substr(-6),e.stroke())}}};a.prototype.updateGraphicsTint=
function(a){a._prevTint=a.tint;for(var h=(a.tint>>16&255)/255,e=(a.tint>>8&255)/255,g=(a.tint&255)/255,c=0;c<a.graphicsData.length;++c){var b=a.graphicsData[c],d=b.fillColor|0,f=b.lineColor|0;b._fillTint=((d>>16&255)/255*h*255<<16)+((d>>8&255)/255*e*255<<8)+(d&255)/255*g*255;b._lineTint=((f>>16&255)/255*h*255<<16)+((f>>8&255)/255*e*255<<8)+(f&255)/255*g*255}};a.prototype.renderPolygon=function(a,h,e){e.moveTo(a[0],a[1]);for(var g=1;g<a.length/2;++g)e.lineTo(a[2*g],a[2*g+1]);h&&e.closePath()};a.prototype.destroy=
function(){this.renderer=null};return a}();d["default"]=a;b["default"].registerPlugin("graphics",a)},{"../../const":43,"../../renderers/canvas/CanvasRenderer":74}],53:[function(a,b,d){d.__esModule=!0;d["default"]=function(a,b,n,h,e,g,c,p){var d=8<arguments.length&&void 0!==arguments[8]?arguments[8]:[],q,m,z,t,v;d.push(a,b);for(var r=1,x;20>=r;++r)x=r/20,q=1-x,m=q*q,z=m*q,t=x*x,v=t*x,d.push(z*a+3*m*x*n+3*q*t*e+v*c,z*b+3*m*x*h+3*q*t*g+v*p);return d}},{}],54:[function(a,b,d){function f(a){return a&&
a.__esModule?a:{"default":a}}function k(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}d.__esModule=!0;var n=a("../../utils"),h=a("../../const");b=a("../../renderers/webgl/utils/ObjectRenderer");var e=f(b);b=a("../../renderers/webgl/WebGLRenderer");
b=f(b);var g=a("./WebGLGraphicsData"),c=f(g),g=a("./shaders/PrimitiveShader"),p=f(g),g=a("./utils/buildPoly"),y=f(g),g=a("./utils/buildRectangle"),q=f(g),g=a("./utils/buildRoundedRectangle"),A=f(g);a=a("./utils/buildCircle");var z=f(a);a=function(a){function g(c){if(!(this instanceof g))throw new TypeError("Cannot call a class as a function");var e;e=a.call(this,c);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");e=!e||"object"!==typeof e&&"function"!==
typeof e?this:e;e.graphicsDataPool=[];e.primitiveShader=null;e.gl=c.gl;e.CONTEXT_UID=0;return e}k(g,a);g.prototype.onContextChange=function(){this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID;this.primitiveShader=new p["default"](this.gl)};g.prototype.destroy=function(){e["default"].prototype.destroy.call(this);for(var a=0;a<this.graphicsDataPool.length;++a)this.graphicsDataPool[a].destroy();this.graphicsDataPool=null};g.prototype.render=function(a){var c=this.renderer,e=c.gl,g,
h=a._webGL[this.CONTEXT_UID];h&&a.dirty===h.dirty||(this.updateGraphics(a),h=a._webGL[this.CONTEXT_UID]);c.bindShader(this.primitiveShader);c.state.setBlendMode(a.blendMode);for(var b=0,p=h.data.length;b<p;b++){g=h.data[b];var d=g.shader;c.bindShader(d);d.uniforms.translationMatrix=a.transform.worldTransform.toArray(!0);d.uniforms.tint=(0,n.hex2rgb)(a.tint);d.uniforms.alpha=a.worldAlpha;g.vao.bind().draw(e.TRIANGLE_STRIP,g.indices.length).unbind()}};g.prototype.updateGraphics=function(a){var c=this.renderer.gl,
e=a._webGL[this.CONTEXT_UID];e||(e=a._webGL[this.CONTEXT_UID]={lastIndex:0,data:[],gl:c,clearDirty:-1,dirty:-1});e.dirty=a.dirty;if(a.clearDirty!==e.clearDirty){e.clearDirty=a.clearDirty;for(c=0;c<e.data.length;c++)this.graphicsDataPool.push(e.data[c]);e.data.length=0;e.lastIndex=0}for(var g=e.lastIndex;g<a.graphicsData.length;g++){var b=a.graphicsData[g],c=this.getWebGLData(e,0);b.type===h.SHAPES.POLY&&(0,y["default"])(b,c);b.type===h.SHAPES.RECT?(0,q["default"])(b,c):b.type===h.SHAPES.CIRC||b.type===
h.SHAPES.ELIP?(0,z["default"])(b,c):b.type===h.SHAPES.RREC&&(0,A["default"])(b,c);e.lastIndex++}for(a=0;a<e.data.length;a++)c=e.data[a],c.dirty&&c.upload()};g.prototype.getWebGLData=function(a,e){var g=a.data[a.data.length-1];if(!g||32E4<g.points.length)g=this.graphicsDataPool.pop()||new c["default"](this.renderer.gl,this.primitiveShader,this.renderer.state.attribsState),g.reset(e),a.data.push(g);g.dirty=!0;return g};return g}(e["default"]);d["default"]=a;b["default"].registerPlugin("graphics",a)},
{"../../const":43,"../../renderers/webgl/WebGLRenderer":81,"../../renderers/webgl/utils/ObjectRenderer":91,"../../utils":116,"./WebGLGraphicsData":55,"./shaders/PrimitiveShader":56,"./utils/buildCircle":57,"./utils/buildPoly":59,"./utils/buildRectangle":60,"./utils/buildRoundedRectangle":61}],55:[function(a,b,d){d.__esModule=!0;var f=(a=a("pixi-gl-core"))&&a.__esModule?a:{"default":a};a=function(){function a(b,h,e){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.gl=
b;this.color=[0,0,0];this.points=[];this.indices=[];this.buffer=f["default"].GLBuffer.createVertexBuffer(b);this.indexBuffer=f["default"].GLBuffer.createIndexBuffer(b);this.dirty=!0;this.glIndices=this.glPoints=null;this.shader=h;this.vao=(new f["default"].VertexArrayObject(b,e)).addIndex(this.indexBuffer).addAttribute(this.buffer,h.attributes.aVertexPosition,b.FLOAT,!1,24,0).addAttribute(this.buffer,h.attributes.aColor,b.FLOAT,!1,24,8)}a.prototype.reset=function(){this.points.length=0;this.indices.length=
0};a.prototype.upload=function(){this.glPoints=new Float32Array(this.points);this.buffer.upload(this.glPoints);this.glIndices=new Uint16Array(this.indices);this.indexBuffer.upload(this.glIndices);this.dirty=!1};a.prototype.destroy=function(){this.indices=this.points=this.color=null;this.vao.destroy();this.buffer.destroy();this.indexBuffer.destroy();this.glIndices=this.glPoints=this.indexBuffer=this.buffer=this.gl=null};return a}();d["default"]=a},{"pixi-gl-core":12}],56:[function(a,b,d){function f(a,
b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}d.__esModule=!0;a=a("../../../Shader");a=function(a){function b(h){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");h=a.call(this,h,"attribute vec2 aVertexPosition;\nattribute vec4 aColor;\nuniform mat3 translationMatrix;\nuniform mat3 projectionMatrix;\nuniform float alpha;\nuniform vec3 tint;\nvarying vec4 vColor;\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vColor = aColor * vec4(tint * alpha, alpha);\n}",
"varying vec4 vColor;\nvoid main(void){\n   gl_FragColor = vColor;\n}");if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!h||"object"!==typeof h&&"function"!==typeof h?this:h}f(b,a);return b}((a&&a.__esModule?a:{"default":a})["default"]);d["default"]=a},{"../../../Shader":42}],57:[function(a,b,d){d.__esModule=!0;d["default"]=function(a,e){var g=a.shape,c=g.x,b=g.y,d,q;a.type===k.SHAPES.CIRC?q=d=g.radius:(d=g.width,q=g.height);var g=Math.floor(30*
Math.sqrt(g.radius))||Math.floor(15*Math.sqrt(g.width+g.height)),m=2*Math.PI/g;if(a.fill){var z=(0,n.hex2rgb)(a.fillColor),t=a.fillAlpha,v=z[0]*t,r=z[1]*t,z=z[2]*t,x=e.points,u=e.indices,w=x.length/6;u.push(w);for(var B=0;B<g+1;B++)x.push(c,b,v,r,z,t),x.push(c+Math.sin(m*B)*d,b+Math.cos(m*B)*q,v,r,z,t),u.push(w++,w++);u.push(w-1)}if(a.lineWidth){t=a.points;a.points=[];for(v=0;v<g+1;v++)a.points.push(c+Math.sin(m*v)*d,b+Math.cos(m*v)*q);(0,f["default"])(a,e);a.points=t}};var f=(b=a("./buildLine"))&&
b.__esModule?b:{"default":b},k=a("../../../const"),n=a("../../../utils")},{"../../../const":43,"../../../utils":116,"./buildLine":58}],58:[function(a,b,d){d.__esModule=!0;d["default"]=function(a,h){var e=a.points;if(0!==e.length){var g=new f.Point(e[0],e[1]),c=new f.Point(e[e.length-2],e[e.length-1]);if(g.x===c.x&&g.y===c.y){e=e.slice();e.pop();e.pop();var c=new f.Point(e[e.length-2],e[e.length-1]),b=c.x+.5*(g.x-c.x),g=c.y+.5*(g.y-c.y);e.unshift(b,g);e.push(b,g)}var d=h.points,b=h.indices,q=e.length/
2,g=e.length,c=d.length/6,m=a.lineWidth/2,z=(0,k.hex2rgb)(a.lineColor),t=a.lineAlpha,v=z[0]*t,r=z[1]*t,z=z[2]*t,x=e[0],u=e[1],w=e[2],B=e[3],G,K,C=-(u-B),H=x-w,I,L,F=Math.sqrt(C*C+H*H),C=C/F*m,H=H/F*m;d.push(x-C,u-H,v,r,z,t);d.push(x+C,u+H,v,r,z,t);for(var P=1;P<q-1;++P){x=e[2*(P-1)];u=e[2*(P-1)+1];w=e[2*P];B=e[2*P+1];G=e[2*(P+1)];K=e[2*(P+1)+1];C=-(u-B);H=x-w;F=Math.sqrt(C*C+H*H);C/=F;H/=F;C*=m;H*=m;I=-(B-K);L=w-G;F=Math.sqrt(I*I+L*L);I/=F;L/=F;I*=m;L*=m;var F=-H+u-(-H+B),O=-C+w-(-C+x),x=(-C+x)*(-H+
B)-(-C+w)*(-H+u),u=-L+K-(-L+B),N=-I+w-(-I+G);G=(-I+G)*(-L+B)-(-I+w)*(-L+K);K=F*N-u*O;.1>Math.abs(K)?(d.push(w-C,B-H,v,r,z,t),d.push(w+C,B+H,v,r,z,t)):(O=(O*G-N*x)/K,F=(u*x-F*G)/K,(O-w)*(O-w)+(F-B)*(F-B)>196*m*m?(C-=I,H-=L,F=Math.sqrt(C*C+H*H),C/=F,H/=F,C*=m,H*=m,d.push(w-C,B-H),d.push(v,r,z,t),d.push(w+C,B+H),d.push(v,r,z,t),d.push(w-C,B-H),d.push(v,r,z,t),g++):(d.push(O,F),d.push(v,r,z,t),d.push(w-(O-w),B-(F-B)),d.push(v,r,z,t)))}x=e[2*(q-2)];u=e[2*(q-2)+1];w=e[2*(q-1)];B=e[2*(q-1)+1];C=-(u-B);H=
x-w;F=Math.sqrt(C*C+H*H);C=C/F*m;H=H/F*m;d.push(w-C,B-H);d.push(v,r,z,t);d.push(w+C,B+H);d.push(v,r,z,t);b.push(c);for(e=0;e<g;++e)b.push(c++);b.push(c-1)}};var f=a("../../../math"),k=a("../../../utils")},{"../../../math":67,"../../../utils":116}],59:[function(a,b,d){d.__esModule=!0;d["default"]=function(a,e){a.points=a.shape.points.slice();var g=a.points;if(a.fill&&6<=g.length){for(var c=[],b=a.holes,d=0;d<b.length;d++){var q=b[d];c.push(g.length/2);g=g.concat(q.points)}var b=e.points,m=e.indices,
d=g.length/2,z=(0,k.hex2rgb)(a.fillColor),q=a.fillAlpha,t=z[0]*q,v=z[1]*q,z=z[2]*q,c=(0,n["default"])(g,c,2);if(!c)return;for(var r=b.length/6,x=0;x<c.length;x+=3)m.push(c[x]+r),m.push(c[x]+r),m.push(c[x+1]+r),m.push(c[x+2]+r),m.push(c[x+2]+r);for(c=0;c<d;c++)b.push(g[2*c],g[2*c+1],t,v,z,q)}0<a.lineWidth&&(0,f["default"])(a,e)};var f=(b=a("./buildLine"))&&b.__esModule?b:{"default":b},k=a("../../../utils"),n=(a=a("earcut"))&&a.__esModule?a:{"default":a}},{"../../../utils":116,"./buildLine":58,earcut:2}],
60:[function(a,b,d){d.__esModule=!0;d["default"]=function(a,h){var e=a.shape,g=e.x,c=e.y,b=e.width,e=e.height;if(a.fill){var d=(0,k.hex2rgb)(a.fillColor),q=a.fillAlpha,m=d[0]*q,z=d[1]*q,d=d[2]*q,t=h.points,v=h.indices,r=t.length/6;t.push(g,c);t.push(m,z,d,q);t.push(g+b,c);t.push(m,z,d,q);t.push(g,c+e);t.push(m,z,d,q);t.push(g+b,c+e);t.push(m,z,d,q);v.push(r,r,r+1,r+2,r+3,r+3)}a.lineWidth&&(q=a.points,a.points=[g,c,g+b,c,g+b,c+e,g,c+e,g,c],(0,f["default"])(a,h),a.points=q)};var f=(b=a("./buildLine"))&&
b.__esModule?b:{"default":b},k=a("../../../utils")},{"../../../utils":116,"./buildLine":58}],61:[function(a,b,d){function f(a,g,c,h,b,d){for(var n=6<arguments.length&&void 0!==arguments[6]?arguments[6]:[],f,k,m,r,x=0,u;20>=x;++x)u=x/20,f=a+(c-a)*u,k=g+(h-g)*u,m=c+(b-c)*u,r=h+(d-h)*u,f+=(m-f)*u,k+=(r-k)*u,n.push(f,k);return n}d.__esModule=!0;d["default"]=function(a,g){var c=a.shape,b=c.x,d=c.y,q=c.width,m=c.height,z=c.radius,c=[];c.push(b,d+z);f(b,d+m-z,b,d+m,b+z,d+m,c);f(b+q-z,d+m,b+q,d+m,b+q,d+m-
z,c);f(b+q,d+z,b+q,d,b+q-z,d,c);f(b+z,d,b,d,b,d+z+1E-10,c);if(a.fill){for(var m=(0,h.hex2rgb)(a.fillColor),b=a.fillAlpha,d=m[0]*b,q=m[1]*b,m=m[2]*b,z=g.points,t=g.indices,v=z.length/6,r=(0,k["default"])(c,null,2),x=0,u=r.length;x<u;x+=3)t.push(r[x]+v),t.push(r[x]+v),t.push(r[x+1]+v),t.push(r[x+2]+v),t.push(r[x+2]+v);t=0;for(v=c.length;t<v;t++)z.push(c[t],c[++t],d,q,m,b)}a.lineWidth&&(b=a.points,a.points=c,(0,n["default"])(a,g),a.points=b)};var k=(b=a("earcut"))&&b.__esModule?b:{"default":b},n=(b=
a("./buildLine"))&&b.__esModule?b:{"default":b},h=a("../../../utils")},{"../../../utils":116,"./buildLine":58,earcut:2}],62:[function(a,b,d){function f(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(c[e]=a[e]);c["default"]=a;return c}function k(a){return a&&a.__esModule?a:{"default":a}}d.__esModule=!0;d.Filter=d.SpriteMaskFilter=d.Quad=d.RenderTarget=d.ObjectRenderer=d.WebGLManager=d.Shader=d.CanvasRenderTarget=d.TextureUvs=d.VideoBaseTexture=
d.BaseRenderTexture=d.RenderTexture=d.BaseTexture=d.Texture=d.CanvasGraphicsRenderer=d.GraphicsRenderer=d.GraphicsData=d.Graphics=d.TextStyle=d.Text=d.SpriteRenderer=d.CanvasTinter=d.CanvasSpriteRenderer=d.Sprite=d.TransformBase=d.TransformStatic=d.Transform=d.Container=d.DisplayObject=d.glCore=d.WebGLRenderer=d.CanvasRenderer=d.ticker=d.utils=void 0;var n=a("./const");Object.keys(n).forEach(function(a){"default"!==a&&"__esModule"!==a&&Object.defineProperty(d,a,{enumerable:!0,get:function(){return n[a]}})});
var h=a("./math");Object.keys(h).forEach(function(a){"default"!==a&&"__esModule"!==a&&Object.defineProperty(d,a,{enumerable:!0,get:function(){return h[a]}})});var e=a("pixi-gl-core");Object.defineProperty(d,"glCore",{enumerable:!0,get:function(){return k(e)["default"]}});var g=a("./display/DisplayObject");Object.defineProperty(d,"DisplayObject",{enumerable:!0,get:function(){return k(g)["default"]}});var c=a("./display/Container");Object.defineProperty(d,"Container",{enumerable:!0,get:function(){return k(c)["default"]}});
var p=a("./display/Transform");Object.defineProperty(d,"Transform",{enumerable:!0,get:function(){return k(p)["default"]}});var y=a("./display/TransformStatic");Object.defineProperty(d,"TransformStatic",{enumerable:!0,get:function(){return k(y)["default"]}});var q=a("./display/TransformBase");Object.defineProperty(d,"TransformBase",{enumerable:!0,get:function(){return k(q)["default"]}});var A=a("./sprites/Sprite");Object.defineProperty(d,"Sprite",{enumerable:!0,get:function(){return k(A)["default"]}});
var z=a("./sprites/canvas/CanvasSpriteRenderer");Object.defineProperty(d,"CanvasSpriteRenderer",{enumerable:!0,get:function(){return k(z)["default"]}});var t=a("./sprites/canvas/CanvasTinter");Object.defineProperty(d,"CanvasTinter",{enumerable:!0,get:function(){return k(t)["default"]}});var v=a("./sprites/webgl/SpriteRenderer");Object.defineProperty(d,"SpriteRenderer",{enumerable:!0,get:function(){return k(v)["default"]}});var r=a("./text/Text");Object.defineProperty(d,"Text",{enumerable:!0,get:function(){return k(r)["default"]}});
var x=a("./text/TextStyle");Object.defineProperty(d,"TextStyle",{enumerable:!0,get:function(){return k(x)["default"]}});var u=a("./graphics/Graphics");Object.defineProperty(d,"Graphics",{enumerable:!0,get:function(){return k(u)["default"]}});var w=a("./graphics/GraphicsData");Object.defineProperty(d,"GraphicsData",{enumerable:!0,get:function(){return k(w)["default"]}});var B=a("./graphics/webgl/GraphicsRenderer");Object.defineProperty(d,"GraphicsRenderer",{enumerable:!0,get:function(){return k(B)["default"]}});
var G=a("./graphics/canvas/CanvasGraphicsRenderer");Object.defineProperty(d,"CanvasGraphicsRenderer",{enumerable:!0,get:function(){return k(G)["default"]}});var K=a("./textures/Texture");Object.defineProperty(d,"Texture",{enumerable:!0,get:function(){return k(K)["default"]}});var C=a("./textures/BaseTexture");Object.defineProperty(d,"BaseTexture",{enumerable:!0,get:function(){return k(C)["default"]}});var H=a("./textures/RenderTexture");Object.defineProperty(d,"RenderTexture",{enumerable:!0,get:function(){return k(H)["default"]}});
var I=a("./textures/BaseRenderTexture");Object.defineProperty(d,"BaseRenderTexture",{enumerable:!0,get:function(){return k(I)["default"]}});var L=a("./textures/VideoBaseTexture");Object.defineProperty(d,"VideoBaseTexture",{enumerable:!0,get:function(){return k(L)["default"]}});var F=a("./textures/TextureUvs");Object.defineProperty(d,"TextureUvs",{enumerable:!0,get:function(){return k(F)["default"]}});var P=a("./renderers/canvas/utils/CanvasRenderTarget");Object.defineProperty(d,"CanvasRenderTarget",
{enumerable:!0,get:function(){return k(P)["default"]}});var O=a("./Shader");Object.defineProperty(d,"Shader",{enumerable:!0,get:function(){return k(O)["default"]}});var N=a("./renderers/webgl/managers/WebGLManager");Object.defineProperty(d,"WebGLManager",{enumerable:!0,get:function(){return k(N)["default"]}});var R=a("./renderers/webgl/utils/ObjectRenderer");Object.defineProperty(d,"ObjectRenderer",{enumerable:!0,get:function(){return k(R)["default"]}});var E=a("./renderers/webgl/utils/RenderTarget");
Object.defineProperty(d,"RenderTarget",{enumerable:!0,get:function(){return k(E)["default"]}});var D=a("./renderers/webgl/utils/Quad");Object.defineProperty(d,"Quad",{enumerable:!0,get:function(){return k(D)["default"]}});var Q=a("./renderers/webgl/filters/spriteMask/SpriteMaskFilter");Object.defineProperty(d,"SpriteMaskFilter",{enumerable:!0,get:function(){return k(Q)["default"]}});var J=a("./renderers/webgl/filters/Filter");Object.defineProperty(d,"Filter",{enumerable:!0,get:function(){return k(J)["default"]}});
d.autoDetectRenderer=function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:800,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:600,e=arguments[2];return!arguments[3]&&M.isWebGLSupported()?new U["default"](a,c,e):new T["default"](a,c,e)};b=a("./utils");var M=f(b);b=a("./ticker");b=f(b);var S=a("./renderers/canvas/CanvasRenderer"),T=k(S);a=a("./renderers/webgl/WebGLRenderer");var U=k(a);d.utils=M;d.ticker=b;d.CanvasRenderer=T["default"];d.WebGLRenderer=U["default"]},{"./Shader":42,
"./const":43,"./display/Container":45,"./display/DisplayObject":46,"./display/Transform":47,"./display/TransformBase":48,"./display/TransformStatic":49,"./graphics/Graphics":50,"./graphics/GraphicsData":51,"./graphics/canvas/CanvasGraphicsRenderer":52,"./graphics/webgl/GraphicsRenderer":54,"./math":67,"./renderers/canvas/CanvasRenderer":74,"./renderers/canvas/utils/CanvasRenderTarget":76,"./renderers/webgl/WebGLRenderer":81,"./renderers/webgl/filters/Filter":83,"./renderers/webgl/filters/spriteMask/SpriteMaskFilter":86,
"./renderers/webgl/managers/WebGLManager":90,"./renderers/webgl/utils/ObjectRenderer":91,"./renderers/webgl/utils/Quad":92,"./renderers/webgl/utils/RenderTarget":93,"./sprites/Sprite":98,"./sprites/canvas/CanvasSpriteRenderer":99,"./sprites/canvas/CanvasTinter":100,"./sprites/webgl/SpriteRenderer":102,"./text/Text":104,"./text/TextStyle":105,"./textures/BaseRenderTexture":106,"./textures/BaseTexture":107,"./textures/RenderTexture":108,"./textures/Texture":109,"./textures/TextureUvs":110,"./textures/VideoBaseTexture":111,
"./ticker":113,"./utils":116,"pixi-gl-core":12}],63:[function(a,b,d){function f(a){return 0>a?-1:0<a?1:0}d.__esModule=!0;var k=(a=a("./Matrix"))&&a.__esModule?a:{"default":a},n=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],h=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],e=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],g=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],c=[],p=[];(function(){for(var a=0;16>a;a++){var b=[];p.push(b);for(var d=0;16>d;d++)for(var m=f(n[a]*n[d]+e[a]*h[d]),y=f(h[a]*n[d]+g[a]*h[d]),r=f(n[a]*e[d]+e[a]*
g[d]),x=f(h[a]*e[d]+g[a]*g[d]),u=0;16>u;u++)if(n[u]===m&&h[u]===y&&e[u]===r&&g[u]===x){b.push(u);break}}for(a=0;16>a;a++)b=new k["default"],b.set(n[a],h[a],e[a],g[a],0,0),c.push(b)})();var y={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MIRROR_HORIZONTAL:12,uX:function(a){return n[a]},uY:function(a){return h[a]},vX:function(a){return e[a]},vY:function(a){return g[a]},inv:function(a){return a&8?a&15:-a&7},add:function(a,c){return p[a][c]},sub:function(a,c){return p[a][y.inv(c)]},rotate180:function(a){return a^
4},isSwapWidthHeight:function(a){return 2===(a&3)},byDirection:function(a,c){return 2*Math.abs(a)<=Math.abs(c)?0<=c?y.S:y.N:2*Math.abs(c)<=Math.abs(a)?0<a?y.E:y.W:0<c?0<a?y.SE:y.SW:0<a?y.NE:y.NW},matrixAppendRotationInv:function(a,e){var g=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,b=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,h=c[y.inv(e)];h.tx=g;h.ty=b;a.append(h)}};d["default"]=y},{"./Matrix":64}],64:[function(a,b,d){d.__esModule=!0;var f=function(){function a(b,e){for(var g=
0;g<e.length;g++){var c=e[g];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(b,c.key,c)}}return function(b,e,g){e&&a(b.prototype,e);g&&a(b,g);return b}}(),k=(a=a("./Point"))&&a.__esModule?a:{"default":a};a=function(){function a(){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.a=1;this.c=this.b=0;this.d=1;this.ty=this.tx=0;this.array=null}a.prototype.fromArray=function(a){this.a=a[0];this.b=a[1];this.c=a[3];this.d=
a[4];this.tx=a[2];this.ty=a[5]};a.prototype.set=function(a,e,g,c,b,d){this.a=a;this.b=e;this.c=g;this.d=c;this.tx=b;this.ty=d;return this};a.prototype.toArray=function(a,e){this.array||(this.array=new Float32Array(9));var g=e||this.array;a?(g[0]=this.a,g[1]=this.b,g[2]=0,g[3]=this.c,g[4]=this.d,g[5]=0,g[6]=this.tx,g[7]=this.ty):(g[0]=this.a,g[1]=this.c,g[2]=this.tx,g[3]=this.b,g[4]=this.d,g[5]=this.ty,g[6]=0,g[7]=0);g[8]=1;return g};a.prototype.apply=function(a,e){e=e||new k["default"];var g=a.x,
c=a.y;e.x=this.a*g+this.c*c+this.tx;e.y=this.b*g+this.d*c+this.ty;return e};a.prototype.applyInverse=function(a,e){e=e||new k["default"];var g=1/(this.a*this.d+this.c*-this.b),c=a.x,b=a.y;e.x=this.d*g*c+-this.c*g*b+(this.ty*this.c-this.tx*this.d)*g;e.y=this.a*g*b+-this.b*g*c+(-this.ty*this.a+this.tx*this.b)*g;return e};a.prototype.translate=function(a,e){this.tx+=a;this.ty+=e;return this};a.prototype.scale=function(a,e){this.a*=a;this.d*=e;this.c*=a;this.b*=e;this.tx*=a;this.ty*=e;return this};a.prototype.rotate=
function(a){var e=Math.cos(a);a=Math.sin(a);var g=this.a,c=this.c,b=this.tx;this.a=g*e-this.b*a;this.b=g*a+this.b*e;this.c=c*e-this.d*a;this.d=c*a+this.d*e;this.tx=b*e-this.ty*a;this.ty=b*a+this.ty*e;return this};a.prototype.append=function(a){var e=this.a,g=this.b,c=this.c,b=this.d;this.a=a.a*e+a.b*c;this.b=a.a*g+a.b*b;this.c=a.c*e+a.d*c;this.d=a.c*g+a.d*b;this.tx=a.tx*e+a.ty*c+this.tx;this.ty=a.tx*g+a.ty*b+this.ty;return this};a.prototype.setTransform=function(a,e,g,c,b,d,n,f,k){var m=Math.sin(n),
v=Math.cos(n);n=Math.cos(k);k=Math.sin(k);var r=-Math.sin(f);f=Math.cos(f);var x=v*b;b*=m;m=-m*d;d*=v;this.a=n*x+k*m;this.b=n*b+k*d;this.c=r*x+f*m;this.d=r*b+f*d;this.tx=a+(g*x+c*m);this.ty=e+(g*b+c*d);return this};a.prototype.prepend=function(a){var e=this.tx;if(1!==a.a||0!==a.b||0!==a.c||1!==a.d){var g=this.a,c=this.c;this.a=g*a.a+this.b*a.c;this.b=g*a.b+this.b*a.d;this.c=c*a.a+this.d*a.c;this.d=c*a.b+this.d*a.d}this.tx=e*a.a+this.ty*a.c+a.tx;this.ty=e*a.b+this.ty*a.d+a.ty;return this};a.prototype.decompose=
function(a){var e=this.a,g=this.b,c=this.c,b=this.d,d=Math.atan2(-c,b),n=Math.atan2(g,e);1E-5>Math.abs(1-d/n)?(a.rotation=n,0>e&&0<=b&&(a.rotation+=0>=a.rotation?Math.PI:-Math.PI),a.skew.x=a.skew.y=0):(a.skew.x=d,a.skew.y=n);a.scale.x=Math.sqrt(e*e+g*g);a.scale.y=Math.sqrt(c*c+b*b);a.position.x=this.tx;a.position.y=this.ty;return a};a.prototype.invert=function(){var a=this.a,e=this.b,g=this.c,c=this.d,b=this.tx,d=a*c-e*g;this.a=c/d;this.b=-e/d;this.c=-g/d;this.d=a/d;this.tx=(g*this.ty-c*b)/d;this.ty=
-(a*this.ty-e*b)/d;return this};a.prototype.identity=function(){this.a=1;this.c=this.b=0;this.d=1;this.ty=this.tx=0;return this};a.prototype.clone=function(){var b=new a;b.a=this.a;b.b=this.b;b.c=this.c;b.d=this.d;b.tx=this.tx;b.ty=this.ty;return b};a.prototype.copy=function(a){a.a=this.a;a.b=this.b;a.c=this.c;a.d=this.d;a.tx=this.tx;a.ty=this.ty;return a};f(a,null,[{key:"IDENTITY",get:function(){return new a}},{key:"TEMP_MATRIX",get:function(){return new a}}]);return a}();d["default"]=a},{"./Point":66}],
65:[function(a,b,d){d.__esModule=!0;var f=function(){function a(b,h){for(var e=0;e<h.length;e++){var g=h[e];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(b,g.key,g)}}return function(b,h,e){h&&a(b.prototype,h);e&&a(b,e);return b}}();a=function(){function a(b,h){var e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,g=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");
this._x=e;this._y=g;this.cb=b;this.scope=h}a.prototype.set=function(a,b){var e=a||0,g=b||(0!==b?e:0);if(this._x!==e||this._y!==g)this._x=e,this._y=g,this.cb.call(this.scope)};a.prototype.copy=function(a){if(this._x!==a.x||this._y!==a.y)this._x=a.x,this._y=a.y,this.cb.call(this.scope)};f(a,[{key:"x",get:function(){return this._x},set:function(a){this._x!==a&&(this._x=a,this.cb.call(this.scope))}},{key:"y",get:function(){return this._y},set:function(a){this._y!==a&&(this._y=a,this.cb.call(this.scope))}}]);
return a}();d["default"]=a},{}],66:[function(a,b,d){d.__esModule=!0;a=function(){function a(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.x=b;this.y=d}a.prototype.clone=function(){return new a(this.x,this.y)};a.prototype.copy=function(a){this.set(a.x,a.y)};a.prototype.equals=function(a){return a.x===this.x&&a.y===this.y};a.prototype.set=
function(a,b){this.x=a||0;this.y=b||(0!==b?this.x:0)};return a}();d["default"]=a},{}],67:[function(a,b,d){function f(a){return a&&a.__esModule?a:{"default":a}}d.__esModule=!0;var k=a("./Point");Object.defineProperty(d,"Point",{enumerable:!0,get:function(){return f(k)["default"]}});var n=a("./ObservablePoint");Object.defineProperty(d,"ObservablePoint",{enumerable:!0,get:function(){return f(n)["default"]}});var h=a("./Matrix");Object.defineProperty(d,"Matrix",{enumerable:!0,get:function(){return f(h)["default"]}});
var e=a("./GroupD8");Object.defineProperty(d,"GroupD8",{enumerable:!0,get:function(){return f(e)["default"]}});var g=a("./shapes/Circle");Object.defineProperty(d,"Circle",{enumerable:!0,get:function(){return f(g)["default"]}});var c=a("./shapes/Ellipse");Object.defineProperty(d,"Ellipse",{enumerable:!0,get:function(){return f(c)["default"]}});var p=a("./shapes/Polygon");Object.defineProperty(d,"Polygon",{enumerable:!0,get:function(){return f(p)["default"]}});var y=a("./shapes/Rectangle");Object.defineProperty(d,
"Rectangle",{enumerable:!0,get:function(){return f(y)["default"]}});var q=a("./shapes/RoundedRectangle");Object.defineProperty(d,"RoundedRectangle",{enumerable:!0,get:function(){return f(q)["default"]}})},{"./GroupD8":63,"./Matrix":64,"./ObservablePoint":65,"./Point":66,"./shapes/Circle":68,"./shapes/Ellipse":69,"./shapes/Polygon":70,"./shapes/Rectangle":71,"./shapes/RoundedRectangle":72}],68:[function(a,b,d){d.__esModule=!0;var f=(b=a("./Rectangle"))&&b.__esModule?b:{"default":b},k=a("../../const");
a=function(){function a(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,g=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.x=b;this.y=e;this.radius=g;this.type=k.SHAPES.CIRC}a.prototype.clone=function(){return new a(this.x,this.y,this.radius)};a.prototype.contains=function(a,e){if(0>=this.radius)return!1;var g=this.x-a,c=this.y-e;
return g*g+c*c<=this.radius*this.radius};a.prototype.getBounds=function(){return new f["default"](this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)};return a}();d["default"]=a},{"../../const":43,"./Rectangle":71}],69:[function(a,b,d){d.__esModule=!0;var f=(b=a("./Rectangle"))&&b.__esModule?b:{"default":b},k=a("../../const");a=function(){function a(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,g=2<arguments.length&&
void 0!==arguments[2]?arguments[2]:0,c=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.x=b;this.y=e;this.width=g;this.height=c;this.type=k.SHAPES.ELIP}a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height)};a.prototype.contains=function(a,e){if(0>=this.width||0>=this.height)return!1;var g=(a-this.x)/this.width,c=(e-this.y)/this.height;return 1>=g*g+c*c};a.prototype.getBounds=function(){return new f["default"](this.x-
this.width,this.y-this.height,this.width,this.height)};return a}();d["default"]=a},{"../../const":43,"./Rectangle":71}],70:[function(a,b,d){d.__esModule=!0;var f=(b=a("../Point"))&&b.__esModule?b:{"default":b},k=a("../../const");a=function(){function a(){for(var b=arguments.length,e=Array(b),g=0;g<b;g++)e[g]=arguments[g];if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");Array.isArray(e[0])&&(e=e[0]);if(e[0]instanceof f["default"]){for(var b=[],g=0,c=e.length;g<c;g++)b.push(e[g].x,
e[g].y);e=b}this.closed=!0;this.points=e;this.type=k.SHAPES.POLY}a.prototype.clone=function(){return new a(this.points.slice())};a.prototype.close=function(){var a=this.points;a[0]===a[a.length-2]&&a[1]===a[a.length-1]||a.push(a[0],a[1])};a.prototype.contains=function(a,e){for(var g=!1,c=this.points.length/2,b=0,d=c-1;b<c;d=++b){var n=this.points[2*b],f=this.points[2*b+1],k=this.points[2*d],d=this.points[2*d+1];f>e!==d>e&&a<(e-f)/(d-f)*(k-n)+n&&(g=!g)}return g};return a}();d["default"]=a},{"../../const":43,
"../Point":66}],71:[function(a,b,d){d.__esModule=!0;var f=function(){function a(b,e){for(var g=0;g<e.length;g++){var c=e[g];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(b,c.key,c)}}return function(b,e,g){e&&a(b.prototype,e);g&&a(b,g);return b}}(),k=a("../../const");a=function(){function a(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,g=2<arguments.length&&void 0!==arguments[2]?
arguments[2]:0,c=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.x=b;this.y=e;this.width=g;this.height=c;this.type=k.SHAPES.RECT}a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height)};a.prototype.copy=function(a){this.x=a.x;this.y=a.y;this.width=a.width;this.height=a.height;return this};a.prototype.contains=function(a,e){return 0>=this.width||0>=this.height?!1:a>=this.x&&a<this.x+
this.width&&e>=this.y&&e<this.y+this.height?!0:!1};a.prototype.pad=function(a,e){a=a||0;e=e||(0!==e?a:0);this.x-=a;this.y-=e;this.width+=2*a;this.height+=2*e};a.prototype.fit=function(a){this.x<a.x&&(this.width+=this.x,0>this.width&&(this.width=0),this.x=a.x);this.y<a.y&&(this.height+=this.y,0>this.height&&(this.height=0),this.y=a.y);this.x+this.width>a.x+a.width&&(this.width=a.width-this.x,0>this.width&&(this.width=0));this.y+this.height>a.y+a.height&&(this.height=a.height-this.y,0>this.height&&
(this.height=0))};a.prototype.enlarge=function(b){if(b!==a.EMPTY){var e=Math.min(this.x,b.x),g=Math.max(this.x+this.width,b.x+b.width),c=Math.min(this.y,b.y);b=Math.max(this.y+this.height,b.y+b.height);this.x=e;this.width=g-e;this.y=c;this.height=b-c}};f(a,[{key:"left",get:function(){return this.x}},{key:"right",get:function(){return this.x+this.width}},{key:"top",get:function(){return this.y}},{key:"bottom",get:function(){return this.y+this.height}}],[{key:"EMPTY",get:function(){return new a(0,0,
0,0)}}]);return a}();d["default"]=a},{"../../const":43}],72:[function(a,b,d){d.__esModule=!0;var f=a("../../const");a=function(){function a(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,h=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,g=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,c=4<arguments.length&&void 0!==arguments[4]?arguments[4]:20;if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");
this.x=b;this.y=h;this.width=e;this.height=g;this.radius=c;this.type=f.SHAPES.RREC}a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.radius)};a.prototype.contains=function(a,b){return 0>=this.width||0>=this.height?!1:a>=this.x&&a<=this.x+this.width&&b>=this.y&&b<=this.y+this.height?!0:!1};return a}();d["default"]=a},{"../../const":43}],73:[function(a,b,d){function f(a){return a&&a.__esModule?a:{"default":a}}function k(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+
typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}d.__esModule=!0;var n=function(){function a(c,e){for(var g=0;g<e.length;g++){var b=e[g];b.enumerable=b.enumerable||!1;b.configurable=!0;"value"in b&&(b.writable=!0);Object.defineProperty(c,b.key,b)}}return function(c,e,g){e&&a(c.prototype,e);g&&a(c,g);return c}}(),h=a("../utils");b=a("../math");var e=a("../const"),
g=a("../display/Container"),c=f(g),g=a("../textures/RenderTexture"),p=f(g);a=a("eventemitter3");a=f(a);var y=new b.Matrix;b=function(a){function g(b,d,p,n){if(!(this instanceof g))throw new TypeError("Cannot call a class as a function");var f;f=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");f=!f||"object"!==typeof f&&"function"!==typeof f?this:f;(0,h.sayHello)(b);if(n)for(var k in e.DEFAULT_RENDER_OPTIONS)"undefined"===typeof n[k]&&(n[k]=
e.DEFAULT_RENDER_OPTIONS[k]);else n=e.DEFAULT_RENDER_OPTIONS;f.type=e.RENDERER_TYPE.UNKNOWN;f.width=d||800;f.height=p||600;f.view=n.view||document.createElement("canvas");f.resolution=n.resolution||e.RESOLUTION;f.transparent=n.transparent;f.autoResize=n.autoResize||!1;f.blendModes=null;f.preserveDrawingBuffer=n.preserveDrawingBuffer;f.clearBeforeRender=n.clearBeforeRender;f.roundPixels=n.roundPixels;f._backgroundColor=0;f._backgroundColorRgba=[0,0,0,0];f._backgroundColorString="#000000";f.backgroundColor=
n.backgroundColor||f._backgroundColor;f._tempDisplayObjectParent=new c["default"];f._lastObjectRendered=f._tempDisplayObjectParent;return f}k(g,a);g.prototype.resize=function(a,c){this.width=a*this.resolution;this.height=c*this.resolution;this.view.width=this.width;this.view.height=this.height;this.autoResize&&(this.view.style.width=this.width/this.resolution+"px",this.view.style.height=this.height/this.resolution+"px")};g.prototype.generateTexture=function(a,c,e){var g=a.getLocalBounds();c=p["default"].create(g.width|
0,g.height|0,c,e);y.tx=-g.x;y.ty=-g.y;this.render(a,c,!1,y,!0);return c};g.prototype.destroy=function(a){a&&this.view.parentNode&&this.view.parentNode.removeChild(this.view);this.type=e.RENDERER_TYPE.UNKNOWN;this.height=this.width=0;this.view=null;this.resolution=0;this.autoResize=this.transparent=!1;this.blendModes=null;this.roundPixels=this.clearBeforeRender=this.preserveDrawingBuffer=!1;this._backgroundColor=0;this._backgroundColorString=this._backgroundColorRgba=null;this.backgroundColor=0;this._lastObjectRendered=
this._tempDisplayObjectParent=null};n(g,[{key:"backgroundColor",get:function(){return this._backgroundColor},set:function(a){this._backgroundColor=a;this._backgroundColorString=(0,h.hex2string)(a);(0,h.hex2rgb)(a,this._backgroundColorRgba)}}]);return g}(a["default"]);d["default"]=b},{"../const":43,"../display/Container":45,"../math":67,"../textures/RenderTexture":108,"../utils":116,eventemitter3:3}],74:[function(a,b,d){function f(a){return a&&a.__esModule?a:{"default":a}}function k(a,c){if("function"!==
typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}d.__esModule=!0;b=a("../SystemRenderer");b=f(b);var n=a("./utils/CanvasMaskManager"),h=f(n),n=a("./utils/CanvasRenderTarget"),e=f(n),n=a("./utils/mapCanvasBlendModesToPixi"),g=f(n),n=a("../../utils"),c=a("../../const");
a=function(a){function b(e,d){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");n=a.call(this,"Canvas",e,d,n);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");n=!n||"object"!==typeof n&&"function"!==typeof n?this:n;n.type=c.RENDERER_TYPE.CANVAS;n.rootContext=n.view.getContext("2d",{alpha:n.transparent});n.refresh=!0;n.maskManager=new h["default"](n);n.smoothProperty=
"imageSmoothingEnabled";n.rootContext.imageSmoothingEnabled||(n.rootContext.webkitImageSmoothingEnabled?n.smoothProperty="webkitImageSmoothingEnabled":n.rootContext.mozImageSmoothingEnabled?n.smoothProperty="mozImageSmoothingEnabled":n.rootContext.oImageSmoothingEnabled?n.smoothProperty="oImageSmoothingEnabled":n.rootContext.msImageSmoothingEnabled&&(n.smoothProperty="msImageSmoothingEnabled"));n.initPlugins();n.blendModes=(0,g["default"])();n._activeBlendMode=null;n.context=null;n.renderingToScreen=
!1;n.resize(e,d);return n}k(b,a);b.prototype.render=function(a,g,b,h,d){if(this.view){this.renderingToScreen=!g;this.emit("prerender");g?(g=g.baseTexture||g,g._canvasRenderTarget||(g._canvasRenderTarget=new e["default"](g.width,g.height,g.resolution),g.source=g._canvasRenderTarget.canvas,g.valid=!0),this.context=g._canvasRenderTarget.context,this.resolution=g._canvasRenderTarget.resolution):this.context=this.rootContext;var n=this.context;g||(this._lastObjectRendered=a);d||(g=a.parent,d=this._tempDisplayObjectParent.transform.worldTransform,
h?h.copy(d):d.identity(),a.parent=this._tempDisplayObjectParent,a.updateTransform(),a.parent=g);n.setTransform(1,0,0,1,0,0);n.globalAlpha=1;n.globalCompositeOperation=this.blendModes[c.BLEND_MODES.NORMAL];navigator.isCocoonJS&&this.view.screencanvas&&(n.fillStyle="black",n.clear());(void 0!==b?b:this.clearBeforeRender)&&this.renderingToScreen&&(this.transparent?n.clearRect(0,0,this.width,this.height):(n.fillStyle=this._backgroundColorString,n.fillRect(0,0,this.width,this.height)));b=this.context;
this.context=n;a.renderCanvas(this);this.context=b;this.emit("postrender")}};b.prototype.setBlendMode=function(a){this._activeBlendMode!==a&&(this.context.globalCompositeOperation=this.blendModes[a])};b.prototype.destroy=function(c){this.destroyPlugins();a.prototype.destroy.call(this,c);this.context=null;this.refresh=!0;this.maskManager.destroy();this.smoothProperty=this.maskManager=null};b.prototype.resize=function(e,g){a.prototype.resize.call(this,e,g);this.smoothProperty&&(this.rootContext[this.smoothProperty]=
c.SCALE_MODES.DEFAULT===c.SCALE_MODES.LINEAR)};return b}(b["default"]);d["default"]=a;n.pluginTarget.mixin(a)},{"../../const":43,"../../utils":116,"../SystemRenderer":73,"./utils/CanvasMaskManager":75,"./utils/CanvasRenderTarget":76,"./utils/mapCanvasBlendModesToPixi":78}],75:[function(a,b,d){d.__esModule=!0;var f=a("../../../const");a=function(){function a(b){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.renderer=b}a.prototype.pushMask=function(a){var b=this.renderer;
b.context.save();var e=a.alpha,g=a.transform.worldTransform,c=b.resolution;b.context.setTransform(g.a*c,g.b*c,g.c*c,g.d*c,g.tx*c,g.ty*c);a._texture||(this.renderGraphicsShape(a),b.context.clip());a.worldAlpha=e};a.prototype.renderGraphicsShape=function(a){var b=this.renderer.context,e=a.graphicsData.length;if(0!==e){b.beginPath();for(var g=0;g<e;g++){var c=a.graphicsData[g],d=c.shape;if(c.type===f.SHAPES.POLY){c=d.points;b.moveTo(c[0],c[1]);for(var k=1;k<c.length/2;k++)b.lineTo(c[2*k],c[2*k+1]);c[0]===
c[c.length-2]&&c[1]===c[c.length-1]&&b.closePath()}else if(c.type===f.SHAPES.RECT)b.rect(d.x,d.y,d.width,d.height),b.closePath();else if(c.type===f.SHAPES.CIRC)b.arc(d.x,d.y,d.radius,0,2*Math.PI),b.closePath();else if(c.type===f.SHAPES.ELIP){var m=2*d.width,k=2*d.height,c=d.x-m/2,d=d.y-k/2,A=m/2*.5522848,z=k/2*.5522848,t=c+m,v=d+k,m=c+m/2,k=d+k/2;b.moveTo(c,k);b.bezierCurveTo(c,k-z,m-A,d,m,d);b.bezierCurveTo(m+A,d,t,k-z,t,k);b.bezierCurveTo(t,k+z,m+A,v,m,v);b.bezierCurveTo(m-A,v,c,k+z,c,k);b.closePath()}else c.type===
f.SHAPES.RREC&&(c=d.x,k=d.y,A=d.width,z=d.height,d=d.radius,t=Math.min(A,z)/2|0,d=d>t?t:d,b.moveTo(c,k+d),b.lineTo(c,k+z-d),b.quadraticCurveTo(c,k+z,c+d,k+z),b.lineTo(c+A-d,k+z),b.quadraticCurveTo(c+A,k+z,c+A,k+z-d),b.lineTo(c+A,k+d),b.quadraticCurveTo(c+A,k,c+A-d,k),b.lineTo(c+d,k),b.quadraticCurveTo(c,k,c,k+d),b.closePath())}}};a.prototype.popMask=function(a){a.context.restore()};a.prototype.destroy=function(){};return a}();d["default"]=a},{"../../../const":43}],76:[function(a,b,d){d.__esModule=
!0;var f=function(){function a(b,e){for(var g=0;g<e.length;g++){var c=e[g];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(b,c.key,c)}}return function(b,e,g){e&&a(b.prototype,e);g&&a(b,g);return b}}(),k=a("../../../const");a=function(){function a(b,e,g){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");this.resolution=g||k.RESOLUTION;
this.resize(b,e)}a.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0);this.context.clearRect(0,0,this.canvas.width,this.canvas.height)};a.prototype.resize=function(a,e){this.canvas.width=a*this.resolution;this.canvas.height=e*this.resolution};a.prototype.destroy=function(){this.canvas=this.context=null};f(a,[{key:"width",get:function(){return this.canvas.width},set:function(a){this.canvas.width=a}},{key:"height",get:function(){return this.canvas.height},set:function(a){this.canvas.height=
a}}]);return a}();d["default"]=a},{"../../../const":43}],77:[function(a,b,d){function f(a){var b=document.createElement("canvas");b.width=6;b.height=1;var h=b.getContext("2d");h.fillStyle=a;h.fillRect(0,0,6,1);return b}d.__esModule=!0;d["default"]=function(){if("undefined"===typeof document)return!1;var a=f("#ff00ff"),b=f("#ffff00"),h=document.createElement("canvas");h.width=6;h.height=1;h=h.getContext("2d");h.globalCompositeOperation="multiply";h.drawImage(a,0,0);h.drawImage(b,2,0);a=h.getImageData(2,
0,1,1);if(!a)return!1;a=a.data;return 255===a[0]&&0===a[1]&&0===a[2]}},{}],78:[function(a,b,d){d.__esModule=!0;d["default"]=function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];(0,k["default"])()?(a[f.BLEND_MODES.NORMAL]="source-over",a[f.BLEND_MODES.ADD]="lighter",a[f.BLEND_MODES.MULTIPLY]="multiply",a[f.BLEND_MODES.SCREEN]="screen",a[f.BLEND_MODES.OVERLAY]="overlay",a[f.BLEND_MODES.DARKEN]="darken",a[f.BLEND_MODES.LIGHTEN]="lighten",a[f.BLEND_MODES.COLOR_DODGE]="color-dodge",
a[f.BLEND_MODES.COLOR_BURN]="color-burn",a[f.BLEND_MODES.HARD_LIGHT]="hard-light",a[f.BLEND_MODES.SOFT_LIGHT]="soft-light",a[f.BLEND_MODES.DIFFERENCE]="difference",a[f.BLEND_MODES.EXCLUSION]="exclusion",a[f.BLEND_MODES.HUE]="hue",a[f.BLEND_MODES.SATURATION]="saturate",a[f.BLEND_MODES.COLOR]="color",a[f.BLEND_MODES.LUMINOSITY]="luminosity"):(a[f.BLEND_MODES.NORMAL]="source-over",a[f.BLEND_MODES.ADD]="lighter",a[f.BLEND_MODES.MULTIPLY]="source-over",a[f.BLEND_MODES.SCREEN]="source-over",a[f.BLEND_MODES.OVERLAY]=
"source-over",a[f.BLEND_MODES.DARKEN]="source-over",a[f.BLEND_MODES.LIGHTEN]="source-over",a[f.BLEND_MODES.COLOR_DODGE]="source-over",a[f.BLEND_MODES.COLOR_BURN]="source-over",a[f.BLEND_MODES.HARD_LIGHT]="source-over",a[f.BLEND_MODES.SOFT_LIGHT]="source-over",a[f.BLEND_MODES.DIFFERENCE]="source-over",a[f.BLEND_MODES.EXCLUSION]="source-over",a[f.BLEND_MODES.HUE]="source-over",a[f.BLEND_MODES.SATURATION]="source-over",a[f.BLEND_MODES.COLOR]="source-over",a[f.BLEND_MODES.LUMINOSITY]="source-over");return a};
var f=a("../../../const"),k=(a=a("./canUseNewCanvasBlendModes"))&&a.__esModule?a:{"default":a}},{"../../../const":43,"./canUseNewCanvasBlendModes":77}],79:[function(a,b,d){d.__esModule=!0;var f=a("../../const");a=function(){function a(b){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.renderer=b;this.checkCount=this.count=0;this.maxIdle=3600;this.checkCountMax=600;this.mode=f.GC_MODES.DEFAULT}a.prototype.update=function(){this.count++;this.mode!==f.GC_MODES.MANUAL&&
(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run()))};a.prototype.run=function(){for(var a=this.renderer.textureManager,b=a._managedTextures,e=!1,g=0;g<b.length;g++){var c=b[g];!c._glRenderTargets&&this.count-c.touched>this.maxIdle&&(a.destroyTexture(c,!0),b[g]=null,e=!0)}if(e){for(e=a=0;e<b.length;e++)null!==b[e]&&(b[a++]=b[e]);b.length=a}};a.prototype.unload=function(a){var b=this.renderer.textureManager;a._texture&&b.destroyTexture(a._texture,!0);for(b=a.children.length-
1;0<=b;b--)this.unload(a.children[b])};return a}();d["default"]=a},{"../../const":43}],80:[function(a,b,d){d.__esModule=!0;var f=a("pixi-gl-core"),k=a("../../const"),n=(b=a("./utils/RenderTarget"))&&b.__esModule?b:{"default":b},h=a("../../utils");a=function(){function a(b){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.renderer=b;this.gl=b.gl;this._managedTextures=[]}a.prototype.bindTexture=function(){};a.prototype.getTexture=function(){};a.prototype.updateTexture=
function(a){a=a.baseTexture||a;var c=!!a._glRenderTargets;if(!a.hasLoaded)return null;var e=a._glTextures[this.renderer.CONTEXT_UID];e?c?a._glRenderTargets[this.renderer.CONTEXT_UID].resize(a.width,a.height):e.upload(a.source):(c?(c=new n["default"](this.gl,a.width,a.height,a.scaleMode,a.resolution),c.resize(a.width,a.height),a._glRenderTargets[this.renderer.CONTEXT_UID]=c,e=c.texture):(e=new f.GLTexture(this.gl),e.premultiplyAlpha=!0,e.upload(a.source)),a._glTextures[this.renderer.CONTEXT_UID]=e,
a.on("update",this.updateTexture,this),a.on("dispose",this.destroyTexture,this),this._managedTextures.push(a),a.isPowerOfTwo?(a.mipmap&&e.enableMipmap(),a.wrapMode===k.WRAP_MODES.CLAMP?e.enableWrapClamp():a.wrapMode===k.WRAP_MODES.REPEAT?e.enableWrapRepeat():e.enableWrapMirrorRepeat()):e.enableWrapClamp(),a.scaleMode===k.SCALE_MODES.NEAREST?e.enableNearestScaling():e.enableLinearScaling());return e};a.prototype.destroyTexture=function(a,c){a=a.baseTexture||a;if(a.hasLoaded&&a._glTextures[this.renderer.CONTEXT_UID]&&
(a._glTextures[this.renderer.CONTEXT_UID].destroy(),a.off("update",this.updateTexture,this),a.off("dispose",this.destroyTexture,this),delete a._glTextures[this.renderer.CONTEXT_UID],!c)){var e=this._managedTextures.indexOf(a);-1!==e&&(0,h.removeItems)(this._managedTextures,e,1)}};a.prototype.removeAll=function(){for(var a=0;a<this._managedTextures.length;++a){var c=this._managedTextures[a];c._glTextures[this.renderer.CONTEXT_UID]&&delete c._glTextures[this.renderer.CONTEXT_UID]}};a.prototype.destroy=
function(){for(var a=0;a<this._managedTextures.length;++a){var c=this._managedTextures[a];this.destroyTexture(c,!0);c.off("update",this.updateTexture,this);c.off("dispose",this.destroyTexture,this)}this._managedTextures=null};return a}();d["default"]=a},{"../../const":43,"../../utils":116,"./utils/RenderTarget":93,"pixi-gl-core":12}],81:[function(a,b,d){function f(a){return a&&a.__esModule?a:{"default":a}}function k(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+
typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}d.__esModule=!0;b=a("../SystemRenderer");var n=f(b);b=a("./managers/MaskManager");var h=f(b);b=a("./managers/StencilManager");var e=f(b);b=a("./managers/FilterManager");var g=f(b);b=a("./utils/RenderTarget");var c=f(b);b=a("./utils/ObjectRenderer");var p=f(b);b=a("./TextureManager");var y=f(b);b=a("./TextureGarbageCollector");
var q=f(b);b=a("./WebGLState");var A=f(b);b=a("./utils/mapWebGLDrawModesToPixi");var z=f(b);b=a("./utils/validateContext");var t=f(b);b=a("../../utils");var v=a("pixi-gl-core"),r=f(v),x=a("../../const"),u=0;a=function(a){function b(c,d){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var f;f=a.call(this,"WebGL",c,d,n);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
f=!f||"object"!==typeof f&&"function"!==typeof f?this:f;f.type=x.RENDERER_TYPE.WEBGL;f.handleContextLost=f.handleContextLost.bind(f);f.handleContextRestored=f.handleContextRestored.bind(f);f.view.addEventListener("webglcontextlost",f.handleContextLost,!1);f.view.addEventListener("webglcontextrestored",f.handleContextRestored,!1);f._contextOptions={alpha:f.transparent,antialias:n.antialias,premultipliedAlpha:f.transparent&&"notMultiplied"!==f.transparent,stencil:!0,preserveDrawingBuffer:n.preserveDrawingBuffer};
f._backgroundColorRgba[3]=f.transparent?0:1;f.maskManager=new h["default"](f);f.stencilManager=new e["default"](f);f.emptyRenderer=new p["default"](f);f.currentRenderer=f.emptyRenderer;f.initPlugins();n.context&&(0,t["default"])(n.context);f.gl=n.context||r["default"].createContext(f.view,f._contextOptions);f.CONTEXT_UID=u++;f.state=new A["default"](f.gl);f.renderingToScreen=!0;f._initContext();f.filterManager=new g["default"](f);f.drawModes=(0,z["default"])(f.gl);f._activeShader=null;f._activeRenderTarget=
null;f._activeTextureLocation=999;f._activeTexture=null;f.setBlendMode(0);return f}k(b,a);b.prototype._initContext=function(){var a=this.gl;a.isContextLost()&&a.getExtension("WEBGL_lose_context")&&a.getExtension("WEBGL_lose_context").restoreContext();this.textureManager=new y["default"](this);this.textureGC=new q["default"](this);this.state.resetToDefault();this.rootRenderTarget=new c["default"](a,this.width,this.height,null,this.resolution,!0);this.rootRenderTarget.clearColor=this._backgroundColorRgba;
this.bindRenderTarget(this.rootRenderTarget);this.emit("context",a);this.resize(this.width,this.height)};b.prototype.render=function(a,c,e,b,g){this.renderingToScreen=!c;this.emit("prerender");this.gl&&!this.gl.isContextLost()&&(c||(this._lastObjectRendered=a),g||(g=a.parent,a.parent=this._tempDisplayObjectParent,a.updateTransform(),a.parent=g),this.bindRenderTexture(c,b),this.currentRenderer.start(),(void 0!==e?e:this.clearBeforeRender)&&this._activeRenderTarget.clear(),a.renderWebGL(this),this.currentRenderer.flush(),
this.textureGC.update(),this.emit("postrender"))};b.prototype.setObjectRenderer=function(a){this.currentRenderer!==a&&(this.currentRenderer.stop(),this.currentRenderer=a,this.currentRenderer.start())};b.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)};b.prototype.resize=function(a,c){n["default"].prototype.resize.call(this,a,c);this.rootRenderTarget.resize(a,c);this._activeRenderTarget===this.rootRenderTarget&&(this.rootRenderTarget.activate(),this._activeShader&&(this._activeShader.uniforms.projectionMatrix=
this.rootRenderTarget.projectionMatrix.toArray(!0)))};b.prototype.setBlendMode=function(a){this.state.setBlendMode(a)};b.prototype.clear=function(a){this._activeRenderTarget.clear(a)};b.prototype.setTransform=function(a){this._activeRenderTarget.transform=a};b.prototype.bindRenderTexture=function(a,c){var e;if(a){e=a.baseTexture;var b=this.gl;e._glRenderTargets[this.CONTEXT_UID]?(this._activeTextureLocation=e._id,b.activeTexture(b.TEXTURE0+e._id)):this.textureManager.updateTexture(e);b.bindTexture(b.TEXTURE_2D,
null);e=e._glRenderTargets[this.CONTEXT_UID];e.setFrame(a.frame)}else e=this.rootRenderTarget;e.transform=c;this.bindRenderTarget(e);return this};b.prototype.bindRenderTarget=function(a){a!==this._activeRenderTarget&&(this._activeRenderTarget=a,a.activate(),this._activeShader&&(this._activeShader.uniforms.projectionMatrix=a.projectionMatrix.toArray(!0)),this.stencilManager.setMaskStack(a.stencilMaskStack));return this};b.prototype.bindShader=function(a){this._activeShader!==a&&(this._activeShader=
a,a.bind(),a.uniforms.projectionMatrix=this._activeRenderTarget.projectionMatrix.toArray(!0));return this};b.prototype.bindTexture=function(a){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;a=a.baseTexture||a;var e=this.gl;this._activeTextureLocation!==c&&(this._activeTextureLocation=c,e.activeTexture(e.TEXTURE0+c));this._activeTexture=a;a._glTextures[this.CONTEXT_UID]?(a.touched=this.textureGC.count,a._glTextures[this.CONTEXT_UID].bind()):this.textureManager.updateTexture(a);return this};
b.prototype.createVao=function(){return new r["default"].VertexArrayObject(this.gl,this.state.attribState)};b.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer);this._activeShader=null;this._activeRenderTarget=this.rootRenderTarget;this._activeTextureLocation=999;this._activeTexture=null;this.rootRenderTarget.activate();this.state.resetToDefault();return this};b.prototype.handleContextLost=function(a){a.preventDefault()};b.prototype.handleContextRestored=function(){this._initContext();
this.textureManager.removeAll()};b.prototype.destroy=function(c){this.destroyPlugins();this.view.removeEventListener("webglcontextlost",this.handleContextLost);this.view.removeEventListener("webglcontextrestored",this.handleContextRestored);this.textureManager.destroy();a.prototype.destroy.call(this,c);this.uid=0;this.maskManager.destroy();this.stencilManager.destroy();this.filterManager.destroy();this._contextOptions=this.handleContextRestored=this.handleContextLost=this.currentRenderer=this.textureManager=
this.filterManager=this.maskManager=null;this.gl.useProgram(null);this.gl.getExtension("WEBGL_lose_context")&&this.gl.getExtension("WEBGL_lose_context").loseContext();this.gl=null};return b}(n["default"]);d["default"]=a;b.pluginTarget.mixin(a)},{"../../const":43,"../../utils":116,"../SystemRenderer":73,"./TextureGarbageCollector":79,"./TextureManager":80,"./WebGLState":82,"./managers/FilterManager":87,"./managers/MaskManager":88,"./managers/StencilManager":89,"./utils/ObjectRenderer":91,"./utils/RenderTarget":93,
"./utils/mapWebGLDrawModesToPixi":96,"./utils/validateContext":97,"pixi-gl-core":12}],82:[function(a,b,d){d.__esModule=!0;var f=(a=a("./utils/mapWebGLBlendModesToPixi"))&&a.__esModule?a:{"default":a};a=function(){function a(b){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.activeState=new Uint8Array(16);this.defaultState=new Uint8Array(16);this.defaultState[0]=1;this.stackIndex=0;this.stack=[];this.gl=b;this.maxAttribs=b.getParameter(b.MAX_VERTEX_ATTRIBS);this.attribState=
{tempAttribState:Array(this.maxAttribs),attribState:Array(this.maxAttribs)};this.blendModes=(0,f["default"])(b);this.nativeVaoExtension=b.getExtension("OES_vertex_array_object")||b.getExtension("MOZ_OES_vertex_array_object")||b.getExtension("WEBKIT_OES_vertex_array_object")}a.prototype.push=function(){var a=this.stack[++this.stackIndex];a||(a=this.stack[this.stackIndex]=new Uint8Array(16));for(var b=0;b<this.activeState.length;b++)this.activeState[b]=a[b]};a.prototype.pop=function(){var a=this.stack[--this.stackIndex];
this.setState(a)};a.prototype.setState=function(a){this.setBlend(a[0]);this.setDepthTest(a[1]);this.setFrontFace(a[2]);this.setCullFace(a[3]);this.setBlendMode(a[4])};a.prototype.setBlend=function(a){a=a?1:0;this.activeState[0]!==a&&(this.activeState[0]=a,this.gl[a?"enable":"disable"](this.gl.BLEND))};a.prototype.setBlendMode=function(a){a!==this.activeState[4]&&(this.activeState[4]=a,this.gl.blendFunc(this.blendModes[a][0],this.blendModes[a][1]))};a.prototype.setDepthTest=function(a){a=a?1:0;this.activeState[1]!==
a&&(this.activeState[1]=a,this.gl[a?"enable":"disable"](this.gl.DEPTH_TEST))};a.prototype.setCullFace=function(a){a=a?1:0;this.activeState[3]!==a&&(this.activeState[3]=a,this.gl[a?"enable":"disable"](this.gl.CULL_FACE))};a.prototype.setFrontFace=function(a){a=a?1:0;this.activeState[2]!==a&&(this.activeState[2]=a,this.gl.frontFace(this.gl[a?"CW":"CCW"]))};a.prototype.resetAttributes=function(){for(var a=0;a<this.attribState.tempAttribState.length;a++)this.attribState.tempAttribState[a]=0;for(a=0;a<
this.attribState.attribState.length;a++)this.attribState.attribState[a]=0;for(a=1;a<this.maxAttribs;a++)this.gl.disableVertexAttribArray(a)};a.prototype.resetToDefault=function(){this.nativeVaoExtension&&this.nativeVaoExtension.bindVertexArrayOES(null);this.resetAttributes();for(var a=0;a<this.activeState.length;++a)this.activeState[a]=32;this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1);this.setState(this.defaultState)};return a}();d["default"]=a},{"./utils/mapWebGLBlendModesToPixi":95}],83:[function(a,
b,d){d.__esModule=!0;var f=function(){function a(c,e){for(var b=0;b<e.length;b++){var g=e[b];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(c,g.key,g)}}return function(c,e,b){e&&a(c.prototype,e);b&&a(c,b);return c}}(),k=(b=a("./extractUniformsFromSrc"))&&b.__esModule?b:{"default":b},n=a("../../../utils"),h=a("../../../const"),e={};a=function(){function a(c,b,d){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.vertexSrc=
c||a.defaultVertexSrc;this.fragmentSrc=b||a.defaultFragmentSrc;this.blendMode=h.BLEND_MODES.NORMAL;this.uniformData=d||(0,k["default"])(this.vertexSrc,this.fragmentSrc,"projectionMatrix|uSampler");this.uniforms={};for(var f in this.uniformData)this.uniforms[f]=this.uniformData[f].value;this.glShaders={};e[this.vertexSrc+this.fragmentSrc]||(e[this.vertexSrc+this.fragmentSrc]=(0,n.uid)());this.glShaderKey=e[this.vertexSrc+this.fragmentSrc];this.padding=4;this.resolution=1;this.enabled=!0}a.prototype.apply=
function(a,e,b,g){a.applyFilter(this,e,b,g)};f(a,null,[{key:"defaultVertexSrc",get:function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vFilterCoord = ( filterMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n   vTextureCoord = aTextureCoord ;\n}"}},{key:"defaultFragmentSrc",
get:function(){return"varying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\nuniform sampler2D uSampler;\nuniform sampler2D filterSampler;\nvoid main(void){\n   vec4 masky = texture2D(filterSampler, vFilterCoord);\n   vec4 sample = texture2D(uSampler, vTextureCoord);\n   vec4 color;\n   if(mod(vFilterCoord.x, 1.0) > 0.5)\n   {\n     color = vec4(1.0, 0.0, 0.0, 1.0);\n   }\n   else\n   {\n     color = vec4(0.0, 1.0, 0.0, 1.0);\n   }\n   gl_FragColor = mix(sample, masky, 0.5);\n   gl_FragColor *= sample.a;\n}"}}]);
return a}();d["default"]=a},{"../../../const":43,"../../../utils":116,"./extractUniformsFromSrc":84}],84:[function(a,b,d){function f(a){var b=/^(projectionMatrix|uSampler|filterArea)$/,e={},g;a=a.replace(/\s+/g," ").split(/\s*;\s*/);for(var c=0;c<a.length;c++){var d=a[c].trim();if(-1<d.indexOf("uniform")){g=d.split(" ");var d=g[1],f=g[2],m=1;-1<f.indexOf("[")&&(g=f.split(/\[|]/),f=g[0],m*=Number(g[1]));f.match(b)||(e[f]={value:k(d,m),name:f,type:d})}}return e}d.__esModule=!0;d["default"]=function(a,
b,e){a=f(a,e);b=f(b,e);return Object.assign(a,b)};a=a("pixi-gl-core");var k=(a&&a.__esModule?a:{"default":a})["default"].shader.defaultValue},{"pixi-gl-core":12}],85:[function(a,b,d){d.__esModule=!0;d.calculateScreenSpaceMatrix=function(a,b,h){a=a.identity();a.translate(b.x/h.width,b.y/h.height);a.scale(h.width,h.height);return a};d.calculateNormalizedScreenSpaceMatrix=function(a,b,h){a=a.identity();a.translate(b.x/h.width,b.y/h.height);a.scale(h.width/b.width,h.height/b.height);return a};d.calculateSpriteMatrix=
function(a,b,h,e){var g=e.worldTransform.copy(f.Matrix.TEMP_MATRIX),c=e._texture.baseTexture;a=a.identity();var d=h.height/h.width;a.translate(b.x/h.width,b.y/h.height);a.scale(1,d);b=h.width/c.width;h=h.height/c.height;g.tx/=c.width*b;g.ty/=c.width*b;g.invert();a.prepend(g);a.scale(1,1/d);a.scale(b,h);a.translate(e.anchor.x,e.anchor.y);return a};var f=a("../../../math")},{"../../../math":67}],86:[function(a,b,d){function f(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+
typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}d.__esModule=!0;b=(b=a("../Filter"))&&b.__esModule?b:{"default":b};var k=a("../../../../math");a=function(a){function b(e){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var g=new k.Matrix,c;c=a.call(this,"#define GLSLIFY 1\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n",
"#define GLSLIFY 1\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float alpha;\nuniform sampler2D mask;\n\nvoid main(void)\n{\n    // check clip! this will stop the mask bleeding out from the edges\n    vec2 text = abs( vMaskCoord - 0.5 );\n    text = step(0.5, text);\n\n    float clip = 1.0 - max(text.y, text.x);\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n\n    original *= (masky.r * masky.a * alpha * clip);\n\n    gl_FragColor = original;\n}\n");
if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");c=!c||"object"!==typeof c&&"function"!==typeof c?this:c;e.renderable=!1;c.maskSprite=e;c.maskMatrix=g;return c}f(b,a);b.prototype.apply=function(a,b,c){var h=this.maskSprite;this.uniforms.mask=h._texture;this.uniforms.otherMatrix=a.calculateSpriteMatrix(this.maskMatrix,h);this.uniforms.alpha=h.worldAlpha;a.applyFilter(this,b,c)};return b}(b["default"]);d["default"]=a},{"../../../../math":67,"../Filter":83}],
87:[function(a,b,d){function f(a){return a&&a.__esModule?a:{"default":a}}function k(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}function n(a,c){if(!(a instanceof c))throw new TypeError("Cannot call a class as a function");}d.__esModule=!0;b=
a("./WebGLManager");b=f(b);var h=a("../utils/RenderTarget"),e=f(h),h=a("../utils/Quad"),g=f(h),c=a("../../../math"),h=a("../../../Shader"),p=f(h),y=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(c[e]=a[e]);c["default"]=a;return c}(a("../filters/filterTransforms"));a=a("bit-twiddle");var q=f(a),A=function t(){n(this,t);this.renderTarget=null;this.sourceFrame=new c.Rectangle;this.destinationFrame=new c.Rectangle;this.filters=[];
this.target=null;this.resolution=1};a=function(a){function c(e){n(this,c);var b;b=a.call(this,e);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");b=!b||"object"!==typeof b&&"function"!==typeof b?this:b;b.gl=b.renderer.gl;b.quad=new g["default"](b.gl,e.state.attribState);b.shaderCache={};b.pool={};b.filterData=null;return b}k(c,a);c.prototype.pushFilter=function(a,c){var e=this.renderer,b=this.filterData;if(!b){var g=new A;g.sourceFrame=g.destinationFrame=
this.renderer._activeRenderTarget.size;g.renderTarget=e._activeRenderTarget;this.filterData=this.renderer._activeRenderTarget.filterData=b={index:0,stack:[g]}}(g=b.stack[++b.index])||(g=b.stack[b.index]=new A);var h=c[0].resolution,d=c[0].padding|0,f=a.filterArea||a.getBounds(!0),p=g.sourceFrame,n=g.destinationFrame;p.x=(f.x*h|0)/h;p.y=(f.y*h|0)/h;p.width=(f.width*h|0)/h;p.height=(f.height*h|0)/h;b.stack[0].renderTarget.transform||p.fit(b.stack[0].destinationFrame);p.pad(d);n.width=p.width;n.height=
p.height;b=this.getPotRenderTarget(e.gl,p.width,p.height,h);g.target=a;g.filters=c;g.resolution=h;g.renderTarget=b;b.setFrame(n,p);e.bindRenderTarget(b);e.clear()};c.prototype.popFilter=function(){var a=this.filterData,c=a.stack[a.index-1],e=a.stack[a.index];this.quad.map(e.renderTarget.size,e.sourceFrame).upload();var b=e.filters;if(1===b.length)b[0].apply(this,e.renderTarget,c.renderTarget,!1),this.freePotRenderTarget(e.renderTarget);else{var g=e.renderTarget,h=this.getPotRenderTarget(this.renderer.gl,
e.sourceFrame.width,e.sourceFrame.height,e.resolution);h.setFrame(e.destinationFrame,e.sourceFrame);for(e=0;e<b.length-1;++e){b[e].apply(this,g,h,!0);var d=g,g=h,h=d}b[e].apply(this,g,c.renderTarget,!1);this.freePotRenderTarget(g);this.freePotRenderTarget(h)}a.index--;0===a.index&&(this.filterData=null)};c.prototype.applyFilter=function(a,c,e,b){var g=this.renderer,h=a.glShaders[g.CONTEXT_UID];h||(a.glShaderKey?(h=this.shaderCache[a.glShaderKey],h||(h=new p["default"](this.gl,a.vertexSrc,a.fragmentSrc),
a.glShaders[g.CONTEXT_UID]=this.shaderCache[a.glShaderKey]=h)):h=a.glShaders[g.CONTEXT_UID]=new p["default"](this.gl,a.vertexSrc,a.fragmentSrc),this.quad.initVao(h));g.bindRenderTarget(e);b&&(b=g.gl,b.disable(b.SCISSOR_TEST),g.clear(),b.enable(b.SCISSOR_TEST));e===g.maskManager.scissorRenderTarget&&g.maskManager.pushScissorMask(null,g.maskManager.scissorData);g.bindShader(h);this.syncUniforms(h,a);c.texture.bind(0);g._activeTextureLocation=0;g.state.setBlendMode(a.blendMode);this.quad.draw()};c.prototype.syncUniforms=
function(a,c){var e=c.uniformData,b=c.uniforms,g=1,h;if(a.uniforms.data.filterArea){h=this.filterData.stack[this.filterData.index];var d=a.uniforms.filterArea;d[0]=h.renderTarget.size.width;d[1]=h.renderTarget.size.height;d[2]=h.sourceFrame.x;d[3]=h.sourceFrame.y;a.uniforms.filterArea=d}a.uniforms.data.filterClamp&&(h=this.filterData.stack[this.filterData.index],d=a.uniforms.filterClamp,d[0]=0,d[1]=0,d[2]=(h.sourceFrame.width-1)/h.renderTarget.size.width,d[3]=(h.sourceFrame.height-1)/h.renderTarget.size.height,
a.uniforms.filterClamp=d);for(var f in e)"sampler2D"===e[f].type?(a.uniforms[f]=g,b[f].baseTexture?this.renderer.bindTexture(b[f].baseTexture,g):(h=this.renderer.gl,this.renderer._activeTextureLocation=h.TEXTURE0+g,h.activeTexture(h.TEXTURE0+g),b[f].texture.bind()),g++):"mat3"===e[f].type?a.uniforms[f]=void 0!==b[f].a?b[f].toArray(!0):b[f]:"vec2"===e[f].type?void 0!==b[f].x?(h=a.uniforms[f]||new Float32Array(2),h[0]=b[f].x,h[1]=b[f].y,a.uniforms[f]=h):a.uniforms[f]=b[f]:"float"===e[f].type?a.uniforms.data[f].value!==
e[f]&&(a.uniforms[f]=b[f]):a.uniforms[f]=b[f]};c.prototype.getRenderTarget=function(a,c){var e=this.filterData.stack[this.filterData.index],b=this.getPotRenderTarget(this.renderer.gl,e.sourceFrame.width,e.sourceFrame.height,c||e.resolution);b.setFrame(e.destinationFrame,e.sourceFrame);return b};c.prototype.returnRenderTarget=function(a){this.freePotRenderTarget(a)};c.prototype.calculateScreenSpaceMatrix=function(a){var c=this.filterData.stack[this.filterData.index];return y.calculateScreenSpaceMatrix(a,
c.sourceFrame,c.renderTarget.size)};c.prototype.calculateNormalizedScreenSpaceMatrix=function(a){var c=this.filterData.stack[this.filterData.index];return y.calculateNormalizedScreenSpaceMatrix(a,c.sourceFrame,c.renderTarget.size,c.destinationFrame)};c.prototype.calculateSpriteMatrix=function(a,c){var e=this.filterData.stack[this.filterData.index];return y.calculateSpriteMatrix(a,e.sourceFrame,e.renderTarget.size,c)};c.prototype.destroy=function(){this.shaderCache=[];this.emptyPool()};c.prototype.getPotRenderTarget=
function(a,c,b,g){c=q["default"].nextPow2(c*g);b=q["default"].nextPow2(b*g);var h=(c&65535)<<16|b&65535;this.pool[h]||(this.pool[h]=[]);a=this.pool[h].pop()||new e["default"](a,c,b,null,1);a.resolution=g;a.defaultFrame.width=a.size.width=c/g;a.defaultFrame.height=a.size.height=b/g;return a};c.prototype.emptyPool=function(){for(var a in this.pool){var c=this.pool[a];if(c)for(var e=0;e<c.length;e++)c[e].destroy(!0)}this.pool={}};c.prototype.freePotRenderTarget=function(a){this.pool[(a.size.width*a.resolution&
65535)<<16|a.size.height*a.resolution&65535].push(a)};return c}(b["default"]);d["default"]=a},{"../../../Shader":42,"../../../math":67,"../filters/filterTransforms":85,"../utils/Quad":92,"../utils/RenderTarget":93,"./WebGLManager":90,"bit-twiddle":1}],88:[function(a,b,d){function f(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,
configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}d.__esModule=!0;b=(b=a("./WebGLManager"))&&b.__esModule?b:{"default":b};var k=(a=a("../filters/spriteMask/SpriteMaskFilter"))&&a.__esModule?a:{"default":a};a=function(a){function b(e){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");e=a.call(this,e);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");e=!e||"object"!==typeof e&&"function"!==
typeof e?this:e;e.scissor=!1;e.scissorData=null;e.scissorRenderTarget=null;e.enableScissor=!0;e.alphaMaskPool=[];e.alphaMaskIndex=0;return e}f(b,a);b.prototype.pushMask=function(a,b){if(b.texture)this.pushSpriteMask(a,b);else if(this.enableScissor&&!this.scissor&&!this.renderer.stencilManager.stencilMaskStack.length&&b.isFastRect()){var c=b.worldTransform,c=Math.atan2(c.b,c.a),c=Math.round(180/Math.PI*c);c%90?this.pushStencilMask(b):this.pushScissorMask(a,b)}else this.pushStencilMask(b)};b.prototype.popMask=
function(a,b){b.texture?this.popSpriteMask(a,b):this.enableScissor&&!this.renderer.stencilManager.stencilMaskStack.length?this.popScissorMask(a,b):this.popStencilMask(a,b)};b.prototype.pushSpriteMask=function(a,b){var c=this.alphaMaskPool[this.alphaMaskIndex];c||(c=this.alphaMaskPool[this.alphaMaskIndex]=[new k["default"](b)]);c[0].resolution=this.renderer.resolution;c[0].maskSprite=b;a.filterArea=b.getBounds(!0);this.renderer.filterManager.pushFilter(a,c);this.alphaMaskIndex++};b.prototype.popSpriteMask=
function(){this.renderer.filterManager.popFilter();this.alphaMaskIndex--};b.prototype.pushStencilMask=function(a){this.renderer.currentRenderer.stop();this.renderer.stencilManager.pushStencil(a)};b.prototype.popStencilMask=function(){this.renderer.currentRenderer.stop();this.renderer.stencilManager.popStencil()};b.prototype.pushScissorMask=function(a,b){b.renderable=!0;var c=this.renderer._activeRenderTarget,h=b.getBounds();h.fit(c.size);b.renderable=!1;this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST);
var d=this.renderer.resolution;this.renderer.gl.scissor(h.x*d,(c.root?c.size.height-h.y-h.height:h.y)*d,h.width*d,h.height*d);this.scissorRenderTarget=c;this.scissorData=b;this.scissor=!0};b.prototype.popScissorMask=function(){this.scissorData=this.scissorRenderTarget=null;this.scissor=!1;var a=this.renderer.gl;a.disable(a.SCISSOR_TEST)};return b}(b["default"]);d["default"]=a},{"../filters/spriteMask/SpriteMaskFilter":86,"./WebGLManager":90}],89:[function(a,b,d){function f(a,b){if("function"!==typeof b&&
null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}d.__esModule=!0;var k=(a=a("./WebGLManager"))&&a.__esModule?a:{"default":a};a=function(a){function b(e){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");e=a.call(this,e);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
e=!e||"object"!==typeof e&&"function"!==typeof e?this:e;e.stencilMaskStack=null;return e}f(b,a);b.prototype.setMaskStack=function(a){this.stencilMaskStack=a;var b=this.renderer.gl;0===a.length?b.disable(b.STENCIL_TEST):b.enable(b.STENCIL_TEST)};b.prototype.pushStencil=function(a){this.renderer.setObjectRenderer(this.renderer.plugins.graphics);this.renderer._activeRenderTarget.attachStencilBuffer();var b=this.renderer.gl,c=this.stencilMaskStack;0===c.length&&(b.enable(b.STENCIL_TEST),b.clear(b.STENCIL_BUFFER_BIT),
b.stencilFunc(b.ALWAYS,1,1));c.push(a);b.colorMask(!1,!1,!1,!1);b.stencilOp(b.KEEP,b.KEEP,b.INCR);this.renderer.plugins.graphics.render(a);b.colorMask(!0,!0,!0,!0);b.stencilFunc(b.NOTEQUAL,0,c.length);b.stencilOp(b.KEEP,b.KEEP,b.KEEP)};b.prototype.popStencil=function(){this.renderer.setObjectRenderer(this.renderer.plugins.graphics);var a=this.renderer.gl,b=this.stencilMaskStack,c=b.pop();0===b.length?a.disable(a.STENCIL_TEST):(a.colorMask(!1,!1,!1,!1),a.stencilOp(a.KEEP,a.KEEP,a.DECR),this.renderer.plugins.graphics.render(c),
a.colorMask(!0,!0,!0,!0),a.stencilFunc(a.NOTEQUAL,0,b.length),a.stencilOp(a.KEEP,a.KEEP,a.KEEP))};b.prototype.destroy=function(){k["default"].prototype.destroy.call(this);this.stencilMaskStack.stencilStack=null};return b}(k["default"]);d["default"]=a},{"./WebGLManager":90}],90:[function(a,b,d){d.__esModule=!0;a=function(){function a(b){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.renderer=b;this.renderer.on("context",this.onContextChange,this)}a.prototype.onContextChange=
function(){};a.prototype.destroy=function(){this.renderer.off("context",this.onContextChange,this);this.renderer=null};return a}();d["default"]=a},{}],91:[function(a,b,d){function f(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}d.__esModule=!0;
a=a("../managers/WebGLManager");a=function(a){function b(){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var h=a.apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!h||"object"!==typeof h&&"function"!==typeof h?this:h}f(b,a);b.prototype.start=function(){};b.prototype.stop=function(){this.flush()};b.prototype.flush=function(){};b.prototype.render=function(a){};return b}((a&&a.__esModule?a:{"default":a})["default"]);
d["default"]=a},{"../managers/WebGLManager":90}],92:[function(a,b,d){d.__esModule=!0;var f=(b=a("pixi-gl-core"))&&b.__esModule?b:{"default":b},k=(a=a("../../../utils/createIndicesForQuads"))&&a.__esModule?a:{"default":a};a=function(){function a(b,e){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.gl=b;this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]);this.uvs=new Float32Array([0,0,1,0,1,1,0,1]);this.interleaved=new Float32Array(16);for(var g=0;4>g;g++)this.interleaved[4*
g]=this.vertices[2*g],this.interleaved[4*g+1]=this.vertices[2*g+1],this.interleaved[4*g+2]=this.uvs[2*g],this.interleaved[4*g+3]=this.uvs[2*g+1];this.indices=(0,k["default"])(1);this.vertexBuffer=f["default"].GLBuffer.createVertexBuffer(b,this.interleaved,b.STATIC_DRAW);this.indexBuffer=f["default"].GLBuffer.createIndexBuffer(b,this.indices,b.STATIC_DRAW);this.vao=new f["default"].VertexArrayObject(b,e)}a.prototype.initVao=function(a){this.vao.clear().addIndex(this.indexBuffer).addAttribute(this.vertexBuffer,
a.attributes.aVertexPosition,this.gl.FLOAT,!1,16,0).addAttribute(this.vertexBuffer,a.attributes.aTextureCoord,this.gl.FLOAT,!1,16,8)};a.prototype.map=function(a,b){var g=0,c=0;this.uvs[0]=g;this.uvs[1]=c;this.uvs[2]=g+b.width/a.width;this.uvs[3]=c;this.uvs[4]=g+b.width/a.width;this.uvs[5]=c+b.height/a.height;this.uvs[6]=g;this.uvs[7]=c+b.height/a.height;g=b.x;c=b.y;this.vertices[0]=g;this.vertices[1]=c;this.vertices[2]=g+b.width;this.vertices[3]=c;this.vertices[4]=g+b.width;this.vertices[5]=c+b.height;
this.vertices[6]=g;this.vertices[7]=c+b.height;return this};a.prototype.draw=function(){this.vao.bind().draw(this.gl.TRIANGLES,6,0).unbind();return this};a.prototype.upload=function(){for(var a=0;4>a;a++)this.interleaved[4*a]=this.vertices[2*a],this.interleaved[4*a+1]=this.vertices[2*a+1],this.interleaved[4*a+2]=this.uvs[2*a],this.interleaved[4*a+3]=this.uvs[2*a+1];this.vertexBuffer.upload(this.interleaved);return this};a.prototype.destroy=function(){var a=this.gl;a.deleteBuffer(this.vertexBuffer);
a.deleteBuffer(this.indexBuffer)};return a}();d["default"]=a},{"../../../utils/createIndicesForQuads":114,"pixi-gl-core":12}],93:[function(a,b,d){d.__esModule=!0;var f=a("../../../math"),k=a("../../../const"),n=a("pixi-gl-core");a=function(){function a(b,g,c,d,m,q){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.gl=b;this.texture=this.frameBuffer=null;this.clearColor=[0,0,0,0];this.size=new f.Rectangle(0,0,1,1);this.resolution=m||k.RESOLUTION;this.projectionMatrix=
new f.Matrix;this.frame=this.transform=null;this.defaultFrame=new f.Rectangle;this.stencilBuffer=this.sourceFrame=this.destinationFrame=null;this.stencilMaskStack=[];this.filterData=null;this.scaleMode=d||k.SCALE_MODES.DEFAULT;(this.root=q)?(this.frameBuffer=new n.GLFramebuffer(b,100,100),this.frameBuffer.framebuffer=null):(this.frameBuffer=n.GLFramebuffer.createRGBA(b,100,100),this.scaleMode===k.SCALE_MODES.NEAREST?this.frameBuffer.texture.enableNearestScaling():this.frameBuffer.texture.enableLinearScaling(),
this.texture=this.frameBuffer.texture);this.setFrame();this.resize(g,c)}a.prototype.clear=function(a){a=a||this.clearColor;this.frameBuffer.clear(a[0],a[1],a[2],a[3])};a.prototype.attachStencilBuffer=function(){this.root||this.frameBuffer.enableStencil()};a.prototype.setFrame=function(a,b){this.destinationFrame=a||this.destinationFrame||this.defaultFrame;this.sourceFrame=b||this.sourceFrame||a};a.prototype.activate=function(){var a=this.gl;this.frameBuffer.bind();this.calculateProjection(this.destinationFrame,
this.sourceFrame);this.transform&&this.projectionMatrix.append(this.transform);this.destinationFrame!==this.sourceFrame?(a.enable(a.SCISSOR_TEST),a.scissor(this.destinationFrame.x|0,this.destinationFrame.y|0,this.destinationFrame.width*this.resolution|0,this.destinationFrame.height*this.resolution|0)):a.disable(a.SCISSOR_TEST);a.viewport(this.destinationFrame.x|0,this.destinationFrame.y|0,this.destinationFrame.width*this.resolution|0,this.destinationFrame.height*this.resolution|0)};a.prototype.calculateProjection=
function(a,b){var c=this.projectionMatrix;b=b||a;c.identity();this.root?(c.a=1/a.width*2,c.d=-1/a.height*2,c.tx=-1-b.x*c.a,c.ty=1-b.y*c.d):(c.a=1/a.width*2,c.d=1/a.height*2,c.tx=-1-b.x*c.a,c.ty=-1-b.y*c.d)};a.prototype.resize=function(a,b){a|=0;b|=0;if(this.size.width!==a||this.size.height!==b)this.size.width=a,this.size.height=b,this.defaultFrame.width=a,this.defaultFrame.height=b,this.frameBuffer.resize(a*this.resolution,b*this.resolution),this.calculateProjection(this.frame||this.size)};a.prototype.destroy=
function(){this.frameBuffer.destroy();this.texture=this.frameBuffer=null};return a}();d["default"]=a},{"../../../const":43,"../../../math":67,"pixi-gl-core":12}],94:[function(a,b,d){function f(a){for(var b="",g=0;g<a;++g)0<g&&(b+="\nelse "),g<a-1&&(b+="if(test == "+g+".0){}");return b}d.__esModule=!0;d["default"]=function(a,b){var g=!b;if(0===a)throw Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");if(g){var c=document.createElement("canvas");c.width=1;c.height=1;b=k["default"].createContext(c)}for(c=
b.createShader(b.FRAGMENT_SHADER);;){var d=n.replace(/%forloop%/gi,f(a));b.shaderSource(c,d);b.compileShader(c);if(b.getShaderParameter(c,b.COMPILE_STATUS))break;else a=a/2|0}g&&b.getExtension("WEBGL_lose_context")&&b.getExtension("WEBGL_lose_context").loseContext();return a};var k=(a=a("pixi-gl-core"))&&a.__esModule?a:{"default":a},n="precision mediump float;\nvoid main(void){\nfloat test = 0.1;\n%forloop%\ngl_FragColor = vec4(0.0);\n}"},{"pixi-gl-core":12}],95:[function(a,b,d){d.__esModule=!0;d["default"]=
function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];b[f.BLEND_MODES.NORMAL]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];b[f.BLEND_MODES.ADD]=[a.ONE,a.DST_ALPHA];b[f.BLEND_MODES.MULTIPLY]=[a.DST_COLOR,a.ONE_MINUS_SRC_ALPHA];b[f.BLEND_MODES.SCREEN]=[a.ONE,a.ONE_MINUS_SRC_COLOR];b[f.BLEND_MODES.OVERLAY]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];b[f.BLEND_MODES.DARKEN]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];b[f.BLEND_MODES.LIGHTEN]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];b[f.BLEND_MODES.COLOR_DODGE]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];
b[f.BLEND_MODES.COLOR_BURN]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];b[f.BLEND_MODES.HARD_LIGHT]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];b[f.BLEND_MODES.SOFT_LIGHT]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];b[f.BLEND_MODES.DIFFERENCE]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];b[f.BLEND_MODES.EXCLUSION]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];b[f.BLEND_MODES.HUE]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];b[f.BLEND_MODES.SATURATION]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];b[f.BLEND_MODES.COLOR]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];b[f.BLEND_MODES.LUMINOSITY]=[a.ONE,a.ONE_MINUS_SRC_ALPHA];
return b};var f=a("../../../const")},{"../../../const":43}],96:[function(a,b,d){d.__esModule=!0;d["default"]=function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};b[f.DRAW_MODES.POINTS]=a.POINTS;b[f.DRAW_MODES.LINES]=a.LINES;b[f.DRAW_MODES.LINE_LOOP]=a.LINE_LOOP;b[f.DRAW_MODES.LINE_STRIP]=a.LINE_STRIP;b[f.DRAW_MODES.TRIANGLES]=a.TRIANGLES;b[f.DRAW_MODES.TRIANGLE_STRIP]=a.TRIANGLE_STRIP;b[f.DRAW_MODES.TRIANGLE_FAN]=a.TRIANGLE_FAN;return b};var f=a("../../../const")},{"../../../const":43}],
97:[function(a,b,d){d.__esModule=!0;d["default"]=function(a){a.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")}},{}],98:[function(a,b,d){function f(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,
c):a.__proto__=c)}d.__esModule=!0;var k=function(){function a(c,b){for(var e=0;e<b.length;e++){var g=b[e];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(c,g.key,g)}}return function(c,b,e){b&&a(c.prototype,b);e&&a(c,e);return c}}(),n=a("../math"),h=a("../utils"),e=a("../const"),g=(b=a("../textures/Texture"))&&b.__esModule?b:{"default":b};a=(a=a("../display/Container"))&&a.__esModule?a:{"default":a};var c=new n.Point;a=function(a){function b(c){if(!(this instanceof
b))throw new TypeError("Cannot call a class as a function");var h;h=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");h=!h||"object"!==typeof h&&"function"!==typeof h?this:h;h._anchor=new n.ObservablePoint(h._onAnchorUpdate,h);h._texture=null;h._width=0;h._height=0;h._tint=null;h._tintRGB=null;h.tint=16777215;h.blendMode=e.BLEND_MODES.NORMAL;h.shader=null;h.cachedTint=16777215;h.texture=c||g["default"].EMPTY;h.vertexData=new Float32Array(8);
h.vertexTrimmedData=null;h._transformID=-1;h._textureID=-1;return h}f(b,a);b.prototype._onTextureUpdate=function(){this._textureID=-1;this._width&&(this.scale.x=(0,h.sign)(this.scale.x)*this._width/this.texture.orig.width);this._height&&(this.scale.y=(0,h.sign)(this.scale.y)*this._height/this.texture.orig.height)};b.prototype._onAnchorUpdate=function(){this._transformID=-1};b.prototype.calculateVertices=function(){if(this._transformID!==this.transform._worldID||this._textureID!==this._texture._updateID){this._transformID=
this.transform._worldID;this._textureID=this._texture._updateID;var a=this._texture,c=this.transform.worldTransform,b=c.a,e=c.b,g=c.c,h=c.d,d=c.tx,c=c.ty,f=this.vertexData,p=a.trim,n=a.orig,k=this._anchor,m;p?(m=p.x-k._x*n.width,a=m+p.width,n=p.y-k._y*n.height,p=n+p.height):(a=n.width*(1-k._x),m=n.width*-k._x,p=n.height*(1-k._y),n=n.height*-k._y);f[0]=b*m+g*n+d;f[1]=h*n+e*m+c;f[2]=b*a+g*n+d;f[3]=h*n+e*a+c;f[4]=b*a+g*p+d;f[5]=h*p+e*a+c;f[6]=b*m+g*p+d;f[7]=h*p+e*m+c}};b.prototype.calculateTrimmedVertices=
function(){this.vertexTrimmedData||(this.vertexTrimmedData=new Float32Array(8));var a=this.vertexTrimmedData,c=this._texture.orig,b=this._anchor,e=this.transform.worldTransform,g=e.a,h=e.b,d=e.c,f=e.d,p=e.tx,e=e.ty,n=c.width*(1-b._x),k=c.width*-b._x,m=c.height*(1-b._y),c=c.height*-b._y;a[0]=g*k+d*c+p;a[1]=f*c+h*k+e;a[2]=g*n+d*c+p;a[3]=f*c+h*n+e;a[4]=g*n+d*m+p;a[5]=f*m+h*n+e;a[6]=g*k+d*m+p;a[7]=f*m+h*k+e};b.prototype._renderWebGL=function(a){this.calculateVertices();a.setObjectRenderer(a.plugins.sprite);
a.plugins.sprite.render(this)};b.prototype._renderCanvas=function(a){a.plugins.sprite.render(this)};b.prototype._calculateBounds=function(){var a=this._texture.trim,c=this._texture.orig;!a||a.width===c.width&&a.height===c.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))};b.prototype.getLocalBounds=function(c){return 0===this.children.length?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,
this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._x),c||(this._localBoundsRect||(this._localBoundsRect=new n.Rectangle),c=this._localBoundsRect),this._bounds.getRectangle(c)):a.prototype.getLocalBounds.call(this,c)};b.prototype.containsPoint=function(a){this.worldTransform.applyInverse(a,c);var b=this._texture.orig.width;a=this._texture.orig.height;var e=-b*this.anchor.x;
return c.x>e&&c.x<e+b&&(b=-a*this.anchor.y,c.y>b&&c.y<b+a)?!0:!1};b.prototype.destroy=function(c){a.prototype.destroy.call(this,c);this._anchor=null;("boolean"===typeof c?c:c&&c.texture)&&this._texture.destroy(!!("boolean"===typeof c?c:c&&c.baseTexture));this.shader=this._texture=null};b.from=function(a){return new b(g["default"].from(a))};b.fromFrame=function(a){var c=h.TextureCache[a];if(!c)throw Error('The frameId "'+a+'" does not exist in the texture cache');return new b(c)};b.fromImage=function(a,
c,e){return new b(g["default"].fromImage(a,c,e))};k(b,[{key:"width",get:function(){return Math.abs(this.scale.x)*this.texture.orig.width},set:function(a){var c=(0,h.sign)(this.scale.x)||1;this.scale.x=c*a/this.texture.orig.width;this._width=a}},{key:"height",get:function(){return Math.abs(this.scale.y)*this.texture.orig.height},set:function(a){var c=(0,h.sign)(this.scale.y)||1;this.scale.y=c*a/this.texture.orig.height;this._height=a}},{key:"anchor",get:function(){return this._anchor},set:function(a){this._anchor.copy(a)}},
{key:"tint",get:function(){return this._tint},set:function(a){this._tint=a;this._tintRGB=(a>>16)+(a&65280)+((a&255)<<16)}},{key:"texture",get:function(){return this._texture},set:function(a){if(this._texture!==a&&(this._texture=a,this.cachedTint=16777215,this._textureID=-1,a))if(a.baseTexture.hasLoaded)this._onTextureUpdate();else a.once("update",this._onTextureUpdate,this)}}]);return b}(a["default"]);d["default"]=a},{"../const":43,"../display/Container":45,"../math":67,"../textures/Texture":109,
"../utils":116}],99:[function(a,b,d){d.__esModule=!0;b=(b=a("../../renderers/canvas/CanvasRenderer"))&&b.__esModule?b:{"default":b};var f=a("../../const"),k=a("../../math"),n=(a=a("./CanvasTinter"))&&a.__esModule?a:{"default":a},h=new k.Matrix;a=function(){function a(b){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.renderer=b}a.prototype.render=function(a){var c=a._texture,b=this.renderer,e=c._frame.width,d=c._frame.height,m=a.transform.worldTransform,z,t;0>=
c.orig.width||0>=c.orig.height||!c.baseTexture.source||(b.setBlendMode(a.blendMode),c.valid&&(b.context.globalAlpha=a.worldAlpha,z=c.baseTexture.scaleMode===f.SCALE_MODES.LINEAR,b.smoothProperty&&b.context[b.smoothProperty]!==z&&(b.context[b.smoothProperty]=z),c.trim?(z=c.trim.width/2+c.trim.x-a.anchor.x*c.orig.width,t=c.trim.height/2+c.trim.y-a.anchor.y*c.orig.height):(z=(.5-a.anchor.x)*c.orig.width,t=(.5-a.anchor.y)*c.orig.height),c.rotate&&(m.copy(h),m=h,k.GroupD8.matrixAppendRotationInv(m,c.rotate,
z,t),t=z=0),z-=e/2,t-=d/2,b.roundPixels?(b.context.setTransform(m.a,m.b,m.c,m.d,m.tx*b.resolution|0,m.ty*b.resolution|0),z|=0,t|=0):b.context.setTransform(m.a,m.b,m.c,m.d,m.tx*b.resolution,m.ty*b.resolution),m=c.baseTexture.resolution,16777215!==a.tint?(a.cachedTint!==a.tint&&(a.cachedTint=a.tint,a.tintedTexture=n["default"].getTintedTexture(a,a.tint)),b.context.drawImage(a.tintedTexture,0,0,e*m,d*m,z*b.resolution,t*b.resolution,e*b.resolution,d*b.resolution)):b.context.drawImage(c.baseTexture.source,
c._frame.x*m,c._frame.y*m,e*m,d*m,z*b.resolution,t*b.resolution,e*b.resolution,d*b.resolution)))};a.prototype.destroy=function(){this.renderer=null};return a}();d["default"]=a;b["default"].registerPlugin("sprite",a)},{"../../const":43,"../../math":67,"../../renderers/canvas/CanvasRenderer":74,"./CanvasTinter":100}],100:[function(a,b,d){d.__esModule=!0;var f=a("../../utils");a=(a=a("../../renderers/canvas/utils/canUseNewCanvasBlendModes"))&&a.__esModule?a:{"default":a};var k={getTintedTexture:function(a,
b){var e=a.texture;b=k.roundColor(b);var g="#"+("00000"+(b|0).toString(16)).substr(-6);e.tintCache=e.tintCache||{};if(e.tintCache[g])return e.tintCache[g];var c=k.canvas||document.createElement("canvas");k.tintMethod(e,b,c);if(k.convertTintToImage){var d=new Image;d.src=c.toDataURL();e.tintCache[g]=d}else e.tintCache[g]=c,k.canvas=null;return c},tintWithMultiply:function(a,b,e){var g=e.getContext("2d"),c=a._frame.clone(),d=a.baseTexture.resolution;c.x*=d;c.y*=d;c.width*=d;c.height*=d;e.width=c.width;
e.height=c.height;g.fillStyle="#"+("00000"+(b|0).toString(16)).substr(-6);g.fillRect(0,0,c.width,c.height);g.globalCompositeOperation="multiply";g.drawImage(a.baseTexture.source,c.x,c.y,c.width,c.height,0,0,c.width,c.height);g.globalCompositeOperation="destination-atop";g.drawImage(a.baseTexture.source,c.x,c.y,c.width,c.height,0,0,c.width,c.height)},tintWithOverlay:function(a,b,e){var g=e.getContext("2d"),c=a._frame.clone(),d=a.baseTexture.resolution;c.x*=d;c.y*=d;c.width*=d;c.height*=d;e.width=c.width;
e.height=c.height;g.globalCompositeOperation="copy";g.fillStyle="#"+("00000"+(b|0).toString(16)).substr(-6);g.fillRect(0,0,c.width,c.height);g.globalCompositeOperation="destination-atop";g.drawImage(a.baseTexture.source,c.x,c.y,c.width,c.height,0,0,c.width,c.height)},tintWithPerPixel:function(a,b,e){var g=e.getContext("2d"),c=a._frame.clone(),d=a.baseTexture.resolution;c.x*=d;c.y*=d;c.width*=d;c.height*=d;e.width=c.width;e.height=c.height;g.globalCompositeOperation="copy";g.drawImage(a.baseTexture.source,
c.x,c.y,c.width,c.height,0,0,c.width,c.height);e=(0,f.hex2rgb)(b);a=e[0];b=e[1];e=e[2];for(var c=g.getImageData(0,0,c.width,c.height),d=c.data,k=0;k<d.length;k+=4)d[k+0]*=a,d[k+1]*=b,d[k+2]*=e;g.putImageData(c,0,0)},roundColor:function(a){var b=k.cacheStepsPerColorChannel;a=(0,f.hex2rgb)(a);a[0]=Math.min(255,a[0]/b*b);a[1]=Math.min(255,a[1]/b*b);a[2]=Math.min(255,a[2]/b*b);return(0,f.rgb2hex)(a)},cacheStepsPerColorChannel:8,convertTintToImage:!1,canUseMultiply:(0,a["default"])(),tintMethod:0};k.tintMethod=
k.canUseMultiply?k.tintWithMultiply:k.tintWithPerPixel;d["default"]=k},{"../../renderers/canvas/utils/canUseNewCanvasBlendModes":77,"../../utils":116}],101:[function(a,b,d){d.__esModule=!0;a=function(){function a(b){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.vertices=new ArrayBuffer(b);this.float32View=new Float32Array(this.vertices);this.uint32View=new Uint32Array(this.vertices)}a.prototype.destroy=function(){this.colors=this.uvs=this.positions=this.vertices=
null};return a}();d["default"]=a},{}],102:[function(a,b,d){function f(a){return a&&a.__esModule?a:{"default":a}}function k(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}d.__esModule=!0;b=a("../../renderers/webgl/utils/ObjectRenderer");b=f(b);
var n=a("../../renderers/webgl/WebGLRenderer"),n=f(n),h=a("../../utils/createIndicesForQuads"),e=f(h),h=a("./generateMultiTextureShader"),g=f(h),h=a("../../renderers/webgl/utils/checkMaxIfStatmentsInShader"),c=f(h),h=a("./BatchBuffer"),p=f(h),y=a("../../const"),h=a("pixi-gl-core"),q=f(h);a=a("bit-twiddle");var A=f(a),z=0;a=function(a){function b(c){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");c=a.call(this,c);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
c=!c||"object"!==typeof c&&"function"!==typeof c?this:c;c.vertSize=5;c.vertByteSize=4*c.vertSize;c.size=y.SPRITE_BATCH_SIZE;c.buffers=[];for(var g=1;g<=A["default"].nextPow2(c.size);g*=2)c.buffers.push(new p["default"](4*g*c.vertByteSize));c.indices=(0,e["default"])(c.size);c.shaders=null;z=c.currentIndex=0;c.groups=[];for(g=0;g<c.size;g++)c.groups[g]={textures:[],textureCount:0,ids:[],size:0,start:0,blend:0};c.sprites=[];c.vertexBuffers=[];c.vaos=[];c.vaoMax=2;c.vertexCount=0;c.renderer.on("prerender",
c.onPrerender,c);return c}k(b,a);b.prototype.onContextChange=function(){var a=this.renderer.gl;this.MAX_TEXTURES=Math.min(a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS),y.SPRITE_MAX_TEXTURES);this.MAX_TEXTURES=(0,c["default"])(this.MAX_TEXTURES,a);this.shaders=Array(this.MAX_TEXTURES);this.shaders[0]=(0,g["default"])(a,1);this.shaders[1]=(0,g["default"])(a,2);this.indexBuffer=q["default"].GLBuffer.createIndexBuffer(a,this.indices,a.STATIC_DRAW);for(var b=this.shaders[1],e=0;e<this.vaoMax;e++)this.vertexBuffers[e]=
q["default"].GLBuffer.createVertexBuffer(a,null,a.STREAM_DRAW),this.vaos[e]=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(this.vertexBuffers[e],b.attributes.aVertexPosition,a.FLOAT,!1,this.vertByteSize,0).addAttribute(this.vertexBuffers[e],b.attributes.aTextureCoord,a.UNSIGNED_SHORT,!0,this.vertByteSize,8).addAttribute(this.vertexBuffers[e],b.attributes.aColor,a.UNSIGNED_BYTE,!0,this.vertByteSize,12).addAttribute(this.vertexBuffers[e],b.attributes.aTextureId,a.FLOAT,!1,this.vertByteSize,
16);this.vao=this.vaos[0];this.currentBlendMode=99999};b.prototype.onPrerender=function(){this.vertexCount=0};b.prototype.render=function(a){this.currentIndex>=this.size&&this.flush();a.texture._uvs&&(this.sprites[this.currentIndex++]=a)};b.prototype.flush=function(){if(0!==this.currentIndex){var a=this.renderer.gl,c=A["default"].nextPow2(this.currentIndex),c=A["default"].log2(c),b=this.buffers[c],e=this.sprites,c=this.groups,d=b.float32View,h=b.uint32View,f=0,p,n=void 0,k=1,m=0,y=c[0],t,v,N,R=e[0].blendMode;
y.textureCount=0;y.start=0;y.blend=R;z++;var E;for(E=0;E<this.currentIndex;E++){N=e[E];p=N._texture.baseTexture;R!==N.blendMode&&(R=N.blendMode,n=null,m=this.MAX_TEXTURES,z++);n!==p&&(n=p,p._enabled!==z&&(m===this.MAX_TEXTURES&&(z++,m=0,y.size=E-y.start,y=c[k++],y.textureCount=0,y.blend=R,y.start=E),p._enabled=z,p._id=m,y.textures[y.textureCount++]=p,m++));t=N.vertexData;v=N._tintRGB+(255*N.worldAlpha<<24);N=N._texture._uvs.uvsUint32;p=p._id;if(this.renderer.roundPixels){var D=this.renderer.resolution;
d[f]=(t[0]*D|0)/D;d[f+1]=(t[1]*D|0)/D;d[f+5]=(t[2]*D|0)/D;d[f+6]=(t[3]*D|0)/D;d[f+10]=(t[4]*D|0)/D;d[f+11]=(t[5]*D|0)/D;d[f+15]=(t[6]*D|0)/D;d[f+16]=(t[7]*D|0)/D}else d[f]=t[0],d[f+1]=t[1],d[f+5]=t[2],d[f+6]=t[3],d[f+10]=t[4],d[f+11]=t[5],d[f+15]=t[6],d[f+16]=t[7];h[f+2]=N[0];h[f+7]=N[1];h[f+12]=N[2];h[f+17]=N[3];h[f+3]=h[f+8]=h[f+13]=h[f+18]=v;d[f+4]=d[f+9]=d[f+14]=d[f+19]=p;f+=20}y.size=E-y.start;this.vertexCount++;this.vaoMax<=this.vertexCount&&(this.vaoMax++,e=this.shaders[1],this.vertexBuffers[this.vertexCount]=
q["default"].GLBuffer.createVertexBuffer(a,null,a.STREAM_DRAW),this.vaos[this.vertexCount]=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(this.vertexBuffers[this.vertexCount],e.attributes.aVertexPosition,a.FLOAT,!1,this.vertByteSize,0).addAttribute(this.vertexBuffers[this.vertexCount],e.attributes.aTextureCoord,a.UNSIGNED_SHORT,!0,this.vertByteSize,8).addAttribute(this.vertexBuffers[this.vertexCount],e.attributes.aColor,a.UNSIGNED_BYTE,!0,this.vertByteSize,12).addAttribute(this.vertexBuffers[this.vertexCount],
e.attributes.aTextureId,a.FLOAT,!1,this.vertByteSize,16));this.vertexBuffers[this.vertexCount].upload(b.vertices,0);this.vao=this.vaos[this.vertexCount].bind();for(E=0;E<k;E++){b=c[E];d=b.textureCount;(e=this.shaders[d-1])||(e=this.shaders[d-1]=(0,g["default"])(a,d));this.renderer.bindShader(e);for(e=0;e<d;e++)this.renderer.bindTexture(b.textures[e],e);this.renderer.state.setBlendMode(b.blend);a.drawElements(a.TRIANGLES,6*b.size,a.UNSIGNED_SHORT,12*b.start)}this.currentIndex=0}};b.prototype.start=
function(){};b.prototype.stop=function(){this.flush();this.vao.unbind()};b.prototype.destroy=function(){for(var c=0;c<this.vaoMax;c++)this.vertexBuffers[c].destroy(),this.vaos[c].destroy();this.indexBuffer.destroy();this.renderer.off("prerender",this.onPrerender,this);a.prototype.destroy.call(this);for(c=0;c<this.shaders.length;c++)this.shaders[c]&&this.shaders[c].destroy();this.sprites=this.indices=this.indexBuffer=this.vaos=this.vertexBuffers=null;for(c=0;c<this.buffers.length;c++)this.buffers[c].destroy()};
return b}(b["default"]);d["default"]=a;n["default"].registerPlugin("sprite",a)},{"../../const":43,"../../renderers/webgl/WebGLRenderer":81,"../../renderers/webgl/utils/ObjectRenderer":91,"../../renderers/webgl/utils/checkMaxIfStatmentsInShader":94,"../../utils/createIndicesForQuads":114,"./BatchBuffer":101,"./generateMultiTextureShader":103,"bit-twiddle":1,"pixi-gl-core":12}],103:[function(a,b,d){function f(a){var b;b="\n\n";for(var g=0;g<a;g++)0<g&&(b+="\nelse "),g<a-1&&(b+="if(textureId == "+g+
".0)"),b+="\n{",b+="\n\tcolor = texture2D(uSamplers["+g+"], vTextureCoord);",b+="\n}";return b+"\n\n"}d.__esModule=!0;d["default"]=function(a,b){for(var g=n,g=g.replace(/%count%/gi,b),g=g.replace(/%forloop%/gi,f(b)),g=new k["default"](a,"#define GLSLIFY 1\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n",
g),c=[],d=0;d<b;d++)c[d]=d;g.bind();g.uniforms.uSamplers=c;return g};var k=(a=a("../../Shader"))&&a.__esModule?a:{"default":a},n="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\nvoid main(void){\nvec4 color;\nfloat textureId = floor(vTextureId+0.5);\n%forloop%\ngl_FragColor = color * vColor;\n}"},{"../../Shader":42}],104:[function(a,b,d){function f(a){return a&&a.__esModule?a:{"default":a}}function k(a,c){if("function"!==typeof c&&
null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}d.__esModule=!0;var n=function(){function a(c,b){for(var e=0;e<b.length;e++){var g=b[e];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(c,g.key,g)}}return function(c,b,e){b&&a(c.prototype,
b);e&&a(c,e);return c}}();b=a("../sprites/Sprite");b=f(b);var h=a("../textures/Texture"),e=f(h),g=a("../math"),c=a("../utils"),p=a("../const");a=a("./TextStyle");var y=f(a),q={texture:!0,children:!1,baseTexture:!0};a=function(a){function b(c,d){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var h=document.createElement("canvas");h.width=3;h.height=3;var f=e["default"].fromCanvas(h);f.orig=new g.Rectangle;f.trim=new g.Rectangle;f=a.call(this,f);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
f=!f||"object"!==typeof f&&"function"!==typeof f?this:f;f.canvas=h;f.context=f.canvas.getContext("2d");f.resolution=p.RESOLUTION;f._text=null;f._style=null;f._styleListener=null;f._font="";f.text=c;f.style=d;f.localStyleID=-1;return f}k(b,a);b.prototype.updateText=function(a){var c=this._style;this.localStyleID!==c.styleID&&(this.dirty=!0,this.localStyleID=c.styleID);if(this.dirty||!a){this._font=c.fontStyle+" "+c.fontVariant+" "+c.fontWeight+" "+("number"===typeof c.fontSize?c.fontSize+"px":c.fontSize)+
" "+c.fontFamily;this.context.font=this._font;a=(c.wordWrap?this.wordWrap(this._text):this._text).split(/(?:\r\n|\r|\n)/);for(var b=Array(a.length),e=0,g=this.determineFontProperties(this._font),d=0;d<a.length;d++){var h=this.context.measureText(a[d]).width+(a[d].length-1)*c.letterSpacing;b[d]=h;e=Math.max(e,h)}d=e+c.strokeThickness;c.dropShadow&&(d+=c.dropShadowDistance);d+=2*c.padding;this.canvas.width=Math.ceil((d+this.context.lineWidth)*this.resolution);d=this.style.lineHeight||g.fontSize+c.strokeThickness;
h=Math.max(d,g.fontSize+c.strokeThickness)+(a.length-1)*d;c.dropShadow&&(h+=c.dropShadowDistance);this.canvas.height=Math.ceil((h+2*this._style.padding)*this.resolution);this.context.scale(this.resolution,this.resolution);this.context.clearRect(0,0,this.canvas.width,this.canvas.height);this.context.font=this._font;this.context.strokeStyle=c.stroke;this.context.lineWidth=c.strokeThickness;this.context.textBaseline=c.textBaseline;this.context.lineJoin=c.lineJoin;this.context.miterLimit=c.miterLimit;
var f;if(c.dropShadow){0<c.dropShadowBlur?(this.context.shadowColor=c.dropShadowColor,this.context.shadowBlur=c.dropShadowBlur):this.context.fillStyle=c.dropShadowColor;for(var p=Math.cos(c.dropShadowAngle)*c.dropShadowDistance,n=Math.sin(c.dropShadowAngle)*c.dropShadowDistance,k=0;k<a.length;k++)h=c.strokeThickness/2,f=c.strokeThickness/2+k*d+g.ascent,"right"===c.align?h+=e-b[k]:"center"===c.align&&(h+=(e-b[k])/2),c.fill&&(this.drawLetterSpacing(a[k],h+p+c.padding,f+n+c.padding),c.stroke&&c.strokeThickness&&
(this.context.strokeStyle=c.dropShadowColor,this.drawLetterSpacing(a[k],h+p+c.padding,f+n+c.padding,!0),this.context.strokeStyle=c.stroke))}this.context.fillStyle=this._generateFillStyle(c,a);for(p=0;p<a.length;p++)h=c.strokeThickness/2,f=c.strokeThickness/2+p*d+g.ascent,"right"===c.align?h+=e-b[p]:"center"===c.align&&(h+=(e-b[p])/2),c.stroke&&c.strokeThickness&&this.drawLetterSpacing(a[p],h+c.padding,f+c.padding,!0),c.fill&&this.drawLetterSpacing(a[p],h+c.padding,f+c.padding);this.updateTexture()}};
b.prototype.drawLetterSpacing=function(a,c,b){var e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:!1,g=this._style.letterSpacing;if(0===g)e?this.context.strokeText(a,c,b):this.context.fillText(a,c,b);else for(var d=String.prototype.split.call(a,""),h=c,f=0,p;f<a.length;)p=d[f++],e?this.context.strokeText(p,h,b):this.context.fillText(p,h,b),h+=this.context.measureText(p).width+g};b.prototype.updateTexture=function(){var a=this._texture,c=this._style;a.baseTexture.hasLoaded=!0;a.baseTexture.resolution=
this.resolution;a.baseTexture.realWidth=this.canvas.width;a.baseTexture.realHeight=this.canvas.height;a.baseTexture.width=this.canvas.width/this.resolution;a.baseTexture.height=this.canvas.height/this.resolution;a.trim.width=a._frame.width=this.canvas.width/this.resolution;a.trim.height=a._frame.height=this.canvas.height/this.resolution;a.trim.x=-c.padding;a.trim.y=-c.padding;a.orig.width=a._frame.width-2*c.padding;a.orig.height=a._frame.height-2*c.padding;this._onTextureUpdate();a.baseTexture.emit("update",
a.baseTexture);this.dirty=!1};b.prototype.renderWebGL=function(c){this.resolution!==c.resolution&&(this.resolution=c.resolution,this.dirty=!0);this.updateText(!0);a.prototype.renderWebGL.call(this,c)};b.prototype._renderCanvas=function(c){this.resolution!==c.resolution&&(this.resolution=c.resolution,this.dirty=!0);this.updateText(!0);a.prototype._renderCanvas.call(this,c)};b.prototype.determineFontProperties=function(a){var c=b.fontPropertiesCache[a];if(!c){var c={},e=b.fontPropertiesCanvas,g=b.fontPropertiesContext;
g.font=a;var d=Math.ceil(g.measureText("|M\u00c9q").width),h=Math.ceil(g.measureText("M").width),f=2*h,h=1.4*h|0;e.width=d;e.height=f;g.fillStyle="#f00";g.fillRect(0,0,d,f);g.font=a;g.textBaseline="alphabetic";g.fillStyle="#000";g.fillText("|M\u00c9q",0,h);var e=g.getImageData(0,0,d,f).data,g=e.length,d=4*d,p,n=0,k=!1;for(p=0;p<h;++p){for(var m=0;m<d;m+=4)if(255!==e[n+m]){k=!0;break}if(k)break;else n+=d}c.ascent=h-p;n=g-d;k=!1;for(p=f;p>h;--p){for(f=0;f<d;f+=4)if(255!==e[n+f]){k=!0;break}if(k)break;
else n-=d}c.descent=p-h;c.fontSize=c.ascent+c.descent;b.fontPropertiesCache[a]=c}return c};b.prototype.wordWrap=function(a){var c="";a=a.split("\n");for(var b=this._style.wordWrapWidth,e=0;e<a.length;e++){for(var g=b,d=a[e].split(" "),h=0;h<d.length;h++){var f=this.context.measureText(d[h]).width;if(this._style.breakWords&&f>b)for(var f=d[h].split(""),p=0;p<f.length;p++){var n=this.context.measureText(f[p]).width;n>g?(c+="\n"+f[p],g=b-n):(0===p&&(c+=" "),c+=f[p],g-=n)}else p=f+this.context.measureText(" ").width,
0===h||p>g?(0<h&&(c+="\n"),c+=d[h],g=b-f):(g-=p,c+=" "+d[h])}e<a.length-1&&(c+="\n")}return c};b.prototype._calculateBounds=function(){this.updateText(!0);this.calculateVertices();this._bounds.addQuad(this.vertexData)};b.prototype._onStyleChange=function(){this.dirty=!0};b.prototype._generateFillStyle=function(a,c){if(!Array.isArray(a.fill))return a.fill;if(navigator.isCocoonJS)return a.fill[0];var b,e,g,d;b=this.canvas.width/this.resolution;e=this.canvas.height/this.resolution;if(a.fillGradientType===
p.TEXT_GRADIENT.LINEAR_VERTICAL){b=this.context.createLinearGradient(b/2,0,b/2,e);e=(a.fill.length+1)*c.length;for(var h=g=0;h<c.length;h++){g+=1;for(var f=0;f<a.fill.length;f++)d=g/e,b.addColorStop(d,a.fill[f]),g++}}else for(b=this.context.createLinearGradient(0,e/2,b,e/2),e=a.fill.length+1,g=1,h=0;h<a.fill.length;h++)d=g/e,b.addColorStop(d,a.fill[h]),g++;return b};b.prototype.destroy=function(c){"boolean"===typeof c&&(c={children:c});c=Object.assign({},q,c);a.prototype.destroy.call(this,c);this._style=
this.canvas=this.context=null};n(b,[{key:"width",get:function(){this.updateText(!0);return Math.abs(this.scale.x)*this.texture.orig.width},set:function(a){this.updateText(!0);var b=(0,c.sign)(this.scale.x)||1;this.scale.x=b*a/this.texture.orig.width;this._width=a}},{key:"height",get:function(){this.updateText(!0);return Math.abs(this.scale.y)*this._texture.orig.height},set:function(a){this.updateText(!0);var b=(0,c.sign)(this.scale.y)||1;this.scale.y=b*a/this.texture.orig.height;this._height=a}},
{key:"style",get:function(){return this._style},set:function(a){a=a||{};this._style=a instanceof y["default"]?a:new y["default"](a);this.localStyleID=-1;this.dirty=!0}},{key:"text",get:function(){return this._text},set:function(a){a=(a||" ").toString();this._text!==a&&(this._text=a,this.dirty=!0)}}]);return b}(b["default"]);d["default"]=a;a.fontPropertiesCache={};a.fontPropertiesCanvas=document.createElement("canvas");a.fontPropertiesContext=a.fontPropertiesCanvas.getContext("2d")},{"../const":43,
"../math":67,"../sprites/Sprite":98,"../textures/Texture":109,"../utils":116,"./TextStyle":105}],105:[function(a,b,d){function f(a){if("number"===typeof a)return(0,n.hex2string)(a);if(Array.isArray(a))for(var b=0;b<a.length;++b)"number"===typeof a[b]&&(a[b]=(0,n.hex2string)(a[b]));return a}d.__esModule=!0;var k=function(){function a(b,c){for(var e=0;e<c.length;e++){var d=c[e];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(b,d.key,d)}}return function(b,
c,d){c&&a(b.prototype,c);d&&a(b,d);return b}}();b=a("../const");var n=a("../utils"),h={align:"left",breakWords:!1,dropShadow:!1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"#000000",dropShadowDistance:5,fill:"black",fillGradientType:b.TEXT_GRADIENT.LINEAR_VERTICAL,fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",wordWrap:!1,
wordWrapWidth:100};a=function(){function a(b){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.styleID=0;Object.assign(this,h,b)}a.prototype.clone=function(){var b={},c;for(c in this._defaults)b[c]=this[c];return new a(b)};a.prototype.reset=function(){Object.assign(this,this._defaults)};k(a,[{key:"align",get:function(){return this._align},set:function(a){this._align!==a&&(this._align=a,this.styleID++)}},{key:"breakWords",get:function(){return this._breakWords},
set:function(a){this._breakWords!==a&&(this._breakWords=a,this.styleID++)}},{key:"dropShadow",get:function(){return this._dropShadow},set:function(a){this._dropShadow!==a&&(this._dropShadow=a,this.styleID++)}},{key:"dropShadowAngle",get:function(){return this._dropShadowAngle},set:function(a){this._dropShadowAngle!==a&&(this._dropShadowAngle=a,this.styleID++)}},{key:"dropShadowBlur",get:function(){return this._dropShadowBlur},set:function(a){this._dropShadowBlur!==a&&(this._dropShadowBlur=a,this.styleID++)}},
{key:"dropShadowColor",get:function(){return this._dropShadowColor},set:function(a){a=f(a);this._dropShadowColor!==a&&(this._dropShadowColor=a,this.styleID++)}},{key:"dropShadowDistance",get:function(){return this._dropShadowDistance},set:function(a){this._dropShadowDistance!==a&&(this._dropShadowDistance=a,this.styleID++)}},{key:"fill",get:function(){return this._fill},set:function(a){a=f(a);this._fill!==a&&(this._fill=a,this.styleID++)}},{key:"fillGradientType",get:function(){return this._fillGradientType},
set:function(a){this._fillGradientType!==a&&(this._fillGradientType=a,this.styleID++)}},{key:"fontFamily",get:function(){return this._fontFamily},set:function(a){this.fontFamily!==a&&(this._fontFamily=a,this.styleID++)}},{key:"fontSize",get:function(){return this._fontSize},set:function(a){this._fontSize!==a&&(this._fontSize=a,this.styleID++)}},{key:"fontStyle",get:function(){return this._fontStyle},set:function(a){this._fontStyle!==a&&(this._fontStyle=a,this.styleID++)}},{key:"fontVariant",get:function(){return this._fontVariant},
set:function(a){this._fontVariant!==a&&(this._fontVariant=a,this.styleID++)}},{key:"fontWeight",get:function(){return this._fontWeight},set:function(a){this._fontWeight!==a&&(this._fontWeight=a,this.styleID++)}},{key:"letterSpacing",get:function(){return this._letterSpacing},set:function(a){this._letterSpacing!==a&&(this._letterSpacing=a,this.styleID++)}},{key:"lineHeight",get:function(){return this._lineHeight},set:function(a){this._lineHeight!==a&&(this._lineHeight=a,this.styleID++)}},{key:"lineJoin",
get:function(){return this._lineJoin},set:function(a){this._lineJoin!==a&&(this._lineJoin=a,this.styleID++)}},{key:"miterLimit",get:function(){return this._miterLimit},set:function(a){this._miterLimit!==a&&(this._miterLimit=a,this.styleID++)}},{key:"padding",get:function(){return this._padding},set:function(a){this._padding!==a&&(this._padding=a,this.styleID++)}},{key:"stroke",get:function(){return this._stroke},set:function(a){a=f(a);this._stroke!==a&&(this._stroke=a,this.styleID++)}},{key:"strokeThickness",
get:function(){return this._strokeThickness},set:function(a){this._strokeThickness!==a&&(this._strokeThickness=a,this.styleID++)}},{key:"textBaseline",get:function(){return this._textBaseline},set:function(a){this._textBaseline!==a&&(this._textBaseline=a,this.styleID++)}},{key:"wordWrap",get:function(){return this._wordWrap},set:function(a){this._wordWrap!==a&&(this._wordWrap=a,this.styleID++)}},{key:"wordWrapWidth",get:function(){return this._wordWrapWidth},set:function(a){this._wordWrapWidth!==
a&&(this._wordWrapWidth=a,this.styleID++)}}]);return a}();d["default"]=a},{"../const":43,"../utils":116}],106:[function(a,b,d){function f(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}d.__esModule=!0;b=(b=a("./BaseTexture"))&&b.__esModule?b:{"default":b};
var k=a("../const");a=function(a){function b(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:100,g=1<arguments.length&&void 0!==arguments[1]?arguments[1]:100,c=arguments[2],d=arguments[3];if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var f;f=a.call(this,null,c);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");f=!f||"object"!==typeof f&&"function"!==typeof f?this:f;f.resolution=d||k.RESOLUTION;f.width=e;
f.height=g;f.realWidth=f.width*f.resolution;f.realHeight=f.height*f.resolution;f.scaleMode=c||k.SCALE_MODES.DEFAULT;f.hasLoaded=!0;f._glRenderTargets={};f._canvasRenderTarget=null;f.valid=!1;return f}f(b,a);b.prototype.resize=function(a,b){if(a!==this.width||b!==this.height)this.valid=0<a&&0<b,this.width=a,this.height=b,this.realWidth=this.width*this.resolution,this.realHeight=this.height*this.resolution,this.valid&&this.emit("update",this)};b.prototype.destroy=function(){a.prototype.destroy.call(this,
!0);this.renderer=null};return b}(b["default"]);d["default"]=a},{"../const":43,"./BaseTexture":107}],107:[function(a,b,d){function f(a){return a&&a.__esModule?a:{"default":a}}function k(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}d.__esModule=
!0;$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},h=a("../utils"),e=a("../const");b=a("eventemitter3");b=f(b);var g=a("../utils/determineCrossOrigin"),c=f(g);a=a("bit-twiddle");var p=f(a);a=function(a){function b(c,
g,d){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var f;f=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");f=!f||"object"!==typeof f&&"function"!==typeof f?this:f;f.uid=(0,h.uid)();f.touched=0;f.resolution=d||e.RESOLUTION;f.width=100;f.height=100;f.realWidth=100;f.realHeight=100;f.scaleMode=g||e.SCALE_MODES.DEFAULT;f.hasLoaded=!1;f.isLoading=!1;f.source=null;f.origSource=null;f.imageType=null;f.sourceScale=
1;f.premultipliedAlpha=!0;f.imageUrl=null;f.isPowerOfTwo=!1;f.mipmap=e.MIPMAP_TEXTURES;f.wrapMode=e.WRAP_MODES.DEFAULT;f._glTextures={};f._enabled=0;f._id=0;c&&f.loadSource(c);return f}k(b,a);b.prototype.update=function(){"svg"!==this.imageType&&(this.realWidth=this.source.naturalWidth||this.source.videoWidth||this.source.width,this.realHeight=this.source.naturalHeight||this.source.videoHeight||this.source.height,this.width=this.realWidth/this.resolution,this.height=this.realHeight/this.resolution,
this.isPowerOfTwo=p["default"].isPow2(this.realWidth)&&p["default"].isPow2(this.realHeight));this.emit("update",this)};b.prototype.loadSource=function(a){var c=this,b=this.isLoading;this.isLoading=this.hasLoaded=!1;b&&this.source&&(this.source.onload=null,this.source.onerror=null);var e=!this.source;this.source=a;if((a.src&&a.complete||a.getContext)&&a.width&&a.height)this._updateImageType(),"svg"===this.imageType?this._loadSvgSource():this._sourceLoaded(),e&&this.emit("loaded",this);else if(!a.getContext&&
(e=function(){c.isLoading=!0;a.onload=function(){c._updateImageType();a.onload=null;a.onerror=null;c.isLoading&&(c.isLoading=!1,c._sourceLoaded(),"svg"===c.imageType?c._loadSvgSource():c.emit("loaded",c))};a.onerror=function(){a.onload=null;a.onerror=null;c.isLoading&&(c.isLoading=!1,c.emit("error",c))};if(a.complete&&a.src){a.onload=null;a.onerror=null;if("svg"===c.imageType)return c._loadSvgSource(),{v:void 0};c.isLoading=!1;a.width&&a.height?(c._sourceLoaded(),b&&c.emit("loaded",c)):b&&c.emit("error",
c)}}(),"object"===("undefined"===typeof e?"undefined":n(e))))return e.v};b.prototype._updateImageType=function(){if(this.imageUrl){var a=(0,h.decomposeDataUri)(this.imageUrl);if(a&&"image"===a.mediaType){if(a=a.subType.split("+")[0],a=(0,h.getUrlFileExtension)("."+a),!a)throw Error("Invalid image type in data URI.");}else if(a=(0,h.getUrlFileExtension)(this.imageUrl),!a)throw Error("Invalid image type in URL.");this.imageType=a}};b.prototype._loadSvgSource=function(){if("svg"===this.imageType){var a=
(0,h.decomposeDataUri)(this.imageUrl);a?this._loadSvgSourceUsingDataUri(a):this._loadSvgSourceUsingXhr()}};b.prototype._loadSvgSourceUsingDataUri=function(a){if("base64"===a.encoding){if(!atob)throw Error("Your browser doesn't support base64 conversions.");a=atob(a.data)}else a=a.data;this._loadSvgSourceUsingString(a)};b.prototype._loadSvgSourceUsingXhr=function(){var a=this,c=new XMLHttpRequest;c.onload=function(){if(c.readyState!==c.DONE||200!==c.status)throw Error("Failed to load SVG using XHR.");
a._loadSvgSourceUsingString(c.response)};c.onerror=function(){return a.emit("error",a)};c.open("GET",this.imageUrl,!0);c.send()};b.prototype._loadSvgSourceUsingString=function(a){var c=(0,h.getSvgSize)(a);a=c.width;c=c.height;if(!a||!c)throw Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");this.realWidth=Math.round(a*this.sourceScale);this.realHeight=Math.round(c*this.sourceScale);this.width=this.realWidth/this.resolution;this.height=this.realHeight/this.resolution;
this.isPowerOfTwo=p["default"].isPow2(this.realWidth)&&p["default"].isPow2(this.realHeight);var b=document.createElement("canvas");b.width=this.realWidth;b.height=this.realHeight;b._pixiId="canvas_"+(0,h.uid)();b.getContext("2d").drawImage(this.source,0,0,a,c,0,0,this.realWidth,this.realHeight);this.origSource=this.source;this.source=b;h.BaseTextureCache[b._pixiId]=this;this.isLoading=!1;this._sourceLoaded();this.emit("loaded",this)};b.prototype._sourceLoaded=function(){this.hasLoaded=!0;this.update()};
b.prototype.destroy=function(){this.imageUrl&&(delete h.BaseTextureCache[this.imageUrl],delete h.TextureCache[this.imageUrl],this.imageUrl=null,navigator.isCocoonJS||(this.source.src=""));this.source&&this.source._pixiId&&delete h.BaseTextureCache[this.source._pixiId];this.source=null;this.dispose()};b.prototype.dispose=function(){this.emit("dispose",this)};b.prototype.updateSourceImage=function(a){this.source.src=a;this.loadSource(this.source)};b.fromImage=function(a,e,g,d){var f=h.BaseTextureCache[a];
if(!f){var p=new Image;void 0===e&&0!==a.indexOf("data:")&&(p.crossOrigin=(0,c["default"])(a));f=new b(p,g);f.imageUrl=a;d&&(f.sourceScale=d);f.resolution=(0,h.getResolutionOfUrl)(a);p.src=a;h.BaseTextureCache[a]=f}return f};b.fromCanvas=function(a,c){a._pixiId||(a._pixiId="canvas_"+(0,h.uid)());var e=h.BaseTextureCache[a._pixiId];e||(e=new b(a,c),h.BaseTextureCache[a._pixiId]=e);return e};return b}(b["default"]);d["default"]=a},{"../const":43,"../utils":116,"../utils/determineCrossOrigin":115,"bit-twiddle":1,
eventemitter3:3}],108:[function(a,b,d){function f(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}d.__esModule=!0;var k=(b=a("./BaseRenderTexture"))&&b.__esModule?b:{"default":b};a=a("./Texture");a=function(a){function b(e,g,c,d,f){if(!(this instanceof
b))throw new TypeError("Cannot call a class as a function");var m=null;if(!(e instanceof k["default"])){var A=g;d=d||0;f=f||1;console.warn("Please use RenderTexture.create("+A+", "+c+") instead of the ctor directly.");m=e;g=null;e=new k["default"](A,c,d,f)}e=a.call(this,e,g);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");e=!e||"object"!==typeof e&&"function"!==typeof e?this:e;e.legacyRenderer=m;e.valid=!0;e._updateUvs();return e}f(b,a);b.prototype.resize=
function(a,b,c){this.valid=0<a&&0<b;this._frame.width=this.orig.width=a;this._frame.height=this.orig.height=b;c||this.baseTexture.resize(a,b);this._updateUvs()};b.create=function(a,g,c,d){return new b(new k["default"](a,g,c,d))};return b}((a&&a.__esModule?a:{"default":a})["default"]);d["default"]=a},{"./BaseRenderTexture":106,"./Texture":109}],109:[function(a,b,d){function f(a){return a&&a.__esModule?a:{"default":a}}function k(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+
typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}d.__esModule=!0;var n=function(){function a(c,b){for(var e=0;e<b.length;e++){var g=b[e];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(c,g.key,g)}}return function(c,b,e){b&&a(c.prototype,b);e&&a(c,e);return c}}();b=a("./BaseTexture");var h=f(b);b=a("./VideoBaseTexture");
var e=f(b);b=a("./TextureUvs");var g=f(b);b=a("eventemitter3");b=f(b);var c=a("../math"),p=a("../utils");a=function(a){function b(e,g,d,h,f){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var p;p=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");p=!p||"object"!==typeof p&&"function"!==typeof p?this:p;p.noFrame=!1;g||(p.noFrame=!0,g=new c.Rectangle(0,0,1,1));e instanceof b&&(e=e.baseTexture);p.baseTexture=e;
p._frame=g;p.trim=h;p.valid=!1;p.requiresUpdate=!1;p._uvs=null;p.orig=d||g;p._rotate=Number(f||0);if(!0===f)p._rotate=2;else if(0!==p._rotate%2)throw Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");if(e.hasLoaded)p.noFrame&&(g=new c.Rectangle(0,0,e.width,e.height),e.on("update",p.onBaseTextureUpdated,p)),p.frame=g;else e.once("loaded",p.onBaseTextureLoaded,p);p._updateID=0;p.transform=null;return p}k(b,a);b.prototype.update=function(){this.baseTexture.update()};
b.prototype.onBaseTextureLoaded=function(a){this._updateID++;this.frame=this.noFrame?new c.Rectangle(0,0,a.width,a.height):this._frame;this.baseTexture.on("update",this.onBaseTextureUpdated,this);this.emit("update",this)};b.prototype.onBaseTextureUpdated=function(a){this._updateID++;this._frame.width=a.width;this._frame.height=a.height;this.emit("update",this)};b.prototype.destroy=function(a){this.baseTexture&&(a&&(p.TextureCache[this.baseTexture.imageUrl]&&delete p.TextureCache[this.baseTexture.imageUrl],
this.baseTexture.destroy()),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture.off("loaded",this.onBaseTextureLoaded,this),this.baseTexture=null);this.orig=this.trim=this._uvs=this._frame=null;this.valid=!1;this.off("dispose",this.dispose,this);this.off("update",this.update,this)};b.prototype.clone=function(){return new b(this.baseTexture,this.frame,this.orig,this.trim,this.rotate)};b.prototype._updateUvs=function(){this._uvs||(this._uvs=new g["default"]);this._uvs.set(this._frame,
this.baseTexture,this.rotate);this._updateID++};b.fromImage=function(a,c,e,g){var d=p.TextureCache[a];d||(d=new b(h["default"].fromImage(a,c,e,g)),p.TextureCache[a]=d);return d};b.fromFrame=function(a){var c=p.TextureCache[a];if(!c)throw Error('The frameId "'+a+'" does not exist in the texture cache');return c};b.fromCanvas=function(a,c){return new b(h["default"].fromCanvas(a,c))};b.fromVideo=function(a,c){return"string"===typeof a?b.fromVideoUrl(a,c):new b(e["default"].fromVideo(a,c))};b.fromVideoUrl=
function(a,c){return new b(e["default"].fromUrl(a,c))};b.from=function(a){if("string"===typeof a){var c=p.TextureCache[a];return c?c:null!==a.match(/\.(mp4|webm|ogg|h264|avi|mov)$/)?b.fromVideoUrl(a):b.fromImage(a)}return a instanceof HTMLImageElement?new b(new h["default"](a)):a instanceof HTMLCanvasElement?b.fromCanvas(a):a instanceof HTMLVideoElement?b.fromVideo(a):a instanceof h["default"]?new b(a):a};b.addTextureToCache=function(a,c){p.TextureCache[c]=a};b.removeTextureFromCache=function(a){var c=
p.TextureCache[a];delete p.TextureCache[a];delete p.BaseTextureCache[a];return c};n(b,[{key:"frame",get:function(){return this._frame},set:function(a){this._frame=a;this.noFrame=!1;if(a.x+a.width>this.baseTexture.width||a.y+a.height>this.baseTexture.height)throw Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.valid=a&&a.width&&a.height&&this.baseTexture.hasLoaded;this.trim||this.rotate||(this.orig=a);this.valid&&this._updateUvs()}},{key:"rotate",get:function(){return this._rotate},
set:function(a){this._rotate=a;this.valid&&this._updateUvs()}},{key:"width",get:function(){return this.orig?this.orig.width:0}},{key:"height",get:function(){return this.orig?this.orig.height:0}}]);return b}(b["default"]);d["default"]=a;a.EMPTY=new a(new h["default"]);a.EMPTY.destroy=function(){};a.EMPTY.on=function(){};a.EMPTY.once=function(){};a.EMPTY.emit=function(){}},{"../math":67,"../utils":116,"./BaseTexture":107,"./TextureUvs":110,"./VideoBaseTexture":111,eventemitter3:3}],110:[function(a,
b,d){d.__esModule=!0;var f=(a=a("../math/GroupD8"))&&a.__esModule?a:{"default":a};a=function(){function a(){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.y0=this.x0=0;this.x1=1;this.y1=0;this.y2=this.x2=1;this.x3=0;this.y3=1;this.uvsUint32=new Uint32Array(4)}a.prototype.set=function(a,b,e){var g=b.width,c=b.height;if(e){b=a.width/2/g;var d=a.height/2/c,g=a.x/g+b;a=a.y/c+d;e=f["default"].add(e,f["default"].NW);this.x0=g+b*f["default"].uX(e);this.y0=a+d*f["default"].uY(e);
e=f["default"].add(e,2);this.x1=g+b*f["default"].uX(e);this.y1=a+d*f["default"].uY(e);e=f["default"].add(e,2);this.x2=g+b*f["default"].uX(e);this.y2=a+d*f["default"].uY(e);e=f["default"].add(e,2);this.x3=g+b*f["default"].uX(e);this.y3=a+d*f["default"].uY(e)}else this.x0=a.x/g,this.y0=a.y/c,this.x1=(a.x+a.width)/g,this.y1=a.y/c,this.x2=(a.x+a.width)/g,this.y2=(a.y+a.height)/c,this.x3=a.x/g,this.y3=(a.y+a.height)/c;this.uvsUint32[0]=(65535*this.y0&65535)<<16|65535*this.x0&65535;this.uvsUint32[1]=(65535*
this.y1&65535)<<16|65535*this.x1&65535;this.uvsUint32[2]=(65535*this.y2&65535)<<16|65535*this.x2&65535;this.uvsUint32[3]=(65535*this.y3&65535)<<16|65535*this.x3&65535};return a}();d["default"]=a},{"../math/GroupD8":63}],111:[function(a,b,d){function f(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?
Object.setPrototypeOf(a,c):a.__proto__=c)}function k(a,c){c||(c="video/"+a.substr(a.lastIndexOf(".")+1));var b=document.createElement("source");b.src=a;b.type=c;return b}d.__esModule=!0;var n=function(){function a(c,b){for(var e=0;e<b.length;e++){var g=b[e];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(c,g.key,g)}}return function(c,b,e){b&&a(c.prototype,b);e&&a(c,e);return c}}();b=(b=a("./BaseTexture"))&&b.__esModule?b:{"default":b};var h=a("../utils"),
e=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var b in a)Object.prototype.hasOwnProperty.call(a,b)&&(c[b]=a[b]);c["default"]=a;return c}(a("../ticker"));a=function(a){function c(b,e){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");if(!b)throw Error("No video source element specified.");(b.readyState===b.HAVE_ENOUGH_DATA||b.readyState===b.HAVE_FUTURE_DATA)&&b.width&&b.height&&(b.complete=!0);var d;d=a.call(this,b,e);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
d=!d||"object"!==typeof d&&"function"!==typeof d?this:d;d.width=b.videoWidth;d.height=b.videoHeight;d._autoUpdate=!0;d._isAutoUpdating=!1;d.autoPlay=!0;d.update=d.update.bind(d);d._onCanPlay=d._onCanPlay.bind(d);b.addEventListener("play",d._onPlayStart.bind(d));b.addEventListener("pause",d._onPlayStop.bind(d));d.hasLoaded=!1;d.__loaded=!1;d._isSourceReady()?d._onCanPlay():(b.addEventListener("canplay",d._onCanPlay),b.addEventListener("canplaythrough",d._onCanPlay));return d}f(c,a);c.prototype._isSourcePlaying=
function(){var a=this.source;return 0<a.currentTime&&!1===a.paused&&!1===a.ended&&2<a.readyState};c.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState};c.prototype._onPlayStart=function(){this.hasLoaded||this._onCanPlay();!this._isAutoUpdating&&this.autoUpdate&&(e.shared.add(this.update,this),this._isAutoUpdating=!0)};c.prototype._onPlayStop=function(){this._isAutoUpdating&&(e.shared.remove(this.update,this),this._isAutoUpdating=!1)};c.prototype._onCanPlay=
function(){this.hasLoaded=!0;this.source&&(this.source.removeEventListener("canplay",this._onCanPlay),this.source.removeEventListener("canplaythrough",this._onCanPlay),this.width=this.source.videoWidth,this.height=this.source.videoHeight,this.__loaded||(this.__loaded=!0,this.emit("loaded",this)),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.source.play())};c.prototype.destroy=function(){this._isAutoUpdating&&e.shared.remove(this.update,this);this.source&&this.source._pixiId&&(delete h.BaseTextureCache[this.source._pixiId],
delete this.source._pixiId);a.prototype.destroy.call(this)};c.fromVideo=function(a,b){a._pixiId||(a._pixiId="video_"+(0,h.uid)());var e=h.BaseTextureCache[a._pixiId];e||(e=new c(a,b),h.BaseTextureCache[a._pixiId]=e);return e};c.fromUrl=function(a,b){var e=document.createElement("video");e.setAttribute("webkit-playsinline","");e.setAttribute("playsinline","");if(Array.isArray(a))for(var g=0;g<a.length;++g)e.appendChild(k(a[g].src||a[g],a[g].mime));else e.appendChild(k(a.src||a,a.mime));e.load();return c.fromVideo(e,
b)};n(c,[{key:"autoUpdate",get:function(){return this._autoUpdate},set:function(a){a!==this._autoUpdate&&(this._autoUpdate=a,!this._autoUpdate&&this._isAutoUpdating?(e.shared.remove(this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(e.shared.add(this.update,this),this._isAutoUpdating=!0))}}]);return c}(b["default"]);d["default"]=a;a.fromUrls=a.fromUrl},{"../ticker":113,"../utils":116,"./BaseTexture":107}],112:[function(a,b,d){d.__esModule=!0;var f=function(){function a(b,
g){for(var c=0;c<g.length;c++){var d=g[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(b,d.key,d)}}return function(b,g,c){g&&a(b.prototype,g);c&&a(b,c);return b}}(),k=a("../const"),n=(a=a("eventemitter3"))&&a.__esModule?a:{"default":a};a=function(){function a(){var b=this;if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this._emitter=new n["default"];this._requestId=null;this._maxElapsedMS=100;this.autoStart=!1;
this.deltaTime=1;this.elapsedMS=1/k.TARGET_FPMS;this.lastTime=0;this.speed=1;this.started=!1;this._tick=function(a){b._requestId=null;b.started&&(b.update(a),b.started&&null===b._requestId&&b._emitter.listeners("tick",!0)&&(b._requestId=requestAnimationFrame(b._tick)))}}a.prototype._requestIfNeeded=function(){null===this._requestId&&this._emitter.listeners("tick",!0)&&(this.lastTime=performance.now(),this._requestId=requestAnimationFrame(this._tick))};a.prototype._cancelIfNeeded=function(){null!==
this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)};a.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()};a.prototype.add=function(a,b){this._emitter.on("tick",a,b);this._startIfPossible();return this};a.prototype.addOnce=function(a,b){this._emitter.once("tick",a,b);this._startIfPossible();return this};a.prototype.remove=function(a,b){this._emitter.off("tick",a,b);this._emitter.listeners("tick",!0)||this._cancelIfNeeded();
return this};a.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())};a.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())};a.prototype.update=function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:performance.now(),b;a>this.lastTime?(b=this.elapsedMS=a-this.lastTime,b>this._maxElapsedMS&&(b=this._maxElapsedMS),this.deltaTime=b*k.TARGET_FPMS*this.speed,this._emitter.emit("tick",this.deltaTime)):this.deltaTime=this.elapsedMS=
0;this.lastTime=a};f(a,[{key:"FPS",get:function(){return 1E3/this.elapsedMS}},{key:"minFPS",get:function(){return 1E3/this._maxElapsedMS},set:function(a){this._maxElapsedMS=1/Math.min(Math.max(0,a)/1E3,k.TARGET_FPMS)}}]);return a}();d["default"]=a},{"../const":43,eventemitter3:3}],113:[function(a,b,d){d.__esModule=!0;d.Ticker=d.shared=void 0;a=(a=a("./Ticker"))&&a.__esModule?a:{"default":a};b=new a["default"];b.autoStart=!0;d.shared=b;d.Ticker=a["default"]},{"./Ticker":112}],114:[function(a,b,d){d.__esModule=
!0;d["default"]=function(a){a*=6;for(var b=new Uint16Array(a),d=0,h=0;d<a;d+=6,h+=4)b[d+0]=h+0,b[d+1]=h+1,b[d+2]=h+2,b[d+3]=h+0,b[d+4]=h+2,b[d+5]=h+3;return b}},{}],115:[function(a,b,d){d.__esModule=!0;d["default"]=function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:window.location;if(0===a.indexOf("data:"))return"";b=b||window.location;k||(k=document.createElement("a"));k.href=a;a=f["default"].parse(k.href);var e=!a.port&&""===b.port||a.port===b.port;return a.hostname===b.hostname&&
e&&a.protocol===b.protocol?"":"anonymous"};var f=(a=a("url"))&&a.__esModule?a:{"default":a},k=void 0},{url:28}],116:[function(a,b,d){d.__esModule=!0;d.BaseTextureCache=d.TextureCache=d.pluginTarget=d.EventEmitter=void 0;d.uid=function(){return++k};d.hex2rgb=function(a,b){b=b||[];b[0]=(a>>16&255)/255;b[1]=(a>>8&255)/255;b[2]=(a&255)/255;return b};d.hex2string=function(a){a=a.toString(16);a="000000".substr(0,6-a.length)+a;return"#"+a};d.rgb2hex=function(a){return(255*a[0]<<16)+(255*a[1]<<8)+255*a[2]};
d.getResolutionOfUrl=function(a){return(a=f.RETINA_PREFIX.exec(a))?parseFloat(a[1]):1};d.decomposeDataUri=function(a){if(a=f.DATA_URI.exec(a))return{mediaType:a[1]?a[1].toLowerCase():void 0,subType:a[2]?a[2].toLowerCase():void 0,encoding:a[3]?a[3].toLowerCase():void 0,data:a[4]}};d.getUrlFileExtension=function(a){if(a=f.URL_FILE_EXTENSION.exec(a))return a[1].toLowerCase()};d.getSvgSize=function(a){a=f.SVG_SIZE.exec(a);var b={};a&&(b[a[1]]=Math.round(parseFloat(a[2])),b[a[3]]=Math.round(parseFloat(a[4])));
return b};d.skipHello=function(){n=!0};d.sayHello=function(a){n||(-1<navigator.userAgent.toLowerCase().indexOf("chrome")?window.console.log.apply(console,["\n %c %c %c Pixi.js "+f.VERSION+" - \u2730 "+a+" \u2730  %c  %c  http://www.pixijs.com/  %c %c \u2665%c\u2665%c\u2665 \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;",
"color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"]):window.console&&window.console.log("Pixi.js "+f.VERSION+" - "+a+" - http://www.pixijs.com/"),n=!0)};d.isWebGLSupported=function(){var a={stencil:!0,failIfMajorPerformanceCaveat:!0};try{if(!window.WebGLRenderingContext)return!1;var b=document.createElement("canvas"),g=b.getContext("webgl",a)||b.getContext("experimental-webgl",a),c=!(!g||!g.getContextAttributes().stencil);
if(g){var d=g.getExtension("WEBGL_lose_context");d&&d.loseContext()}return c}catch(f){return!1}};d.sign=function(a){return 0===a?0:0>a?-1:1};d.removeItems=function(a,b,g){var c=a.length;if(!(b>=c||0===g)){g=b+g>c?c-b:g;for(c-=g;b<c;++b)a[b]=a[b+g];a.length=c}};var f=a("../const");b=(b=a("eventemitter3"))&&b.__esModule?b:{"default":b};a=(a=a("./pluginTarget"))&&a.__esModule?a:{"default":a};var k=0,n=!1;d.EventEmitter=b["default"];d.pluginTarget=a["default"];d.TextureCache={};d.BaseTextureCache={}},
{"../const":43,"./pluginTarget":118,eventemitter3:3}],117:[function(a,b,d){d.__esModule=!0;d["default"]=function(a){return f["default"].tablet||f["default"].phone?2:a};var f=(a=a("ismobilejs"))&&a.__esModule?a:{"default":a}},{ismobilejs:4}],118:[function(a,b,d){function f(a){a.__plugins={};a.registerPlugin=function(b,d){a.__plugins[b]=d};a.prototype.initPlugins=function(){this.plugins=this.plugins||{};for(var b in a.__plugins)this.plugins[b]=new a.__plugins[b](this)};a.prototype.destroyPlugins=function(){for(var a in this.plugins)this.plugins[a].destroy(),
this.plugins[a]=null;this.plugins=null}}d.__esModule=!0;d["default"]={mixin:function(a){f(a)}}},{}],119:[function(a,b,d){function f(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(b[e]=a[e]);b["default"]=a;return b}function k(a){var b=Error().stack;"undefined"===typeof b?console.warn("Deprecation Warning: ",a):(b=b.split("\n").splice(3).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cDeprecation Warning: %c%s","color:#614108;background:#fffbe6",
"font-weight:normal;color:#614108;background:#fffbe6",a),console.warn(b),console.groupEnd()):(console.warn("Deprecation Warning: ",a),console.warn(b)))}b=a("./core");var n=f(b);b=a("./mesh");var h=f(b);b=a("./particles");var e=f(b);b=a("./extras");var g=f(b);a=a("./filters");a=f(a);n.SpriteBatch=function(){throw new ReferenceError("SpriteBatch does not exist any more, please use the new ParticleContainer instead.");};n.AssetLoader=function(){throw new ReferenceError("The loader system was overhauled in pixi v3, please see the new PIXI.loaders.Loader class.");
};Object.defineProperties(n,{Stage:{enumerable:!0,get:function(){k("You do not need to use a PIXI Stage any more, you can simply render any container.");return n.Container}},DisplayObjectContainer:{enumerable:!0,get:function(){k("DisplayObjectContainer has been shortened to Container, please use Container from now on.");return n.Container}},Strip:{enumerable:!0,get:function(){k("The Strip class has been renamed to Mesh and moved to mesh.Mesh, please use mesh.Mesh from now on.");return h.Mesh}},Rope:{enumerable:!0,
get:function(){k("The Rope class has been moved to mesh.Rope, please use mesh.Rope from now on.");return h.Rope}},ParticleContainer:{enumerable:!0,get:function(){k("The ParticleContainer class has been moved to particles.ParticleContainer, please use particles.ParticleContainer from now on.");return e.ParticleContainer}},MovieClip:{enumerable:!0,get:function(){k("The MovieClip class has been moved to extras.MovieClip, please use extras.MovieClip from now on.");return g.MovieClip}},TilingSprite:{enumerable:!0,
get:function(){k("The TilingSprite class has been moved to extras.TilingSprite, please use extras.TilingSprite from now on.");return g.TilingSprite}},BitmapText:{enumerable:!0,get:function(){k("The BitmapText class has been moved to extras.BitmapText, please use extras.BitmapText from now on.");return g.BitmapText}},blendModes:{enumerable:!0,get:function(){k("The blendModes has been moved to BLEND_MODES, please use BLEND_MODES from now on.");return n.BLEND_MODES}},scaleModes:{enumerable:!0,get:function(){k("The scaleModes has been moved to SCALE_MODES, please use SCALE_MODES from now on.");
return n.SCALE_MODES}},BaseTextureCache:{enumerable:!0,get:function(){k("The BaseTextureCache class has been moved to utils.BaseTextureCache, please use utils.BaseTextureCache from now on.");return n.utils.BaseTextureCache}},TextureCache:{enumerable:!0,get:function(){k("The TextureCache class has been moved to utils.TextureCache, please use utils.TextureCache from now on.");return n.utils.TextureCache}},math:{enumerable:!0,get:function(){k("The math namespace is deprecated, please access members already accessible on PIXI.");
return n}},AbstractFilter:{enumerable:!0,get:function(){k("AstractFilter has been renamed to Filter, please use PIXI.Filter");return n.Filter}},TransformManual:{enumerable:!0,get:function(){k("TransformManual has been renamed to TransformBase, please update your pixi-spine");return n.TransformBase}}});n.DisplayObject.prototype.generateTexture=function(a,b,e){k("generateTexture has moved to the renderer, please use renderer.generateTexture(displayObject)");return a.generateTexture(this,b,e)};n.Graphics.prototype.generateTexture=
function(a,b){k("graphics generate texture has moved to the renderer. Or to render a graphics to a texture using canvas please use generateCanvasTexture");return this.generateCanvasTexture(a,b)};n.RenderTexture.prototype.render=function(a,b,e,g){this.legacyRenderer.render(a,this,e,b,!g);k("RenderTexture.render is now deprecated, please use renderer.render(displayObject, renderTexture)")};n.RenderTexture.prototype.getImage=function(a){k("RenderTexture.getImage is now deprecated, please use renderer.extract.image(target)");
return this.legacyRenderer.extract.image(a)};n.RenderTexture.prototype.getBase64=function(a){k("RenderTexture.getBase64 is now deprecated, please use renderer.extract.base64(target)");return this.legacyRenderer.extract.base64(a)};n.RenderTexture.prototype.getCanvas=function(a){k("RenderTexture.getCanvas is now deprecated, please use renderer.extract.canvas(target)");return this.legacyRenderer.extract.canvas(a)};n.RenderTexture.prototype.getPixels=function(a){k("RenderTexture.getPixels is now deprecated, please use renderer.extract.pixels(target)");
return this.legacyRenderer.pixels(a)};n.Sprite.prototype.setTexture=function(a){this.texture=a;k("setTexture is now deprecated, please use the texture property, e.g : sprite.texture = texture;")};g.BitmapText.prototype.setText=function(a){this.text=a;k("setText is now deprecated, please use the text property, e.g : myBitmapText.text = 'my text';")};n.Text.prototype.setText=function(a){this.text=a;k("setText is now deprecated, please use the text property, e.g : myText.text = 'my text';")};n.Text.prototype.setStyle=
function(a){this.style=a;k("setStyle is now deprecated, please use the style property, e.g : myText.style = style;")};Object.defineProperties(n.TextStyle.prototype,{font:{get:function(){k("text style property 'font' is now deprecated, please use the 'fontFamily', 'fontSize', 'fontStyle', 'fontVariant' and 'fontWeight' properties from now on");return this._fontStyle+" "+this._fontVariant+" "+this._fontWeight+" "+("number"===typeof this._fontSize?this._fontSize+"px":this._fontSize)+" "+this._fontFamily},
set:function(a){k("text style property 'font' is now deprecated, please use the 'fontFamily','fontSize',fontStyle','fontVariant' and 'fontWeight' properties from now on");1<a.indexOf("italic")?this._fontStyle="italic":-1<a.indexOf("oblique")?this._fontStyle="oblique":this._fontStyle="normal";-1<a.indexOf("small-caps")?this._fontVariant="small-caps":this._fontVariant="normal";a=a.split(" ");var b=-1;this._fontSize=26;for(var e=0;e<a.length;++e)if(a[e].match(/(px|pt|em|%)/)){b=e;this._fontSize=a[e];
break}this._fontWeight="normal";for(e=0;e<b;++e)if(a[e].match(/(bold|bolder|lighter|100|200|300|400|500|600|700|800|900)/)){this._fontWeight=a[e];break}if(-1<b&&b<a.length-1){this._fontFamily="";for(b+=1;b<a.length;++b)this._fontFamily+=a[b]+" ";this._fontFamily=this._fontFamily.slice(0,-1)}else this._fontFamily="Arial";this.styleID++}}});n.Texture.prototype.setFrame=function(a){this.frame=a;k("setFrame is now deprecated, please use the frame property, e.g: myTexture.frame = frame;")};Object.defineProperties(a,
{AbstractFilter:{get:function(){k("AstractFilter has been renamed to Filter, please use PIXI.Filter");return n.AbstractFilter}},SpriteMaskFilter:{get:function(){k("filters.SpriteMaskFilter is an undocumented alias, please use SpriteMaskFilter from now on.");return n.SpriteMaskFilter}}});n.utils.uuid=function(){k("utils.uuid() is deprecated, please use utils.uid() from now on.");return n.utils.uid()};n.utils.canUseNewCanvasBlendModes=function(){k("utils.canUseNewCanvasBlendModes() is deprecated, please use CanvasTinter.canUseMultiply from now on");
return n.CanvasTinter.canUseMultiply}},{"./core":62,"./extras":130,"./filters":141,"./mesh":159,"./particles":162}],120:[function(a,b,d){d.__esModule=!0;var f=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(b[e]=a[e]);b["default"]=a;return b}(a("../../core")),k=new f.Rectangle;a=function(){function a(b){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.renderer=b;b.extract=this}a.prototype.image=
function(a){var b=new Image;b.src=this.base64(a);return b};a.prototype.base64=function(a){return this.canvas(a).toDataURL()};a.prototype.canvas=function(a){var b=this.renderer,g=void 0,c=void 0;a&&(c=a instanceof f.RenderTexture?a:b.generateTexture(a));c?(a=c.baseTexture._canvasRenderTarget.context,g=c.baseTexture._canvasRenderTarget.resolution,b=c.frame):(a=b.rootContext,b=k,b.width=this.renderer.width,b.height=this.renderer.height);var d=b.width*g,n=b.height*g,c=new f.CanvasRenderTarget(d,n),g=
a.getImageData(b.x*g,b.y*g,d,n);c.context.putImageData(g,0,0);return c.canvas};a.prototype.pixels=function(a){var b=this.renderer,g=void 0,c;c=void 0;a&&(c=a instanceof f.RenderTexture?a:b.generateTexture(a));c?(a=c.baseTexture._canvasRenderTarget.context,g=c.baseTexture._canvasRenderTarget.resolution,c=c.frame):(a=b.rootContext,c=k,c.width=b.width,c.height=b.height);return a.getImageData(0,0,c.width*g,c.height*g).data};a.prototype.destroy=function(){this.renderer=this.renderer.extract=null};return a}();
d["default"]=a;f.CanvasRenderer.registerPlugin("extract",a)},{"../../core":62}],121:[function(a,b,d){d.__esModule=!0;var f=a("./webgl/WebGLExtract");Object.defineProperty(d,"webgl",{enumerable:!0,get:function(){return(f&&f.__esModule?f:{"default":f})["default"]}});var k=a("./canvas/CanvasExtract");Object.defineProperty(d,"canvas",{enumerable:!0,get:function(){return(k&&k.__esModule?k:{"default":k})["default"]}})},{"./canvas/CanvasExtract":120,"./webgl/WebGLExtract":122}],122:[function(a,b,d){d.__esModule=
!0;var f=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(b[e]=a[e]);b["default"]=a;return b}(a("../../core")),k=new f.Rectangle;a=function(){function a(b){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.renderer=b;b.extract=this}a.prototype.image=function(a){var b=new Image;b.src=this.base64(a);return b};a.prototype.base64=function(a){return this.canvas(a).toDataURL()};a.prototype.canvas=function(a){var b=
this.renderer,g,c,d;d=void 0;a&&(d=a instanceof f.RenderTexture?a:this.renderer.generateTexture(a));d?(g=d.baseTexture._glRenderTargets[this.renderer.CONTEXT_UID],a=g.resolution,c=d.frame,d=!1):(g=this.renderer.rootRenderTarget,a=g.resolution,d=!0,c=k,c.width=g.size.width,c.height=g.size.height);var n=c.width*a,m=c.height*a,A=new f.CanvasRenderTarget(n,m);g&&(b.bindRenderTarget(g),g=new Uint8Array(4*n*m),b=b.gl,b.readPixels(c.x*a,c.y*a,n,m,b.RGBA,b.UNSIGNED_BYTE,g),b=A.context.getImageData(0,0,n,
m),b.data.set(g),A.context.putImageData(b,0,0),d&&(A.context.scale(1,-1),A.context.drawImage(A.canvas,0,-m)));return A.canvas};a.prototype.pixels=function(a){var b=this.renderer,g,c;c=void 0;a&&(c=a instanceof f.RenderTexture?a:this.renderer.generateTexture(a));c?(g=c.baseTexture._glRenderTargets[this.renderer.CONTEXT_UID],a=g.resolution,c=c.frame):(g=this.renderer.rootRenderTarget,a=g.resolution,c=k,c.width=g.size.width,c.height=g.size.height);var d=c.width*a,n=c.height*a,m=new Uint8Array(4*d*n);
g&&(b.bindRenderTarget(g),b=b.gl,b.readPixels(c.x*a,c.y*a,d,n,b.RGBA,b.UNSIGNED_BYTE,m));return m};a.prototype.destroy=function(){this.renderer=this.renderer.extract=null};return a}();d["default"]=a;f.WebGLRenderer.registerPlugin("extract",a)},{"../../core":62}],123:[function(a,b,d){function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function k(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+
typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}d.__esModule=!0;var n=function(){function a(b,e){for(var g=0;g<e.length;g++){var d=e[g];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(b,d.key,d)}}return function(b,e,d){e&&a(b.prototype,e);d&&a(b,d);return b}}(),h=function(a){if(a&&a.__esModule)return a;var b={};
if(null!=a)for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(b[e]=a[e]);b["default"]=a;return b}(a("../core")),e=(a=a("../core/math/ObservablePoint"))&&a.__esModule?a:{"default":a};a=function(a){function b(d){var h=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var n=f(this,a.call(this));n.textWidth=0;n.textHeight=0;n._glyphs=[];n._font={tint:void 0!==h.tint?h.tint:16777215,align:h.align||"left",name:null,
size:0};n.font=h.font;n._text=d;n.maxWidth=0;n.maxLineHeight=0;n._anchor=new e["default"](function(){n.dirty=!0},n,0,0);n.dirty=!1;n.updateText();return n}k(b,a);b.prototype.updateText=function(){for(var a=b.fonts[this._font.name],e=this._font.size/a.size,g=new h.Point,d=[],f=[],n=null,k=0,m=0,x=0,u=-1,w=0,B=0,G=0;G<this.text.length;G++){var K=this.text.charCodeAt(G);/(\s)/.test(this.text.charAt(G))&&(u=G,w=k);if(/(?:\r\n|\r|\n)/.test(this.text.charAt(G)))f.push(k),m=Math.max(m,k),x++,g.x=0,g.y+=
a.lineHeight,n=null;else if(-1!==u&&0<this.maxWidth&&g.x*e>this.maxWidth)h.utils.removeItems(d,u,G-u),G=u,u=-1,f.push(w),m=Math.max(m,w),x++,g.x=0,g.y+=a.lineHeight,n=null;else{var C=a.chars[K];C&&(n&&C.kerning[n]&&(g.x+=C.kerning[n]),d.push({texture:C.texture,line:x,charCode:K,position:new h.Point(g.x+C.xOffset,g.y+C.yOffset)}),k=g.x+(C.texture.width+C.xOffset),g.x+=C.xAdvance,B=Math.max(B,C.yOffset+C.texture.height),n=K)}}f.push(k);m=Math.max(m,k);n=[];for(k=0;k<=x;k++)u=0,"right"===this._font.align?
u=m-f[k]:"center"===this._font.align&&(u=(m-f[k])/2),n.push(u);f=d.length;x=this.tint;for(k=0;k<f;k++)(u=this._glyphs[k])?u.texture=d[k].texture:(u=new h.Sprite(d[k].texture),this._glyphs.push(u)),u.position.x=(d[k].position.x+n[d[k].line])*e,u.position.y=d[k].position.y*e,u.scale.x=u.scale.y=e,u.tint=x,u.parent||this.addChild(u);for(d=f;d<this._glyphs.length;++d)this.removeChild(this._glyphs[d]);this.textWidth=m*e;this.textHeight=(g.y+a.lineHeight)*e;if(0!==this.anchor.x||0!==this.anchor.y)for(a=
0;a<f;a++)this._glyphs[a].x-=this.textWidth*this.anchor.x,this._glyphs[a].y-=this.textHeight*this.anchor.y;this.maxLineHeight=B*e};b.prototype.updateTransform=function(){this.validate();this.containerUpdateTransform()};b.prototype.getLocalBounds=function(){this.validate();return a.prototype.getLocalBounds.call(this)};b.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)};n(b,[{key:"tint",get:function(){return this._font.tint},set:function(a){this._font.tint="number"===typeof a&&
0<=a?a:16777215;this.dirty=!0}},{key:"align",get:function(){return this._font.align},set:function(a){this._font.align=a||"left";this.dirty=!0}},{key:"anchor",get:function(){return this._anchor},set:function(a){"number"===typeof a?this._anchor.set(a):this._anchor.copy(a)}},{key:"font",get:function(){return this._font},set:function(a){a&&("string"===typeof a?(a=a.split(" "),this._font.name=1===a.length?a[0]:a.slice(1).join(" "),this._font.size=2<=a.length?parseInt(a[0],10):b.fonts[this._font.name].size):
(this._font.name=a.name,this._font.size="number"===typeof a.size?a.size:parseInt(a.size,10)),this.dirty=!0)}},{key:"text",get:function(){return this._text},set:function(a){a=a.toString()||" ";this._text!==a&&(this._text=a,this.dirty=!0)}}]);return b}(h.Container);d["default"]=a;a.fonts={}},{"../core":62,"../core/math/ObservablePoint":65}],124:[function(a,b,d){function f(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);
a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}d.__esModule=!0;var k=function(){function a(b,g){for(var c=0;c<g.length;c++){var d=g[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(b,d.key,d)}}return function(b,g,c){g&&a(b.prototype,g);c&&a(b,c);return b}}(),n=function(a){if(a&&a.__esModule)return a;var b={};if(null!=
a)for(var g in a)Object.prototype.hasOwnProperty.call(a,g)&&(b[g]=a[g]);b["default"]=a;return b}(a("../core"));a=function(a){function b(g){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var c;c=a.call(this,g[0]instanceof n.Texture?g[0]:g[0].texture);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");c=!c||"object"!==typeof c&&"function"!==typeof c?this:c;c._textures=null;c._durations=null;c.textures=g;c.animationSpeed=1;
c.loop=!0;c.onComplete=null;c.onFrameChange=null;c._currentTime=0;c.playing=!1;return c}f(b,a);b.prototype.stop=function(){this.playing&&(this.playing=!1,n.ticker.shared.remove(this.update,this))};b.prototype.play=function(){this.playing||(this.playing=!0,n.ticker.shared.add(this.update,this))};b.prototype.gotoAndStop=function(a){this.stop();var b=this.currentFrame;this._currentTime=a;if(b!==this.currentFrame&&(this._texture=this._textures[this.currentFrame],this._textureID=-1,this.onFrameChange))this.onFrameChange(this.currentFrame)};
b.prototype.gotoAndPlay=function(a){this._currentTime=a;this.play()};b.prototype.update=function(a){var b=this.animationSpeed*a,e=this.currentFrame;if(null!==this._durations){for(var d=this._currentTime%1*this._durations[this.currentFrame],d=d+b/60*1E3;0>d;)this._currentTime--,d+=this._durations[this.currentFrame];a=Math.sign(this.animationSpeed*a);for(this._currentTime=Math.floor(this._currentTime);d>=this._durations[this.currentFrame];)d-=this._durations[this.currentFrame]*a,this._currentTime+=
a;this._currentTime+=d/this._durations[this.currentFrame]}else this._currentTime+=b;if(0>this._currentTime&&!this.loop){if(this.gotoAndStop(0),this.onComplete)this.onComplete()}else if(this._currentTime>=this._textures.length&&!this.loop){if(this.gotoAndStop(this._textures.length-1),this.onComplete)this.onComplete()}else if(e!==this.currentFrame&&(this._texture=this._textures[this.currentFrame],this._textureID=-1,this.onFrameChange))this.onFrameChange(this.currentFrame)};b.prototype.destroy=function(){this.stop();
a.prototype.destroy.call(this)};b.fromFrames=function(a){for(var c=[],d=0;d<a.length;++d)c.push(n.Texture.fromFrame(a[d]));return new b(c)};b.fromImages=function(a){for(var c=[],d=0;d<a.length;++d)c.push(n.Texture.fromImage(a[d]));return new b(c)};k(b,[{key:"totalFrames",get:function(){return this._textures.length}},{key:"textures",get:function(){return this._textures},set:function(a){if(a[0]instanceof n.Texture)this._textures=a,this._durations=null;else{this._textures=[];this._durations=[];for(var b=
0;b<a.length;b++)this._textures.push(a[b].texture),this._durations.push(a[b].time)}}},{key:"currentFrame",get:function(){var a=Math.floor(this._currentTime)%this._textures.length;0>a&&(a+=this._textures.length);return a}}]);return b}(n.Sprite);d["default"]=a},{"../core":62}],125:[function(a,b,d){d.__esModule=!0;var f=function(){function a(b,g){for(var c=0;c<g.length;c++){var d=g[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(b,d.key,d)}}return function(b,
g,c){g&&a(b.prototype,g);c&&a(b,c);return b}}(),k=(a=a("../core/math/Matrix"))&&a.__esModule?a:{"default":a},n=new k["default"];a=function(){function a(b,g){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this._texture=b;this.mapCoord=new k["default"];this.uClampFrame=new Float32Array(4);this.uClampOffset=new Float32Array(2);this._lastTextureID=-1;this.clampOffset=0;this.clampMargin="undefined"===typeof g?.5:g}a.prototype.update=function(a){var b=this.texture;if(b&&
b.valid&&(a||this._lastTextureID!==this.texture._updateID)){this._lastTextureID=this.texture._updateID;a=this.texture._uvs;this.mapCoord.set(a.x1-a.x0,a.y1-a.y0,a.x3-a.x0,a.y3-a.y0,a.x0,a.y0);a=b.orig;var c=b.trim;c&&(n.set(a.width/c.width,0,0,a.height/c.height,-c.x/c.width,-c.y/c.height),this.mapCoord.append(n));a=b.baseTexture;var c=this.uClampFrame,d=this.clampMargin/a.resolution,f=this.clampOffset;c[0]=(b._frame.x+d+f)/a.width;c[1]=(b._frame.y+d+f)/a.height;c[2]=(b._frame.x+b._frame.width-d+f)/
a.width;c[3]=(b._frame.y+b._frame.height-d+f)/a.height;this.uClampOffset[0]=f/a.realWidth;this.uClampOffset[1]=f/a.realHeight}};f(a,[{key:"texture",get:function(){return this._texture},set:function(a){this._texture=a;this._lastTextureID=-1}}]);return a}();d["default"]=a},{"../core/math/Matrix":64}],126:[function(a,b,d){function f(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,
{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}d.__esModule=!0;var k=function(){function a(b,c){for(var e=0;e<c.length;e++){var g=c[e];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(b,g.key,g)}}return function(b,e,g){e&&a(b.prototype,e);g&&a(b,g);return b}}(),n=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var e in a)Object.prototype.hasOwnProperty.call(a,
e)&&(b[e]=a[e]);b["default"]=a;return b}(a("../core")),h=(b=a("../core/sprites/canvas/CanvasTinter"))&&b.__esModule?b:{"default":b},e=(a=a("./TextureTransform"))&&a.__esModule?a:{"default":a},g=new n.Point;a=function(a){function b(g){var d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:100,f=2<arguments.length&&void 0!==arguments[2]?arguments[2]:100;if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var h;h=a.call(this,g);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
h=!h||"object"!==typeof h&&"function"!==typeof h?this:h;h.tileTransform=new n.TransformStatic;h._width=d;h._height=f;h._canvasPattern=null;h.uvTransform=g.transform||new e["default"](g);return h}f(b,a);b.prototype._onTextureUpdate=function(){this.uvTransform&&(this.uvTransform.texture=this._texture)};b.prototype._renderWebGL=function(a){var b=this._texture;b&&b.valid&&(this.tileTransform.updateLocalTransform(),this.uvTransform.update(),a.setObjectRenderer(a.plugins.tilingSprite),a.plugins.tilingSprite.render(this))};
b.prototype._renderCanvas=function(a){var b=this._texture;if(b.baseTexture.hasLoaded){var c=a.context,e=this.worldTransform,g=a.resolution,d=b.baseTexture,f=b.baseTexture.resolution,k=this.tilePosition.x/this.tileScale.x%b._frame.width,p=this.tilePosition.y/this.tileScale.y%b._frame.height;if(!this._canvasPattern){var m=new n.CanvasRenderTarget(b._frame.width,b._frame.height,f);16777215!==this.tint?(this.cachedTint!==this.tint&&(this.cachedTint=this.tint,this.tintedTexture=h["default"].getTintedTexture(this,
this.tint)),m.context.drawImage(this.tintedTexture,0,0)):m.context.drawImage(d.source,-b._frame.x,-b._frame.y);this._canvasPattern=m.context.createPattern(m.canvas,"repeat")}c.globalAlpha=this.worldAlpha;c.setTransform(e.a*g,e.b*g,e.c*g,e.d*g,e.tx*g,e.ty*g);c.scale(this.tileScale.x/f,this.tileScale.y/f);c.translate(k+this.anchor.x*-this._width,p+this.anchor.y*-this._height);b=a.blendModes[this.blendMode];b!==a.context.globalCompositeOperation&&(c.globalCompositeOperation=b);c.fillStyle=this._canvasPattern;
c.fillRect(-k,-p,this._width/this.tileScale.x*f,this._height/this.tileScale.y*f)}};b.prototype._calculateBounds=function(){this._bounds.addFrame(this.transform,this._width*-this._anchor._x,this._height*-this._anchor._y,this._width*(1-this._anchor._x),this._height*(1-this._anchor._y))};b.prototype.getLocalBounds=function(b){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),
this._bounds.maxY=this._height*(1-this._anchor._x),b||(this._localBoundsRect||(this._localBoundsRect=new n.Rectangle),b=this._localBoundsRect),this._bounds.getRectangle(b)):a.prototype.getLocalBounds.call(this,b)};b.prototype.containsPoint=function(a){this.worldTransform.applyInverse(a,g);var b=this._width;a=this._height;var c=-b*this.anchor._x;return g.x>c&&g.x<c+b&&(b=-a*this.anchor._y,g.y>b&&g.y<b+a)?!0:!1};b.prototype.destroy=function(){a.prototype.destroy.call(this);this.uvTransform=this.tileTransform=
null};b.from=function(a,c,e){return new b(n.Texture.from(a),c,e)};b.fromFrame=function(a,c,e){var g=n.utils.TextureCache[a];if(!g)throw Error('The frameId "'+a+'" does not exist in the texture cache '+this);return new b(g,c,e)};b.fromImage=function(a,c,e,g,d){return new b(n.Texture.fromImage(a,g,d),c,e)};k(b,[{key:"clampMargin",get:function(){return this.uvTransform.clampMargin},set:function(a){this.uvTransform.clampMargin=a;this.uvTransform.update(!0)}},{key:"tileScale",get:function(){return this.tileTransform.scale},
set:function(a){this.tileTransform.scale.copy(a)}},{key:"tilePosition",get:function(){return this.tileTransform.position},set:function(a){this.tileTransform.position.copy(a)}},{key:"width",get:function(){return this._width},set:function(a){this._width=a}},{key:"height",get:function(){return this._height},set:function(a){this._height=a}}]);return b}(n.Sprite);d["default"]=a},{"../core":62,"../core/sprites/canvas/CanvasTinter":100,"./TextureTransform":125}],127:[function(a,b,d){var f=function(a){if(a&&
a.__esModule)return a;var b={};if(null!=a)for(var g in a)Object.prototype.hasOwnProperty.call(a,g)&&(b[g]=a[g]);b["default"]=a;return b}(a("../core"));a=f.DisplayObject;var k=new f.Matrix;a.prototype._cacheAsBitmap=!1;a.prototype._cacheData=!1;var n=function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.sprite=this.originalFilterArea=this.originalMask=this.originalDestroy=this.originalHitTest=this.originalUpdateTransform=this.originalGetLocalBounds=this.originalCalculateBounds=
this.originalRenderCanvas=this.originalRenderWebGL=null};Object.defineProperties(a.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(a){this._cacheAsBitmap!==a&&((this._cacheAsBitmap=a)?(this._cacheData||(this._cacheData=new n),a=this._cacheData,a.originalRenderWebGL=this.renderWebGL,a.originalRenderCanvas=this.renderCanvas,a.originalUpdateTransform=this.updateTransform,a.originalCalculateBounds=this._calculateBounds,a.originalGetLocalBounds=this.getLocalBounds,a.originalDestroy=
this.destroy,a.originalContainsPoint=this.containsPoint,a.originalMask=this._mask,a.originalFilterArea=this.filterArea,this.renderWebGL=this._renderCachedWebGL,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(a=this._cacheData,a.sprite&&this._destroyCachedDisplayObject(),this.renderWebGL=a.originalRenderWebGL,this.renderCanvas=a.originalRenderCanvas,this._calculateBounds=a.originalCalculateBounds,this.getLocalBounds=a.originalGetLocalBounds,this.destroy=a.originalDestroy,
this.updateTransform=a.originalUpdateTransform,this.containsPoint=a.originalContainsPoint,this._mask=a.originalMask,this.filterArea=a.originalFilterArea))}}});a.prototype._renderCachedWebGL=function(a){!this.visible||0>=this.worldAlpha||!this.renderable||(this._initCachedDisplayObject(a),this._cacheData.sprite._transformID=-1,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderWebGL(a))};a.prototype._initCachedDisplayObject=function(a){if(!this._cacheData||!this._cacheData.sprite){var b=
this.alpha;this.alpha=1;a.currentRenderer.flush();var c=this.getLocalBounds().clone();this._filters&&c.pad(this._filters[0].padding);var d=a._activeRenderTarget,n=a.filterManager.filterStack,m=f.RenderTexture.create(c.width|0,c.height|0);k.tx=-c.x;k.ty=-c.y;this.transform.worldTransform.identity();this.renderWebGL=this._cacheData.originalRenderWebGL;a.render(this,m,!0,k,!0);a.bindRenderTarget(d);a.filterManager.filterStack=n;this.renderWebGL=this._renderCachedWebGL;this.updateTransform=this.displayObjectUpdateTransform;
this.filterArea=this._mask=null;a=new f.Sprite(m);a.transform.worldTransform=this.transform.worldTransform;a.anchor.x=-(c.x/c.width);a.anchor.y=-(c.y/c.height);a.alpha=b;a._bounds=this._bounds;this._calculateBounds=this._calculateCachedBounds;this.getLocalBounds=this._getCachedLocalBounds;this._cacheData.sprite=a;this.transform._parentID=-1;this.updateTransform();this.containsPoint=a.containsPoint.bind(a)}};a.prototype._renderCachedCanvas=function(a){!this.visible||0>=this.worldAlpha||!this.renderable||
(this._initCachedDisplayObjectCanvas(a),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite.renderCanvas(a))};a.prototype._initCachedDisplayObjectCanvas=function(a){if(!this._cacheData||!this._cacheData.sprite){var b=this.getLocalBounds(),c=this.alpha;this.alpha=1;var d=a.context,n=f.RenderTexture.create(b.width|0,b.height|0);this.transform.worldTransform.copy(k);k.invert();k.tx-=b.x;k.ty-=b.y;this.renderCanvas=this._cacheData.originalRenderCanvas;a.render(this,n,!0,k,!1);a.context=
d;this.renderCanvas=this._renderCachedCanvas;this._calculateBounds=this._calculateCachedBounds;this.filterArea=this._mask=null;a=new f.Sprite(n);a.transform.worldTransform=this.transform.worldTransform;a.anchor.x=-(b.x/b.width);a.anchor.y=-(b.y/b.height);a._bounds=this._bounds;a.alpha=c;this.updateTransform();this.updateTransform=this.displayObjectUpdateTransform;this._cacheData.sprite=a;this.containsPoint=a.containsPoint.bind(a)}};a.prototype._calculateCachedBounds=function(){this._cacheData.sprite._calculateBounds()};
a.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds()};a.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0);this._cacheData.sprite=null};a.prototype._cacheAsBitmapDestroy=function(){this.cacheAsBitmap=!1;this.destroy()}},{"../core":62}],128:[function(a,b,d){a=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b["default"]=a;return b}(a("../core"));
a.DisplayObject.prototype.name=null;a.Container.prototype.getChildByName=function(a){for(var b=0;b<this.children.length;b++)if(this.children[b].name===a)return this.children[b];return null}},{"../core":62}],129:[function(a,b,d){var f=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b["default"]=a;return b}(a("../core"));f.DisplayObject.prototype.getGlobalPosition=function(){var a=0<arguments.length&&void 0!==arguments[0]?
arguments[0]:new f.Point,b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!1;this.parent?this.parent.toGlobal(this.position,a,b):(a.x=this.position.x,a.y=this.position.y);return a}},{"../core":62}],130:[function(a,b,d){function f(a){return a&&a.__esModule?a:{"default":a}}d.__esModule=!0;var k=a("./TextureTransform");Object.defineProperty(d,"TextureTransform",{enumerable:!0,get:function(){return f(k)["default"]}});var n=a("./MovieClip");Object.defineProperty(d,"MovieClip",{enumerable:!0,get:function(){return f(n)["default"]}});
var h=a("./TilingSprite");Object.defineProperty(d,"TilingSprite",{enumerable:!0,get:function(){return f(h)["default"]}});var e=a("./webgl/TilingSpriteRenderer");Object.defineProperty(d,"TilingSpriteRenderer",{enumerable:!0,get:function(){return f(e)["default"]}});var g=a("./BitmapText");Object.defineProperty(d,"BitmapText",{enumerable:!0,get:function(){return f(g)["default"]}});var c=a("./cacheAsBitmap");Object.defineProperty(d,"cacheAsBitmap",{enumerable:!0,get:function(){return f(c)["default"]}});
var p=a("./getChildByName");Object.defineProperty(d,"getChildByName",{enumerable:!0,get:function(){return f(p)["default"]}});var y=a("./getGlobalPosition");Object.defineProperty(d,"getGlobalPosition",{enumerable:!0,get:function(){return f(y)["default"]}})},{"./BitmapText":123,"./MovieClip":124,"./TextureTransform":125,"./TilingSprite":126,"./cacheAsBitmap":127,"./getChildByName":128,"./getGlobalPosition":129,"./webgl/TilingSpriteRenderer":131}],131:[function(a,b,d){function f(a,b){if("function"!==
typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}d.__esModule=!0;d.TilingSpriteRenderer=void 0;var k=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(b[e]=a[e]);b["default"]=a;return b}(a("../../core")),
n=a("../../core/const"),h=new k.Matrix,e=new Float32Array(4);a=d.TilingSpriteRenderer=function(a){function b(e){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");e=a.call(this,e);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");e=!e||"object"!==typeof e&&"function"!==typeof e?this:e;e.shader=null;e.simpleShader=null;e.quad=null;return e}f(b,a);b.prototype.onContextChange=function(){var a=this.renderer.gl;this.shader=new k.Shader(a,
"#define GLSLIFY 1\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","#define GLSLIFY 1\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = mod(vTextureCoord - uClampOffset, vec2(1.0, 1.0)) + uClampOffset;\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 sample = texture2D(uSampler, coord);\n    vec4 color = vec4(uColor.rgb * uColor.a, uColor.a);\n\n    gl_FragColor = sample * color ;\n}\n");
this.simpleShader=new k.Shader(a,"#define GLSLIFY 1\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","#define GLSLIFY 1\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 sample = texture2D(uSampler, vTextureCoord);\n    vec4 color = vec4(uColor.rgb * uColor.a, uColor.a);\n    gl_FragColor = sample * color;\n}\n");
this.quad=new k.Quad(a);this.quad.initVao(this.shader)};b.prototype.render=function(a){var b=this.quad,c=b.vertices;c[0]=c[6]=a._width*-a.anchor.x;c[1]=c[3]=a._height*-a.anchor.y;c[2]=c[4]=a._width*(1-a.anchor.x);c[5]=c[7]=a._height*(1-a.anchor.y);c=b.uvs;c[0]=c[6]=-a.anchor.x;c[1]=c[3]=-a.anchor.y;c[2]=c[4]=1-a.anchor.x;c[5]=c[7]=1-a.anchor.y;b.upload();var c=this.renderer,g=a._texture,d=g.baseTexture,f=a.tileTransform.localTransform,m=a.uvTransform,r=d.isPowerOfTwo&&g.frame.width===d.width&&g.frame.height===
d.height;r&&(d._glTextures[c.CONTEXT_UID]?r=d.wrapMode!==n.WRAP_MODES.CLAMP:d.wrapMode===n.WRAP_MODES.CLAMP&&(d.wrapMode=n.WRAP_MODES.REPEAT));d=r?this.simpleShader:this.shader;c.bindShader(d);var x=g.width,u=g.height,w=a._width,B=a._height;h.set(f.a*x/w,f.b*x/B,f.c*u/w,f.d*u/B,f.tx/w,f.ty/B);h.invert();r?h.append(m.mapCoord):(d.uniforms.uMapCoord=m.mapCoord.toArray(!0),d.uniforms.uClampFrame=m.uClampFrame,d.uniforms.uClampOffset=m.uClampOffset);d.uniforms.uTransform=h.toArray(!0);k.utils.hex2rgb(a.tint,
e);e[3]=a.worldAlpha;d.uniforms.uColor=e;d.uniforms.translationMatrix=a.transform.worldTransform.toArray(!0);c.bindTexture(g);c.setBlendMode(a.blendMode);b.draw()};return b}(k.ObjectRenderer);k.WebGLRenderer.registerPlugin("tilingSprite",a)},{"../../core":62,"../../core/const":43}],132:[function(a,b,d){function f(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,
enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}d.__esModule=!0;var k=function(){function a(b,e){for(var d=0;d<e.length;d++){var g=e[d];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(b,g.key,g)}}return function(b,e,d){e&&a(b.prototype,e);d&&a(b,d);return b}}();b=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(b[e]=
a[e]);b["default"]=a;return b}(a("../../core"));var n=a("./BlurXFilter"),h=n&&n.__esModule?n:{"default":n},e=(a=a("./BlurYFilter"))&&a.__esModule?a:{"default":a};a=function(a){function b(d,f,n){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var k;k=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");k=!k||"object"!==typeof k&&"function"!==typeof k?this:k;k.blurXFilter=new h["default"];k.blurYFilter=new e["default"];
k.resolution=1;k.padding=0;k.resolution=n||1;k.quality=f||4;k.blur=d||8;return k}f(b,a);b.prototype.apply=function(a,b,c){var e=a.getRenderTarget(!0);this.blurXFilter.apply(a,b,e,!0);this.blurYFilter.apply(a,e,c,!1);a.returnRenderTarget(e)};k(b,[{key:"blur",get:function(){return this.blurXFilter.blur},set:function(a){this.blurXFilter.blur=this.blurYFilter.blur=a;this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}},{key:"quality",get:function(){return this.blurXFilter.quality},
set:function(a){this.blurXFilter.quality=this.blurYFilter.quality=a}},{key:"blurX",get:function(){return this.blurXFilter.blur},set:function(a){this.blurXFilter.blur=a;this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}},{key:"blurY",get:function(){return this.blurYFilter.blur},set:function(a){this.blurYFilter.blur=a;this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}}]);return b}(b.Filter);d["default"]=a},
{"../../core":62,"./BlurXFilter":133,"./BlurYFilter":134}],133:[function(a,b,d){function f(a){return a&&a.__esModule?a:{"default":a}}function k(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}d.__esModule=!0;var n=function(){function a(b,c){for(var e=
0;e<c.length;e++){var d=c[e];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(b,d.key,d)}}return function(b,c,e){c&&a(b.prototype,c);e&&a(b,e);return b}}();b=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b["default"]=a;return b}(a("../../core"));var h=a("./generateBlurVertSource"),e=f(h),h=a("./generateBlurFragSource"),g=f(h);a=a("./getMaxBlurKernelSize");var c=f(a);
a=function(a){function b(c,d,f){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var h=(0,e["default"])(5,!0),n=(0,g["default"])(5),h=a.call(this,h,n);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");h=!h||"object"!==typeof h&&"function"!==typeof h?this:h;h.resolution=f||1;h._quality=0;h.quality=d||4;h.strength=c||8;h.firstRun=!0;return h}k(b,a);b.prototype.apply=function(a,b,d,f){if(this.firstRun){var h=a.renderer.gl,h=
(0,c["default"])(h);this.vertexSrc=(0,e["default"])(h,!0);this.fragmentSrc=(0,g["default"])(h);this.firstRun=!1}this.uniforms.strength=1/d.size.width*(d.size.width/b.size.width);this.uniforms.strength*=this.strength;this.uniforms.strength/=this.passes;if(1===this.passes)a.applyFilter(this,b,d,f);else{for(var n=h=a.getRenderTarget(!0),k=0;k<this.passes-1;k++){a.applyFilter(this,b,n,!0);var m=n,n=b;b=m}a.applyFilter(this,b,d,f);a.returnRenderTarget(h)}};n(b,[{key:"blur",get:function(){return this.strength},
set:function(a){this.padding=2*Math.abs(a);this.strength=a}},{key:"quality",get:function(){return this._quality},set:function(a){this.passes=this._quality=a}}]);return b}(b.Filter);d["default"]=a},{"../../core":62,"./generateBlurFragSource":135,"./generateBlurVertSource":136,"./getMaxBlurKernelSize":137}],134:[function(a,b,d){function f(a){return a&&a.__esModule?a:{"default":a}}function k(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+
typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}d.__esModule=!0;var n=function(){function a(b,c){for(var e=0;e<c.length;e++){var d=c[e];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(b,d.key,d)}}return function(b,c,e){c&&a(b.prototype,c);e&&a(b,e);return b}}();b=function(a){if(a&&a.__esModule)return a;var b={};
if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b["default"]=a;return b}(a("../../core"));var h=a("./generateBlurVertSource"),e=f(h),h=a("./generateBlurFragSource"),g=f(h);a=a("./getMaxBlurKernelSize");var c=f(a);a=function(a){function b(c,d,f){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var h=(0,e["default"])(5,!1),n=(0,g["default"])(5),h=a.call(this,h,n);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
h=!h||"object"!==typeof h&&"function"!==typeof h?this:h;h.resolution=f||1;h._quality=0;h.quality=d||4;h.strength=c||8;h.firstRun=!0;return h}k(b,a);b.prototype.apply=function(a,b,d,h){if(this.firstRun){var f=a.renderer.gl,f=(0,c["default"])(f);this.vertexSrc=(0,e["default"])(f,!1);this.fragmentSrc=(0,g["default"])(f);this.firstRun=!1}this.uniforms.strength=1/d.size.height*(d.size.height/b.size.height);this.uniforms.strength*=this.strength;this.uniforms.strength/=this.passes;if(1===this.passes)a.applyFilter(this,
b,d,h);else{for(var n=f=a.getRenderTarget(!0),k=0;k<this.passes-1;k++){a.applyFilter(this,b,n,!0);var m=n,n=b;b=m}a.applyFilter(this,b,d,h);a.returnRenderTarget(f)}};n(b,[{key:"blur",get:function(){return this.strength},set:function(a){this.padding=2*Math.abs(a);this.strength=a}},{key:"quality",get:function(){return this._quality},set:function(a){this.passes=this._quality=a}}]);return b}(b.Filter);d["default"]=a},{"../../core":62,"./generateBlurFragSource":135,"./generateBlurVertSource":136,"./getMaxBlurKernelSize":137}],
135:[function(a,b,d){d.__esModule=!0;d["default"]=function(a){for(var b=f[a],e=b.length,d=k,c="",m,y=0;y<a;y++){var q="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",y);m=y;y>=e&&(m=a-y-1);q=q.replace("%value%",b[m]);c+=q;c+="\n"}d=d.replace("%blur%",c);return d=d.replace("%size%",a)};var f={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,
.009255,.027867,.065666,.121117,.174868,.197641],15:[4.89E-4,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},k="varying vec2 vBlurTexCoords[%size%];\nuniform sampler2D uSampler;\nvoid main(void)\n{\n    gl_FragColor = vec4(0.0);\n    %blur%\n}"},{}],136:[function(a,b,d){d.__esModule=!0;d["default"]=function(a,b){var d=Math.ceil(a/2),e=f,g="",c;c=b?"vBlurTexCoords[%index%] = aTextureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] = aTextureCoord + vec2(0.0, %sampleIndex% * strength);";
for(var m=0;m<a;m++)var y=c.replace("%index%",m),y=y.replace("%sampleIndex%",m-(d-1)+".0"),g=g+y,g=g+"\n";e=e.replace("%blur%",g);return e=e.replace("%size%",a)};var f="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nuniform float strength;\nuniform mat3 projectionMatrix;\nvarying vec2 vBlurTexCoords[%size%];\nvoid main(void)\n{\ngl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);\n%blur%\n}"},{}],137:[function(a,b,d){d.__esModule=!0;d["default"]=function(a){a=
a.getParameter(a.MAX_VARYING_VECTORS);for(var b=15;b>a;)b-=2;return b}},{}],138:[function(a,b,d){function f(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}d.__esModule=!0;var k=function(){function a(b,e){for(var d=0;d<e.length;d++){var c=e[d];
c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(b,c.key,c)}}return function(b,e,d){e&&a(b.prototype,e);d&&a(b,d);return b}}();a=function(a){function b(){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var e;e=a.call(this,"#define GLSLIFY 1\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",
"#define GLSLIFY 1\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\n\nvoid main(void)\n{\n\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    gl_FragColor.r = (m[0] * c.r);\n        gl_FragColor.r += (m[1] * c.g);\n        gl_FragColor.r += (m[2] * c.b);\n        gl_FragColor.r += (m[3] * c.a);\n        gl_FragColor.r += m[4] * c.a;\n\n    gl_FragColor.g = (m[5] * c.r);\n        gl_FragColor.g += (m[6] * c.g);\n        gl_FragColor.g += (m[7] * c.b);\n        gl_FragColor.g += (m[8] * c.a);\n        gl_FragColor.g += m[9] * c.a;\n\n     gl_FragColor.b = (m[10] * c.r);\n        gl_FragColor.b += (m[11] * c.g);\n        gl_FragColor.b += (m[12] * c.b);\n        gl_FragColor.b += (m[13] * c.a);\n        gl_FragColor.b += m[14] * c.a;\n\n     gl_FragColor.a = (m[15] * c.r);\n        gl_FragColor.a += (m[16] * c.g);\n        gl_FragColor.a += (m[17] * c.b);\n        gl_FragColor.a += (m[18] * c.a);\n        gl_FragColor.a += m[19] * c.a;\n\n//    gl_FragColor = vec4(m[0]);\n}\n");
if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");e=!e||"object"!==typeof e&&"function"!==typeof e?this:e;e.uniforms.m=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];return e}f(b,a);b.prototype._loadMatrix=function(a){var b=a;1<arguments.length&&void 0!==arguments[1]&&arguments[1]&&(this._multiply(b,this.uniforms.m,a),b=this._colorMatrix(b));this.uniforms.m=b};b.prototype._multiply=function(a,b,c){a[0]=b[0]*c[0]+b[1]*c[5]+b[2]*c[10]+b[3]*c[15];a[1]=b[0]*c[1]+
b[1]*c[6]+b[2]*c[11]+b[3]*c[16];a[2]=b[0]*c[2]+b[1]*c[7]+b[2]*c[12]+b[3]*c[17];a[3]=b[0]*c[3]+b[1]*c[8]+b[2]*c[13]+b[3]*c[18];a[4]=b[0]*c[4]+b[1]*c[9]+b[2]*c[14]+b[3]*c[19];a[5]=b[5]*c[0]+b[6]*c[5]+b[7]*c[10]+b[8]*c[15];a[6]=b[5]*c[1]+b[6]*c[6]+b[7]*c[11]+b[8]*c[16];a[7]=b[5]*c[2]+b[6]*c[7]+b[7]*c[12]+b[8]*c[17];a[8]=b[5]*c[3]+b[6]*c[8]+b[7]*c[13]+b[8]*c[18];a[9]=b[5]*c[4]+b[6]*c[9]+b[7]*c[14]+b[8]*c[19];a[10]=b[10]*c[0]+b[11]*c[5]+b[12]*c[10]+b[13]*c[15];a[11]=b[10]*c[1]+b[11]*c[6]+b[12]*c[11]+b[13]*
c[16];a[12]=b[10]*c[2]+b[11]*c[7]+b[12]*c[12]+b[13]*c[17];a[13]=b[10]*c[3]+b[11]*c[8]+b[12]*c[13]+b[13]*c[18];a[14]=b[10]*c[4]+b[11]*c[9]+b[12]*c[14]+b[13]*c[19];a[15]=b[15]*c[0]+b[16]*c[5]+b[17]*c[10]+b[18]*c[15];a[16]=b[15]*c[1]+b[16]*c[6]+b[17]*c[11]+b[18]*c[16];a[17]=b[15]*c[2]+b[16]*c[7]+b[17]*c[12]+b[18]*c[17];a[18]=b[15]*c[3]+b[16]*c[8]+b[17]*c[13]+b[18]*c[18];a[19]=b[15]*c[4]+b[16]*c[9]+b[17]*c[14]+b[18]*c[19];return a};b.prototype._colorMatrix=function(a){a=new Float32Array(a);a[4]/=255;
a[9]/=255;a[14]/=255;a[19]/=255;return a};b.prototype.brightness=function(a,b){this._loadMatrix([a,0,0,0,0,0,a,0,0,0,0,0,a,0,0,0,0,0,1,0],b)};b.prototype.greyscale=function(a,b){this._loadMatrix([a,a,a,0,0,a,a,a,0,0,a,a,a,0,0,0,0,0,1,0],b)};b.prototype.blackAndWhite=function(a){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],a)};b.prototype.hue=function(a,b){a=(a||0)/180*Math.PI;var c=Math.cos(a),d=Math.sin(a),f=Math.sqrt,h=1/3,f=f(h);this._loadMatrix([c+(1-c)*h,h*(1-c)-f*d,h*
(1-c)+f*d,0,0,h*(1-c)+f*d,c+h*(1-c),h*(1-c)-f*d,0,0,h*(1-c)-f*d,h*(1-c)+f*d,c+h*(1-c),0,0,0,0,0,1,0],b)};b.prototype.contrast=function(a,b){var c=(a||0)+1,d=-128*(c-1);this._loadMatrix([c,0,0,0,d,0,c,0,0,d,0,0,c,0,d,0,0,0,1,0],b)};b.prototype.saturate=function(){var a=2*(0<arguments.length&&void 0!==arguments[0]?arguments[0]:0)/3+1,b=-.5*(a-1);this._loadMatrix([a,b,b,0,0,b,a,b,0,0,b,b,a,0,0,0,0,0,1,0],arguments[1])};b.prototype.desaturate=function(){this.saturate(-1)};b.prototype.negative=function(a){this._loadMatrix([0,
1,1,0,0,1,0,1,0,0,1,1,0,0,0,0,0,0,1,0],a)};b.prototype.sepia=function(a){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],a)};b.prototype.technicolor=function(a){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],a)};b.prototype.polaroid=
function(a){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],a)};b.prototype.toBGR=function(a){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],a)};b.prototype.kodachrome=function(a){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,
0],a)};b.prototype.browni=function(a){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],a)};b.prototype.vintage=function(a){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,
.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],a)};b.prototype.colorTone=function(a,b,c,d,f){c=c||16770432;d=d||3375104;var h=(c>>16&255)/255,n=(c>>8&255)/255;c=(c&255)/255;var k=(d>>16&255)/255,m=(d>>8&255)/255;d=(d&255)/255;this._loadMatrix([.3,.59,.11,0,0,h,n,c,a||.2,0,k,m,d,b||.15,0,h-k,n-m,c-d,0,0],f)};b.prototype.night=function(a,b){a=a||.1;this._loadMatrix([-2*a,-a,0,0,0,-a,0,a,0,0,0,a,2*a,0,0,0,0,0,1,0],b)};b.prototype.predator=function(a,b){this._loadMatrix([11.224130630493164*
a,-4.794486999511719*a,-2.8746118545532227*a,0*a,.40342438220977783*a,-3.6330697536468506*a,9.193157196044922*a,-2.951810836791992*a,0*a,-1.316135048866272*a,-3.2184197902679443*a,-4.2375030517578125*a,7.476448059082031*a,0*a,.8044459223747253*a,0,0,0,1,0],b)};b.prototype.lsd=function(a){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],a)};b.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)};k(b,[{key:"matrix",get:function(){return this.uniforms.m},
set:function(a){this.uniforms.m=a}}]);return b}(function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(b[e]=a[e]);b["default"]=a;return b}(a("../../core")).Filter);d["default"]=a;a.prototype.grayscale=a.prototype.greyscale},{"../../core":62}],139:[function(a,b,d){function f(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,
{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}d.__esModule=!0;var k=function(){function a(b,d){for(var c=0;c<d.length;c++){var f=d[c];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(b,f.key,f)}}return function(b,d,c){d&&a(b.prototype,d);c&&a(b,c);return b}}(),n=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,
d)&&(b[d]=a[d]);b["default"]=a;return b}(a("../../core"));a=function(a){function b(d,c){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var f=new n.Matrix;d.renderable=!1;var k;k=a.call(this,"#define GLSLIFY 1\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nvoid main(void)\n{\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vFilterCoord = ( filterMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n   vTextureCoord = aTextureCoord;\n}",
"#define GLSLIFY 1\nvarying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\n\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform vec4 filterClamp;\n\nvoid main(void)\n{\n   vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n   map -= 0.5;\n   map.xy *= scale;\n\n   gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), filterClamp.xy, filterClamp.zw));\n}\n");if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
k=!k||"object"!==typeof k&&"function"!==typeof k?this:k;k.maskSprite=d;k.maskMatrix=f;k.uniforms.mapSampler=d.texture;k.uniforms.filterMatrix=f.toArray(!0);k.uniforms.scale={x:1,y:1};if(null===c||void 0===c)c=20;k.scale=new n.Point(c,c);return k}f(b,a);b.prototype.apply=function(a,b,e){var d=1/e.destinationFrame.width*(e.size.width/b.size.width);this.uniforms.filterMatrix=a.calculateSpriteMatrix(this.maskMatrix,this.maskSprite);this.uniforms.scale.x=this.scale.x*d;this.uniforms.scale.y=this.scale.y*
d;a.applyFilter(this,b,e)};k(b,[{key:"map",get:function(){return this.uniforms.mapSampler},set:function(a){this.uniforms.mapSampler=a}}]);return b}(n.Filter);d["default"]=a},{"../../core":62}],140:[function(a,b,d){function f(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,
b):a.__proto__=b)}d.__esModule=!0;a=function(a){function b(){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var d=a.call(this,"#define GLSLIFY 1\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nuniform vec4 filterArea;\n\nvarying vec2 vTextureCoord;\n\nvec2 mapCoord( vec2 coord )\n{\n    coord *= filterArea.xy;\n    coord += filterArea.zw;\n\n    return coord;\n}\n\nvec2 unmapCoord( vec2 coord )\n{\n    coord -= filterArea.zw;\n    coord /= filterArea.xy;\n\n    return coord;\n}\n\nvoid texcoords(vec2 fragCoord, vec2 resolution,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    vec2 inverseVP = 1.0 / resolution.xy;\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n   vTextureCoord = aTextureCoord;\n\n   vec2 fragCoord = vTextureCoord * filterArea.xy;\n\n   texcoords(fragCoord, filterArea.xy, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}",
'#define GLSLIFY 1\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n \n --\n \n From:\n https://github.com/mitsuhiko/webgl-meincraft\n \n Copyright (c) 2011 by Armin Ronacher.\n \n Some rights reserved.\n \n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n \n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n \n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n \n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n \n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 resolution,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    mediump vec2 inverseVP = vec2(1.0 / resolution.x, 1.0 / resolution.y);\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n    \n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n    \n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n    \n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n    \n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n    \n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec2 fragCoord = vTextureCoord * filterArea.xy;\n\n      vec4 color;\n\n    color = fxaa(uSampler, fragCoord, filterArea.xy, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n');
if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!d||"object"!==typeof d&&"function"!==typeof d?this:d}f(b,a);return b}(function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b["default"]=a;return b}(a("../../core")).Filter);d["default"]=a},{"../../core":62}],141:[function(a,b,d){function f(a){return a&&a.__esModule?a:{"default":a}}d.__esModule=!0;var k=a("./fxaa/FXAAFilter");
Object.defineProperty(d,"FXAAFilter",{enumerable:!0,get:function(){return f(k)["default"]}});var n=a("./noise/NoiseFilter");Object.defineProperty(d,"NoiseFilter",{enumerable:!0,get:function(){return f(n)["default"]}});var h=a("./displacement/DisplacementFilter");Object.defineProperty(d,"DisplacementFilter",{enumerable:!0,get:function(){return f(h)["default"]}});var e=a("./blur/BlurFilter");Object.defineProperty(d,"BlurFilter",{enumerable:!0,get:function(){return f(e)["default"]}});var g=a("./blur/BlurXFilter");
Object.defineProperty(d,"BlurXFilter",{enumerable:!0,get:function(){return f(g)["default"]}});var c=a("./blur/BlurYFilter");Object.defineProperty(d,"BlurYFilter",{enumerable:!0,get:function(){return f(c)["default"]}});var p=a("./colormatrix/ColorMatrixFilter");Object.defineProperty(d,"ColorMatrixFilter",{enumerable:!0,get:function(){return f(p)["default"]}});var y=a("./void/VoidFilter");Object.defineProperty(d,"VoidFilter",{enumerable:!0,get:function(){return f(y)["default"]}})},{"./blur/BlurFilter":132,
"./blur/BlurXFilter":133,"./blur/BlurYFilter":134,"./colormatrix/ColorMatrixFilter":138,"./displacement/DisplacementFilter":139,"./fxaa/FXAAFilter":140,"./noise/NoiseFilter":142,"./void/VoidFilter":143}],142:[function(a,b,d){function f(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,
b):a.__proto__=b)}d.__esModule=!0;var k=function(){function a(b,e){for(var d=0;d<e.length;d++){var c=e[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(b,c.key,c)}}return function(b,e,d){e&&a(b.prototype,e);d&&a(b,d);return b}}();a=function(a){function b(){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var e;e=a.call(this,"#define GLSLIFY 1\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",
"precision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float noise;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n\n    float diff = (rand(gl_FragCoord.xy) - 0.5) * noise;\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    gl_FragColor = color;\n}\n");if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
e=!e||"object"!==typeof e&&"function"!==typeof e?this:e;e.noise=.5;return e}f(b,a);k(b,[{key:"noise",get:function(){return this.uniforms.noise},set:function(a){this.uniforms.noise=a}}]);return b}(function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(b[e]=a[e]);b["default"]=a;return b}(a("../../core")).Filter);d["default"]=a},{"../../core":62}],143:[function(a,b,d){function f(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+
typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}d.__esModule=!0;a=function(a){function b(){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var d;d=a.call(this,"#define GLSLIFY 1\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",
"#define GLSLIFY 1\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n");if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");d=!d||"object"!==typeof d&&"function"!==typeof d?this:d;d.glShaderKey="void";return d}f(b,a);return b}(function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b["default"]=
a;return b}(a("../../core")).Filter);d["default"]=a},{"../../core":62}],144:[function(a,b,d){d.__esModule=!0;var f=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b["default"]=a;return b}(a("../core"));a=function(){function a(){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.global=new f.Point;this.originalEvent=this.target=null}a.prototype.getLocalPosition=function(a,b,e){return a.worldTransform.applyInverse(e||
this.global,b)};return a}();d["default"]=a},{"../core":62}],145:[function(a,b,d){d.__esModule=!0;a=function(){function a(){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.stopped=!1;this.data=this.type=this.currentTarget=this.target=null}a.prototype.stopPropagation=function(){this.stopped=!0};a.prototype._reset=function(){this.stopped=!1;this.target=this.currentTarget=null};return a}();d["default"]=a},{}],146:[function(a,b,d){function f(a){return a&&a.__esModule?
a:{"default":a}}function k(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}d.__esModule=!0;var n=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b["default"]=a;return b}(a("../core"));
b=a("./InteractionData");var h=f(b);b=a("./InteractionEvent");var e=f(b);b=a("eventemitter3");b=f(b);var g=a("./interactiveTarget"),g=f(g);a=a("ismobilejs");var c=f(a);Object.assign(n.DisplayObject.prototype,g["default"]);a=function(a){function b(d,g){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var f;f=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");f=!f||"object"!==typeof f&&"function"!==typeof f?this:
f;g=g||{};f.renderer=d;f.autoPreventDefault=void 0!==g.autoPreventDefault?g.autoPreventDefault:!0;f.interactionFrequency=g.interactionFrequency||10;f.mouse=new h["default"];f.mouse.global.set(-999999);f.pointer=new h["default"];f.pointer.global.set(-999999);f.eventData=new e["default"];f.interactiveDataPool=[];f.interactionDOMElement=null;f.moveWhenInside=!1;f.eventsAdded=!1;f.mouseOverRenderer=!1;f.supportsTouchEvents="ontouchstart"in window;f.supportsPointerEvents=!!window.PointerEvent;f.normalizeTouchEvents=
!f.supportsPointerEvents&&f.supportsTouchEvents;f.normalizeMouseEvents=!f.supportsPointerEvents&&!c["default"].any;f.onMouseUp=f.onMouseUp.bind(f);f.processMouseUp=f.processMouseUp.bind(f);f.onMouseDown=f.onMouseDown.bind(f);f.processMouseDown=f.processMouseDown.bind(f);f.onMouseMove=f.onMouseMove.bind(f);f.processMouseMove=f.processMouseMove.bind(f);f.onMouseOut=f.onMouseOut.bind(f);f.processMouseOverOut=f.processMouseOverOut.bind(f);f.onMouseOver=f.onMouseOver.bind(f);f.onPointerUp=f.onPointerUp.bind(f);
f.processPointerUp=f.processPointerUp.bind(f);f.onPointerDown=f.onPointerDown.bind(f);f.processPointerDown=f.processPointerDown.bind(f);f.onPointerMove=f.onPointerMove.bind(f);f.processPointerMove=f.processPointerMove.bind(f);f.onPointerOut=f.onPointerOut.bind(f);f.processPointerOverOut=f.processPointerOverOut.bind(f);f.onPointerOver=f.onPointerOver.bind(f);f.onTouchStart=f.onTouchStart.bind(f);f.processTouchStart=f.processTouchStart.bind(f);f.onTouchEnd=f.onTouchEnd.bind(f);f.processTouchEnd=f.processTouchEnd.bind(f);
f.onTouchMove=f.onTouchMove.bind(f);f.processTouchMove=f.processTouchMove.bind(f);f.defaultCursorStyle="inherit";f.currentCursorStyle="inherit";f._tempPoint=new n.Point;f.resolution=1;f.setTargetElement(f.renderer.view,f.renderer.resolution);return f}k(b,a);b.prototype.setTargetElement=function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;this.removeEvents();this.interactionDOMElement=a;this.resolution=b;this.addEvents()};b.prototype.addEvents=function(){this.interactionDOMElement&&
(n.ticker.shared.add(this.update,this),window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="none",this.interactionDOMElement.style["-ms-touch-action"]="none"):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]="none"),window.document.addEventListener("mousemove",this.onMouseMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onMouseDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onMouseOut,!0),
this.interactionDOMElement.addEventListener("mouseover",this.onMouseOver,!0),window.addEventListener("mouseup",this.onMouseUp,!0),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onTouchStart,!0),this.interactionDOMElement.addEventListener("touchend",this.onTouchEnd,!0),this.interactionDOMElement.addEventListener("touchmove",this.onTouchMove,!0)),this.supportsPointerEvents?(window.document.addEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("pointerdown",
this.onPointerDown,!0),this.interactionDOMElement.addEventListener("pointerout",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,!0),window.addEventListener("pointerup",this.onPointerUp,!0)):(this.normalizeTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,
!0)),this.normalizeMouseEvents&&(window.document.addEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,!0),window.addEventListener("mouseup",this.onPointerUp,!0))),this.eventsAdded=!0)};b.prototype.removeEvents=function(){this.interactionDOMElement&&(n.ticker.shared.remove(this.update,
this),window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]=""):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]=""),window.document.removeEventListener("mousemove",this.onMouseMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onMouseDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onMouseOut,!0),this.interactionDOMElement.removeEventListener("mouseover",
this.onMouseOver,!0),window.removeEventListener("mouseup",this.onMouseUp,!0),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onTouchStart,!0),this.interactionDOMElement.removeEventListener("touchend",this.onTouchEnd,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onTouchMove,!0)),this.supportsPointerEvents?(window.document.removeEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("pointerdown",
this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("pointerout",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,!0),window.removeEventListener("pointerup",this.onPointerUp,!0)):(this.normalizeTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,
!0)),this.normalizeMouseEvents&&(window.document.removeEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,!0),window.removeEventListener("mouseup",this.onPointerUp,!0))),this.interactionDOMElement=null,this.eventsAdded=!1)};b.prototype.update=function(a){this._deltaTime+=
a;this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this.interactionDOMElement&&(this.didMove?this.didMove=!1:(this.cursor=this.defaultCursorStyle,this.eventData._reset(),this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseOverOut,!0),this.currentCursorStyle!==this.cursor&&(this.currentCursorStyle=this.cursor,this.interactionDOMElement.style.cursor=this.cursor))))};b.prototype.dispatchEvent=function(a,b,c){if(!c.stopped&&(c.currentTarget=a,c.type=
b,a.emit(b,c),a[b]))a[b](c)};b.prototype.mapPositionToPoint=function(a,b,c){var e;e=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:0,height:0};a.x=this.interactionDOMElement.width/e.width*(b-e.left)/this.resolution;a.y=this.interactionDOMElement.height/e.height*(c-e.top)/this.resolution};b.prototype.processInteractive=function(a,b,c,e,d){if(!b||!b.visible)return!1;d=b.interactive||d;var g=!1,f=d;b.hitArea&&(f=!1);e&&b._mask&&(b._mask.containsPoint(a)||
(e=!1));e&&b.filterArea&&(b.filterArea.contains(a.x,a.y)||(e=!1));if(b.interactiveChildren&&b.children)for(var h=b.children,k=h.length-1;0<=k;k--){var n=h[k];this.processInteractive(a,n,c,e,f)&&n.parent&&(g=!0,e=f=!1)}d&&(e&&!g&&(b.hitArea?(b.worldTransform.applyInverse(a,this._tempPoint),g=b.hitArea.contains(this._tempPoint.x,this._tempPoint.y)):b.containsPoint&&(g=b.containsPoint(a))),b.interactive&&(g&&!this.eventData.target&&(this.eventData.target=b,this.mouse.target=b,this.pointer.target=b),
c(b,g)));return g};b.prototype.onMouseDown=function(a){this.mouse.originalEvent=a;this.eventData.data=this.mouse;this.eventData._reset();this.mapPositionToPoint(this.mouse.global,a.clientX,a.clientY);this.autoPreventDefault&&this.mouse.originalEvent.preventDefault();this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseDown,!0);this.emit(2===a.button||3===a.which?"rightdown":"mousedown",this.eventData)};b.prototype.processMouseDown=function(a,b){var c=this.mouse.originalEvent,
c=2===c.button||3===c.which;b&&(a[c?"_isRightDown":"_isLeftDown"]=!0,this.dispatchEvent(a,c?"rightdown":"mousedown",this.eventData))};b.prototype.onMouseUp=function(a){this.mouse.originalEvent=a;this.eventData.data=this.mouse;this.eventData._reset();this.mapPositionToPoint(this.mouse.global,a.clientX,a.clientY);this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseUp,!0);this.emit(2===a.button||3===a.which?"rightup":"mouseup",this.eventData)};b.prototype.processMouseUp=
function(a,b){var c=this.mouse.originalEvent,e=(c=2===c.button||3===c.which)?"_isRightDown":"_isLeftDown";b?(this.dispatchEvent(a,c?"rightup":"mouseup",this.eventData),a[e]&&(a[e]=!1,this.dispatchEvent(a,c?"rightclick":"click",this.eventData))):a[e]&&(a[e]=!1,this.dispatchEvent(a,c?"rightupoutside":"mouseupoutside",this.eventData))};b.prototype.onMouseMove=function(a){this.mouse.originalEvent=a;this.eventData.data=this.mouse;this.eventData._reset();this.mapPositionToPoint(this.mouse.global,a.clientX,
a.clientY);this.didMove=!0;this.cursor=this.defaultCursorStyle;this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseMove,!0);this.emit("mousemove",this.eventData);this.currentCursorStyle!==this.cursor&&(this.currentCursorStyle=this.cursor,this.interactionDOMElement.style.cursor=this.cursor)};b.prototype.processMouseMove=function(a,b){this.processMouseOverOut(a,b);this.moveWhenInside&&!b||this.dispatchEvent(a,"mousemove",this.eventData)};b.prototype.onMouseOut=
function(a){this.mouseOverRenderer=!1;this.mouse.originalEvent=a;this.eventData.data=this.mouse;this.eventData._reset();this.mapPositionToPoint(this.mouse.global,a.clientX,a.clientY);this.interactionDOMElement.style.cursor=this.defaultCursorStyle;this.mapPositionToPoint(this.mouse.global,a.clientX,a.clientY);this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseOverOut,!1);this.emit("mouseout",this.eventData)};b.prototype.processMouseOverOut=function(a,b){b&&
this.mouseOverRenderer?(a._mouseOver||(a._mouseOver=!0,this.dispatchEvent(a,"mouseover",this.eventData)),a.buttonMode&&(this.cursor=a.defaultCursor)):a._mouseOver&&(a._mouseOver=!1,this.dispatchEvent(a,"mouseout",this.eventData))};b.prototype.onMouseOver=function(a){this.mouseOverRenderer=!0;this.mouse.originalEvent=a;this.eventData.data=this.mouse;this.eventData._reset();this.emit("mouseover",this.eventData)};b.prototype.onPointerDown=function(a){this.normalizeToPointerData(a);this.pointer.originalEvent=
a;this.eventData.data=this.pointer;this.eventData._reset();this.mapPositionToPoint(this.pointer.global,a.clientX,a.clientY);this.autoPreventDefault&&this.pointer.originalEvent.preventDefault();this.processInteractive(this.pointer.global,this.renderer._lastObjectRendered,this.processPointerDown,!0);this.emit("pointerdown",this.eventData)};b.prototype.processPointerDown=function(a,b){b&&(a._pointerDown=!0,this.dispatchEvent(a,"pointerdown",this.eventData))};b.prototype.onPointerUp=function(a){this.normalizeToPointerData(a);
this.pointer.originalEvent=a;this.eventData.data=this.pointer;this.eventData._reset();this.mapPositionToPoint(this.pointer.global,a.clientX,a.clientY);this.processInteractive(this.pointer.global,this.renderer._lastObjectRendered,this.processPointerUp,!0);this.emit("pointerup",this.eventData)};b.prototype.processPointerUp=function(a,b){b?(this.dispatchEvent(a,"pointerup",this.eventData),a._pointerDown&&(a._pointerDown=!1,this.dispatchEvent(a,"pointertap",this.eventData))):a._pointerDown&&(a._pointerDown=
!1,this.dispatchEvent(a,"pointerupoutside",this.eventData))};b.prototype.onPointerMove=function(a){this.normalizeToPointerData(a);this.pointer.originalEvent=a;this.eventData.data=this.pointer;this.eventData._reset();this.mapPositionToPoint(this.pointer.global,a.clientX,a.clientY);this.processInteractive(this.pointer.global,this.renderer._lastObjectRendered,this.processPointerMove,!0);this.emit("pointermove",this.eventData)};b.prototype.processPointerMove=function(a,b){this.pointer.originalEvent.changedTouches||
this.processPointerOverOut(a,b);this.moveWhenInside&&!b||this.dispatchEvent(a,"pointermove",this.eventData)};b.prototype.onPointerOut=function(a){this.normalizeToPointerData(a);this.pointer.originalEvent=a;this.eventData.data=this.pointer;this.eventData._reset();this.mapPositionToPoint(this.pointer.global,a.clientX,a.clientY);this.processInteractive(this.pointer.global,this.renderer._lastObjectRendered,this.processPointerOverOut,!1);this.emit("pointerout",this.eventData)};b.prototype.processPointerOverOut=
function(a,b){b&&this.mouseOverRenderer?a._pointerOver||(a._pointerOver=!0,this.dispatchEvent(a,"pointerover",this.eventData)):a._pointerOver&&(a._pointerOver=!1,this.dispatchEvent(a,"pointerout",this.eventData))};b.prototype.onPointerOver=function(a){this.pointer.originalEvent=a;this.eventData.data=this.pointer;this.eventData._reset();this.emit("pointerover",this.eventData)};b.prototype.onTouchStart=function(a){this.autoPreventDefault&&a.preventDefault();for(var b=a.changedTouches,c=b.length,e=0;e<
c;e++){var d=this.getTouchData(b[e]);d.originalEvent=a;this.eventData.data=d;this.eventData._reset();this.processInteractive(d.global,this.renderer._lastObjectRendered,this.processTouchStart,!0);this.emit("touchstart",this.eventData);this.returnTouchData(d)}};b.prototype.processTouchStart=function(a,b){b&&(a._touchDown=!0,this.dispatchEvent(a,"touchstart",this.eventData))};b.prototype.onTouchEnd=function(a){this.autoPreventDefault&&a.preventDefault();for(var b=a.changedTouches,c=b.length,e=0;e<c;e++){var d=
this.getTouchData(b[e]);d.originalEvent=a;this.eventData.data=d;this.eventData._reset();this.processInteractive(d.global,this.renderer._lastObjectRendered,this.processTouchEnd,!0);this.emit("touchend",this.eventData);this.returnTouchData(d)}};b.prototype.processTouchEnd=function(a,b){b?(this.dispatchEvent(a,"touchend",this.eventData),a._touchDown&&(a._touchDown=!1,this.dispatchEvent(a,"tap",this.eventData))):a._touchDown&&(a._touchDown=!1,this.dispatchEvent(a,"touchendoutside",this.eventData))};b.prototype.onTouchMove=
function(a){this.autoPreventDefault&&a.preventDefault();for(var b=a.changedTouches,c=b.length,e=0;e<c;e++){var d=this.getTouchData(b[e]);d.originalEvent=a;this.eventData.data=d;this.eventData._reset();this.processInteractive(d.global,this.renderer._lastObjectRendered,this.processTouchMove,this.moveWhenInside);this.emit("touchmove",this.eventData);this.returnTouchData(d)}};b.prototype.processTouchMove=function(a,b){this.moveWhenInside&&!b||this.dispatchEvent(a,"touchmove",this.eventData)};b.prototype.getTouchData=
function(a){var b=this.interactiveDataPool.pop()||new h["default"];b.identifier=a.identifier;this.mapPositionToPoint(b.global,a.clientX,a.clientY);navigator.isCocoonJS&&(b.global.x/=this.resolution,b.global.y/=this.resolution);a.globalX=b.global.x;a.globalY=b.global.y;return b};b.prototype.returnTouchData=function(a){this.interactiveDataPool.push(a)};b.prototype.normalizeToPointerData=function(a){this.normalizeTouchEvents&&a.changedTouches?("undefined"===typeof a.button&&(a.button=a.touches.length?
1:0),"undefined"===typeof a.buttons&&(a.buttons=a.touches.length?1:0),"undefined"===typeof a.isPrimary&&(a.isPrimary=1===a.touches.length),"undefined"===typeof a.width&&(a.width=a.changedTouches[0].radiusX||1),"undefined"===typeof a.height&&(a.height=a.changedTouches[0].radiusY||1),"undefined"===typeof a.tiltX&&(a.tiltX=0),"undefined"===typeof a.tiltY&&(a.tiltY=0),"undefined"===typeof a.pointerType&&(a.pointerType="touch"),"undefined"===typeof a.pointerId&&(a.pointerId=a.changedTouches[0].identifier||
0),"undefined"===typeof a.pressure&&(a.pressure=a.changedTouches[0].force||.5),"undefined"===typeof a.rotation&&(a.rotation=a.changedTouches[0].rotationAngle||0),"undefined"===typeof a.clientX&&(a.clientX=a.changedTouches[0].clientX),"undefined"===typeof a.clientY&&(a.clientY=a.changedTouches[0].clientY),"undefined"===typeof a.pageX&&(a.pageX=a.changedTouches[0].pageX),"undefined"===typeof a.pageY&&(a.pageY=a.changedTouches[0].pageY),"undefined"===typeof a.screenX&&(a.screenX=a.changedTouches[0].screenX),
"undefined"===typeof a.screenY&&(a.screenY=a.changedTouches[0].screenY),"undefined"===typeof a.layerX&&(a.layerX=a.offsetX=a.clientX),"undefined"===typeof a.layerY&&(a.layerY=a.offsetY=a.clientY)):this.normalizeMouseEvents&&("undefined"===typeof a.isPrimary&&(a.isPrimary=!0),"undefined"===typeof a.width&&(a.width=1),"undefined"===typeof a.height&&(a.height=1),"undefined"===typeof a.tiltX&&(a.tiltX=0),"undefined"===typeof a.tiltY&&(a.tiltY=0),"undefined"===typeof a.pointerType&&(a.pointerType="mouse"),
"undefined"===typeof a.pointerId&&(a.pointerId=1),"undefined"===typeof a.pressure&&(a.pressure=.5),"undefined"===typeof a.rotation&&(a.rotation=0))};b.prototype.destroy=function(){this.removeEvents();this.removeAllListeners();this._tempPoint=this.processTouchMove=this.onTouchMove=this.processTouchEnd=this.onTouchEnd=this.processTouchStart=this.onTouchStart=this.onPointerOver=this.processPointerOverOut=this.onPointerOut=this.processPointerMove=this.onPointerMove=this.processPointerUp=this.onPointerUp=
this.processPointerDown=this.onPointerDown=this.onMouseOver=this.processMouseOverOut=this.onMouseOut=this.processMouseMove=this.onMouseMove=this.processMouseUp=this.onMouseUp=this.processMouseDown=this.onMouseDown=this.interactionDOMElement=this.interactiveDataPool=this.eventData=this.mouse=this.renderer=null};return b}(b["default"]);d["default"]=a;n.WebGLRenderer.registerPlugin("interaction",a);n.CanvasRenderer.registerPlugin("interaction",a)},{"../core":62,"./InteractionData":144,"./InteractionEvent":145,
"./interactiveTarget":148,eventemitter3:3,ismobilejs:4}],147:[function(a,b,d){function f(a){return a&&a.__esModule?a:{"default":a}}d.__esModule=!0;var k=a("./InteractionData");Object.defineProperty(d,"InteractionData",{enumerable:!0,get:function(){return f(k)["default"]}});var n=a("./InteractionManager");Object.defineProperty(d,"InteractionManager",{enumerable:!0,get:function(){return f(n)["default"]}});var h=a("./interactiveTarget");Object.defineProperty(d,"interactiveTarget",{enumerable:!0,get:function(){return f(h)["default"]}})},
{"./InteractionData":144,"./InteractionManager":146,"./interactiveTarget":148}],148:[function(a,b,d){d.__esModule=!0;d["default"]={interactive:!1,interactiveChildren:!0,hitArea:null,buttonMode:!1,defaultCursor:"pointer",_over:!1,_isLeftDown:!1,_isRightDown:!1,_pointerOver:!1,_pointerDown:!1,_touchDown:!1}},{}],149:[function(a,b,d){function f(a,b){var d={},f=a.data.getElementsByTagName("info")[0],h=a.data.getElementsByTagName("common")[0];d.font=f.getAttribute("face");d.size=parseInt(f.getAttribute("size"),
10);d.lineHeight=parseInt(h.getAttribute("lineHeight"),10);d.chars={};f=a.data.getElementsByTagName("char");for(h=0;h<f.length;h++){var k=parseInt(f[h].getAttribute("id"),10),m=new n.Rectangle(parseInt(f[h].getAttribute("x"),10)+b.frame.x,parseInt(f[h].getAttribute("y"),10)+b.frame.y,parseInt(f[h].getAttribute("width"),10),parseInt(f[h].getAttribute("height"),10));d.chars[k]={xOffset:parseInt(f[h].getAttribute("xoffset"),10),yOffset:parseInt(f[h].getAttribute("yoffset"),10),xAdvance:parseInt(f[h].getAttribute("xadvance"),
10),kerning:{},texture:new n.Texture(b.baseTexture,m)}}f=a.data.getElementsByTagName("kerning");for(h=0;h<f.length;h++){var k=parseInt(f[h].getAttribute("first"),10),m=parseInt(f[h].getAttribute("second"),10),t=parseInt(f[h].getAttribute("amount"),10);d.chars[m]&&(d.chars[m].kerning[k]=t)}a.bitmapFont=d;e.BitmapText.fonts[d.font]=d}d.__esModule=!0;d.parse=f;d["default"]=function(){return function(a,b){if(a.data&&a.isXml)if(0===a.data.getElementsByTagName("page").length||0===a.data.getElementsByTagName("info").length||
null===a.data.getElementsByTagName("info")[0].getAttribute("face"))b();else{var e=a.isDataUrl?"":k.dirname(a.url);a.isDataUrl&&("."===e&&(e=""),this.baseUrl&&e&&("/"===this.baseUrl.charAt(this.baseUrl.length-1)&&(e+="/"),e=e.replace(this.baseUrl,"")));e&&"/"!==e.charAt(e.length-1)&&(e+="/");e+=a.data.getElementsByTagName("page")[0].getAttribute("file");n.utils.TextureCache[e]?(f(a,n.utils.TextureCache[e]),b()):this.add(a.name+"_image",e,{crossOrigin:a.crossOrigin,loadType:h.Resource.LOAD_TYPE.IMAGE,
metadata:a.metadata.imageMetadata},function(e){f(a,e.texture);b()})}else b()}};var k=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(b[e]=a[e]);b["default"]=a;return b}(a("path")),n=a("../core"),h=a("resource-loader"),e=a("../extras")},{"../core":62,"../extras":130,path:22,"resource-loader":36}],150:[function(a,b,d){function f(a){return a&&a.__esModule?a:{"default":a}}d.__esModule=!0;var k=a("./loader");Object.defineProperty(d,
"Loader",{enumerable:!0,get:function(){return f(k)["default"]}});var n=a("./bitmapFontParser");Object.defineProperty(d,"bitmapFontParser",{enumerable:!0,get:function(){return f(n)["default"]}});Object.defineProperty(d,"parseBitmapFontData",{enumerable:!0,get:function(){return n.parse}});var h=a("./spritesheetParser");Object.defineProperty(d,"spritesheetParser",{enumerable:!0,get:function(){return f(h)["default"]}});var e=a("./textureParser");Object.defineProperty(d,"textureParser",{enumerable:!0,
get:function(){return f(e)["default"]}});var g=a("resource-loader");Object.defineProperty(d,"Resource",{enumerable:!0,get:function(){return g.Resource}})},{"./bitmapFontParser":149,"./loader":151,"./spritesheetParser":152,"./textureParser":153,"resource-loader":36}],151:[function(a,b,d){function f(a){return a&&a.__esModule?a:{"default":a}}function k(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&
b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}d.__esModule=!0;b=a("resource-loader");b=f(b);var n=a("./textureParser"),n=f(n),h=a("./spritesheetParser"),h=f(h);a=a("./bitmapFontParser");a=f(a);var e=function(a){function b(e,d){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var f;f=a.call(this,e,d);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
f=!f||"object"!==typeof f&&"function"!==typeof f?this:f;for(var h=0;h<b._pixiMiddleware.length;++h)f.use(b._pixiMiddleware[h]());return f}k(b,a);b.addPixiMiddleware=function(a){b._pixiMiddleware.push(a)};return b}(b["default"]);d["default"]=e;e._pixiMiddleware=[b["default"].middleware.parsing.blob,n["default"],h["default"],a["default"]];d=b["default"].Resource;d.setExtensionXhrType("fnt",d.XHR_RESPONSE_TYPE.DOCUMENT)},{"./bitmapFontParser":149,"./spritesheetParser":152,"./textureParser":153,"resource-loader":36}],
152:[function(a,b,d){d.__esModule=!0;d["default"]=function(){return function(a,b){var c=void 0,d=a.name+"_image";if(a.data&&a.isJson&&a.data.frames&&!this.resources[d]){var m={crossOrigin:a.crossOrigin,loadType:f.Resource.LOAD_TYPE.IMAGE,metadata:a.metadata.imageMetadata},c=a.isDataUrl?a.data.meta.image:k["default"].dirname(a.url.replace(this.baseUrl,""))+"/"+a.data.meta.image;this.add(d,c,m,function(c){function d(b,g){for(var f=b;f-b<g&&f<p.length;){var h=p[f],k=m[h].frame;if(k){var A=null,z=new n.Rectangle(0,
0,m[h].sourceSize.w/y,m[h].sourceSize.h/y),k=m[h].rotated?new n.Rectangle(k.x/y,k.y/y,k.h/y,k.w/y):new n.Rectangle(k.x/y,k.y/y,k.w/y,k.h/y);m[h].trimmed&&(A=new n.Rectangle(m[h].spriteSourceSize.x/y,m[h].spriteSourceSize.y/y,m[h].spriteSourceSize.w/y,m[h].spriteSourceSize.h/y));a.textures[h]=new n.Texture(c.texture.baseTexture,k,z,A,m[h].rotated?2:0);n.utils.TextureCache[h]=a.textures[h]}f++}}function f(a){d(u*h,h);u++;setTimeout(a,0)}function k(){f(function(){u*h<p.length?k():b()})}a.textures={};
var m=a.data.frames,p=Object.keys(m),y=n.utils.getResolutionOfUrl(a.url),u=0;p.length<=h?(d(0,h),b()):k()})}else b()}};var f=a("resource-loader"),k=(b=a("path"))&&b.__esModule?b:{"default":b},n=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b["default"]=a;return b}(a("../core")),h=1E3},{"../core":62,path:22,"resource-loader":36}],153:[function(a,b,d){d.__esModule=!0;d["default"]=function(){return function(a,b){if(a.data&&
a.isImage){var d=new f.BaseTexture(a.data,null,f.utils.getResolutionOfUrl(a.url));d.imageUrl=a.url;a.texture=new f.Texture(d);f.utils.BaseTextureCache[a.name]=d;f.utils.TextureCache[a.name]=a.texture;a.name!==a.url&&(f.utils.BaseTextureCache[a.url]=d,f.utils.TextureCache[a.url]=a.texture)}b()}};var f=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b["default"]=a;return b}(a("../core"))},{"../core":62}],154:[function(a,
b,d){function f(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}d.__esModule=!0;var k=function(){function a(b,e){for(var d=0;d<e.length;d++){var g=e[d];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(b,
g.key,g)}}return function(b,e,d){e&&a(b.prototype,e);d&&a(b,d);return b}}(),n=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(b[e]=a[e]);b["default"]=a;return b}(a("../core")),h=new n.Point,e=new n.Polygon;a=function(a){function b(e,d,f,h,k){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var m;m=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
m=!m||"object"!==typeof m&&"function"!==typeof m?this:m;m._texture=null;m.uvs=f||new Float32Array([0,0,1,0,1,1,0,1]);m.vertices=d||new Float32Array([0,0,100,0,100,100,0,100]);m.indices=h||new Uint16Array([0,1,3,2]);m.dirty=0;m.indexDirty=0;m.blendMode=n.BLEND_MODES.NORMAL;m.canvasPadding=0;m.drawMode=k||b.DRAW_MODES.TRIANGLE_MESH;m.texture=e;m.shader=null;m.tintRgb=new Float32Array([1,1,1]);m._glDatas={};return m}f(b,a);b.prototype._renderWebGL=function(a){a.setObjectRenderer(a.plugins.mesh);a.plugins.mesh.render(this)};
b.prototype._renderCanvas=function(a){a.plugins.mesh.render(this)};b.prototype._onTextureUpdate=function(){};b.prototype._calculateBounds=function(){this._bounds.addVertices(this.transform,this.vertices,0,this.vertices.length)};b.prototype.containsPoint=function(a){if(!this.getBounds().contains(a.x,a.y))return!1;this.worldTransform.applyInverse(a,h);a=this.vertices;for(var d=e.points,g=this.indices,f=this.indices.length,k=this.drawMode===b.DRAW_MODES.TRIANGLES?3:1,n=0;n+2<f;n+=k){var m=2*g[n],r=2*
g[n+1],x=2*g[n+2];d[0]=a[m];d[1]=a[m+1];d[2]=a[r];d[3]=a[r+1];d[4]=a[x];d[5]=a[x+1];if(e.contains(h.x,h.y))return!0}return!1};k(b,[{key:"texture",get:function(){return this._texture},set:function(a){if(this._texture!==a&&(this._texture=a))if(a.baseTexture.hasLoaded)this._onTextureUpdate();else a.once("update",this._onTextureUpdate,this)}},{key:"tint",get:function(){return n.utils.rgb2hex(this.tintRgb)},set:function(a){this.tintRgb=n.utils.hex2rgb(a,this.tintRgb)}}]);return b}(n.Container);d["default"]=
a;a.DRAW_MODES={TRIANGLE_MESH:0,TRIANGLES:1}},{"../core":62}],155:[function(a,b,d){function f(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}d.__esModule=!0;var k=function(){function a(b,e){for(var d=0;d<e.length;d++){var c=e[d];c.enumerable=c.enumerable||
!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(b,c.key,c)}}return function(b,e,d){e&&a(b.prototype,e);d&&a(b,d);return b}}();a=a("./Plane");a=function(a){function b(e,d,c,f,k){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var m;m=a.call(this,e,4,4);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");m=!m||"object"!==typeof m&&"function"!==typeof m?this:m;var A=m.uvs;A[6]=A[14]=A[22]=A[30]=1;A[25]=
A[27]=A[29]=A[31]=1;m._origWidth=e.width;m._origHeight=e.height;m._uvw=1/m._origWidth;m._uvh=1/m._origHeight;m.width=e.width;m.height=e.height;A[2]=A[10]=A[18]=A[26]=m._uvw*d;A[4]=A[12]=A[20]=A[28]=1-m._uvw*f;A[9]=A[11]=A[13]=A[15]=m._uvh*c;A[17]=A[19]=A[21]=A[23]=1-m._uvh*k;m.leftWidth="undefined"!==typeof d?d:10;m.rightWidth="undefined"!==typeof f?f:10;m.topHeight="undefined"!==typeof c?c:10;m.bottomHeight="undefined"!==typeof k?k:10;return m}f(b,a);b.prototype.updateHorizontalVertices=function(){var a=
this.vertices;a[9]=a[11]=a[13]=a[15]=this._topHeight;a[17]=a[19]=a[21]=a[23]=this._height-this._bottomHeight;a[25]=a[27]=a[29]=a[31]=this._height};b.prototype.updateVerticalVertices=function(){var a=this.vertices;a[2]=a[10]=a[18]=a[26]=this._leftWidth;a[4]=a[12]=a[20]=a[28]=this._width-this._rightWidth;a[6]=a[14]=a[22]=a[30]=this._width};b.prototype._renderCanvas=function(a){var b=a.context;b.globalAlpha=this.worldAlpha;var c=this.worldTransform,d=a.resolution;a.roundPixels?b.setTransform(c.a*d,c.b*
d,c.c*d,c.d*d,c.tx*d|0,c.ty*d|0):b.setTransform(c.a*d,c.b*d,c.c*d,c.d*d,c.tx*d,c.ty*d);d=this._texture.baseTexture;a=d.source;c=d.width;d=d.height;this.drawSegment(b,a,c,d,0,1,10,11);this.drawSegment(b,a,c,d,2,3,12,13);this.drawSegment(b,a,c,d,4,5,14,15);this.drawSegment(b,a,c,d,8,9,18,19);this.drawSegment(b,a,c,d,10,11,20,21);this.drawSegment(b,a,c,d,12,13,22,23);this.drawSegment(b,a,c,d,16,17,26,27);this.drawSegment(b,a,c,d,18,19,28,29);this.drawSegment(b,a,c,d,20,21,30,31)};b.prototype.drawSegment=
function(a,b,c,d,f,h,k,m){var n=this.uvs,v=this.vertices,r=(n[k]-n[f])*c,x=(n[m]-n[h])*d;k=v[k]-v[f];m=v[m]-v[h];1>r&&(r=1);1>x&&(x=1);1>k&&(k=1);1>m&&(m=1);a.drawImage(b,n[f]*c,n[h]*d,r,x,v[f],v[h],k,m)};k(b,[{key:"width",get:function(){return this._width},set:function(a){this._width=a;this.updateVerticalVertices()}},{key:"height",get:function(){return this._height},set:function(a){this._height=a;this.updateHorizontalVertices()}},{key:"leftWidth",get:function(){return this._leftWidth},set:function(a){this._leftWidth=
a;var b=this.uvs,c=this.vertices;b[2]=b[10]=b[18]=b[26]=this._uvw*a;c[2]=c[10]=c[18]=c[26]=a;this.dirty=!0}},{key:"rightWidth",get:function(){return this._rightWidth},set:function(a){this._rightWidth=a;var b=this.uvs,c=this.vertices;b[4]=b[12]=b[20]=b[28]=1-this._uvw*a;c[4]=c[12]=c[20]=c[28]=this._width-a;this.dirty=!0}},{key:"topHeight",get:function(){return this._topHeight},set:function(a){this._topHeight=a;var b=this.uvs,c=this.vertices;b[9]=b[11]=b[13]=b[15]=this._uvh*a;c[9]=c[11]=c[13]=c[15]=
a;this.dirty=!0}},{key:"bottomHeight",get:function(){return this._bottomHeight},set:function(a){this._bottomHeight=a;var b=this.uvs,c=this.vertices;b[17]=b[19]=b[21]=b[23]=1-this._uvh*a;c[17]=c[19]=c[21]=c[23]=this._height-a;this.dirty=!0}}]);return b}((a&&a.__esModule?a:{"default":a})["default"]);d["default"]=a},{"./Plane":156}],156:[function(a,b,d){function f(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=
Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}d.__esModule=!0;var k=(a=a("./Mesh"))&&a.__esModule?a:{"default":a};a=function(a){function b(d,f,c){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");d=a.call(this,d);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");d=!d||"object"!==typeof d&&"function"!==typeof d?
this:d;d._ready=!0;d.verticesX=f||10;d.verticesY=c||10;d.drawMode=k["default"].DRAW_MODES.TRIANGLES;d.refresh();return d}f(b,a);b.prototype.refresh=function(){for(var a=this.verticesX*this.verticesY,b=[],c=[],d=[],f=this.texture,h=this.verticesX-1,k=this.verticesY-1,m=f.width/h,n=f.height/k,v=0;v<a;v++){var r=v%this.verticesX,x=v/this.verticesX|0;b.push(r*m,x*n);c.push(f._uvs.x0+r/(this.verticesX-1)*(f._uvs.x1-f._uvs.x0),f._uvs.y0+x/(this.verticesY-1)*(f._uvs.y3-f._uvs.y0))}a=h*k;for(f=0;f<a;f++)k=
f%h,m=f/h|0,n=m*this.verticesX+k+1,v=(m+1)*this.verticesX+k,r=(m+1)*this.verticesX+k+1,d.push(m*this.verticesX+k,n,v),d.push(n,r,v);this.vertices=new Float32Array(b);this.uvs=new Float32Array(c);this.colors=new Float32Array([]);this.indices=new Uint16Array(d);this.indexDirty=!0};b.prototype._onTextureUpdate=function(){k["default"].prototype._onTextureUpdate.call(this);this._ready&&this.refresh()};return b}(k["default"]);d["default"]=a},{"./Mesh":154}],157:[function(a,b,d){function f(a,b){if("function"!==
typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}d.__esModule=!0;b=(b=a("./Mesh"))&&b.__esModule?b:{"default":b};var k=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b["default"]=a;return b}(a("../core"));
a=function(a){function b(d,f){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var c;c=a.call(this,d);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");c=!c||"object"!==typeof c&&"function"!==typeof c?this:c;c.points=f;c.vertices=new Float32Array(4*f.length);c.uvs=new Float32Array(4*f.length);c.colors=new Float32Array(2*f.length);c.indices=new Uint16Array(2*f.length);c._ready=!0;c.refresh();return c}f(b,a);b.prototype.refresh=
function(){var a=this.points;if(!(1>a.length)&&this._texture._uvs){var b=this.uvs,c=this.indices,d=this.colors,f=this._texture._uvs,h=new k.Point(f.x0,f.y0),f=new k.Point(f.x2-f.x0,f.y2-f.y0);b[0]=0+h.x;b[1]=0+h.y;b[2]=0+h.x;b[3]=Number(f.y)+h.y;d[0]=1;d[1]=1;c[0]=0;c[1]=1;for(var a=a.length,m=1;m<a;m++){var n=4*m,t=m/(a-1);b[n]=t*f.x+h.x;b[n+1]=0+h.y;b[n+2]=t*f.x+h.x;b[n+3]=Number(f.y)+h.y;n=2*m;d[n]=1;d[n+1]=1;n=2*m;c[n]=n;c[n+1]=n+1}this.indexDirty=this.dirty=!0}};b.prototype._onTextureUpdate=
function(){a.prototype._onTextureUpdate.call(this);this._ready&&this.refresh()};b.prototype.updateTransform=function(){var a=this.points;if(!(1>a.length)){for(var b=a[0],c,d,f=this.vertices,h=a.length,k=0;k<h;k++){var m=a[k],n=4*k;c=k<a.length-1?a[k+1]:m;d=-(c.x-b.x);b=c.y-b.y;c=Math.sqrt(b*b+d*d);var v=this._texture.height/2,b=b/c;d/=c;b*=v;d*=v;f[n]=m.x+b;f[n+1]=m.y+d;f[n+2]=m.x-b;f[n+3]=m.y-d;b=m}this.containerUpdateTransform()}};return b}(b["default"]);d["default"]=a},{"../core":62,"./Mesh":154}],
158:[function(a,b,d){d.__esModule=!0;b=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b["default"]=a;return b}(a("../../core"));var f=(a=a("../Mesh"))&&a.__esModule?a:{"default":a};a=function(){function a(b){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.renderer=b}a.prototype.render=function(a){var b=this.renderer,d=b.context,g=a.worldTransform,c=b.resolution;b.roundPixels?d.setTransform(g.a*
c,g.b*c,g.c*c,g.d*c,g.tx*c|0,g.ty*c|0):d.setTransform(g.a*c,g.b*c,g.c*c,g.d*c,g.tx*c,g.ty*c);a.drawMode===f["default"].DRAW_MODES.TRIANGLE_MESH?this._renderTriangleMesh(a):this._renderTriangles(a)};a.prototype._renderTriangleMesh=function(a){for(var b=a.vertices.length/2,d=0;d<b-2;d++){var f=2*d;this._renderDrawTriangle(a,f,f+2,f+4)}};a.prototype._renderTriangles=function(a){for(var b=a.indices,d=b.length,f=0;f<d;f+=3)this._renderDrawTriangle(a,2*b[f],2*b[f+1],2*b[f+2])};a.prototype._renderDrawTriangle=
function(a,b,d,f){var c=this.renderer.context,k=a.uvs,m=a.vertices,q=a._texture;if(q.valid){var q=q.baseTexture,A=q.source,z=q.width,t=q.height,v=k[b]*q.width,r=k[d]*q.width,x=k[f]*q.width,u=k[b+1]*q.height,w=k[d+1]*q.height,k=k[f+1]*q.height,B=m[b],G=m[d],K=m[f];b=m[b+1];d=m[d+1];f=m[f+1];if(0<a.canvasPadding){m=a.canvasPadding/a.worldTransform.a;a=a.canvasPadding/a.worldTransform.d;var C=(B+G+K)/3,H=(b+d+f)/3,I=B-C,L=b-H,F=Math.sqrt(I*I+L*L),B=C+I/F*(F+m);b=H+L/F*(F+a);I=G-C;L=d-H;F=Math.sqrt(I*
I+L*L);G=C+I/F*(F+m);d=H+L/F*(F+a);I=K-C;L=f-H;F=Math.sqrt(I*I+L*L);K=C+I/F*(F+m);f=H+L/F*(F+a)}c.save();c.beginPath();c.moveTo(B,b);c.lineTo(G,d);c.lineTo(K,f);c.closePath();c.clip();a=v*w+u*x+r*k-w*x-u*r-v*k;c.transform((B*w+u*K+G*k-w*K-u*G-B*k)/a,(b*w+u*f+d*k-w*f-u*d-b*k)/a,(v*G+B*x+r*K-G*x-B*r-v*K)/a,(v*d+b*x+r*f-d*x-b*r-v*f)/a,(v*w*K+u*G*x+B*r*k-B*w*x-u*r*K-v*G*k)/a,(v*w*f+u*d*x+b*r*k-b*w*x-u*r*f-v*d*k)/a);c.drawImage(A,0,0,z*q.resolution,t*q.resolution,0,0,z,t);c.restore()}};a.prototype.renderMeshFlat=
function(a){var b=this.renderer.context;a=a.vertices;var d=a.length/2;b.beginPath();for(var f=1;f<d-2;++f){var c=2*f,k=a[c+2],m=a[c+3],q=a[c+4],A=a[c+5];b.moveTo(a[c],a[c+1]);b.lineTo(k,m);b.lineTo(q,A)}b.fillStyle="#FF0000";b.fill();b.closePath()};a.prototype.destroy=function(){this.renderer=null};return a}();d["default"]=a;b.CanvasRenderer.registerPlugin("mesh",a)},{"../../core":62,"../Mesh":154}],159:[function(a,b,d){function f(a){return a&&a.__esModule?a:{"default":a}}d.__esModule=!0;var k=a("./Mesh");
Object.defineProperty(d,"Mesh",{enumerable:!0,get:function(){return f(k)["default"]}});var n=a("./webgl/MeshRenderer");Object.defineProperty(d,"MeshRenderer",{enumerable:!0,get:function(){return f(n)["default"]}});var h=a("./canvas/CanvasMeshRenderer");Object.defineProperty(d,"CanvasMeshRenderer",{enumerable:!0,get:function(){return f(h)["default"]}});var e=a("./Plane");Object.defineProperty(d,"Plane",{enumerable:!0,get:function(){return f(e)["default"]}});var g=a("./NineSlicePlane");Object.defineProperty(d,
"NineSlicePlane",{enumerable:!0,get:function(){return f(g)["default"]}});var c=a("./Rope");Object.defineProperty(d,"Rope",{enumerable:!0,get:function(){return f(c)["default"]}})},{"./Mesh":154,"./NineSlicePlane":155,"./Plane":156,"./Rope":157,"./canvas/CanvasMeshRenderer":158,"./webgl/MeshRenderer":160}],160:[function(a,b,d){function f(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,
{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}d.__esModule=!0;d.MeshRenderer=void 0;var k=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b["default"]=a;return b}(a("../../core")),n=(b=a("pixi-gl-core"))&&b.__esModule?b:{"default":b},h=(a=a("../Mesh"))&&a.__esModule?a:{"default":a};d=d.MeshRenderer=function(a){function b(c){if(!(this instanceof
b))throw new TypeError("Cannot call a class as a function");c=a.call(this,c);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");c=!c||"object"!==typeof c&&"function"!==typeof c?this:c;c.shader=null;return c}f(b,a);b.prototype.onContextChange=function(){this.shader=new k.Shader(this.renderer.gl,"#define GLSLIFY 1\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 translationMatrix;\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n}\n",
"#define GLSLIFY 1\nvarying vec2 vTextureCoord;\nuniform float alpha;\nuniform vec3 tint;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * vec4(tint * alpha, alpha);\n}\n")};b.prototype.render=function(a){var b=this.renderer,d=b.gl,e=a._texture;if(e.valid){var f=a._glDatas[b.CONTEXT_UID];f||(f={shader:this.shader,vertexBuffer:n["default"].GLBuffer.createVertexBuffer(d,a.vertices,d.STREAM_DRAW),uvBuffer:n["default"].GLBuffer.createVertexBuffer(d,
a.uvs,d.STREAM_DRAW),indexBuffer:n["default"].GLBuffer.createIndexBuffer(d,a.indices,d.STATIC_DRAW),vao:new n["default"].VertexArrayObject(d),dirty:a.dirty,indexDirty:a.indexDirty},f.vao=(new n["default"].VertexArrayObject(d)).addIndex(f.indexBuffer).addAttribute(f.vertexBuffer,f.shader.attributes.aVertexPosition,d.FLOAT,!1,8,0).addAttribute(f.uvBuffer,f.shader.attributes.aTextureCoord,d.FLOAT,!1,8,0),a._glDatas[b.CONTEXT_UID]=f);a.dirty!==f.dirty&&(f.dirty=a.dirty,f.uvBuffer.upload());a.indexDirty!==
f.indexDirty&&(f.indexDirty=a.indexDirty,f.indexBuffer.upload());f.vertexBuffer.upload();b.bindShader(f.shader);b.bindTexture(e,0);b.state.setBlendMode(a.blendMode);f.shader.uniforms.translationMatrix=a.worldTransform.toArray(!0);f.shader.uniforms.alpha=a.worldAlpha;f.shader.uniforms.tint=a.tintRgb;b=a.drawMode===h["default"].DRAW_MODES.TRIANGLE_MESH?d.TRIANGLE_STRIP:d.TRIANGLES;f.vao.bind().draw(b,a.indices.length).unbind()}};return b}(k.ObjectRenderer);k.WebGLRenderer.registerPlugin("mesh",d)},
{"../../core":62,"../Mesh":154,"pixi-gl-core":12}],161:[function(a,b,d){function f(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}d.__esModule=!0;var k=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,
d)&&(b[d]=a[d]);b["default"]=a;return b}(a("../core"));a=function(a){function b(){var d=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1500,f=arguments[1],c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:16384;if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var m;m=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");m=!m||"object"!==typeof m&&"function"!==typeof m?this:m;16384<c&&(c=16384);c>d&&
(c=d);m._properties=[!1,!0,!1,!1,!1];m._maxSize=d;m._batchSize=c;m._glBuffers={};m._bufferToUpdate=0;m.interactiveChildren=!1;m.blendMode=k.BLEND_MODES.NORMAL;m.roundPixels=!0;m.baseTexture=null;m.setProperties(f);return m}f(b,a);b.prototype.setProperties=function(a){a&&(this._properties[0]="scale"in a?!!a.scale:this._properties[0],this._properties[1]="position"in a?!!a.position:this._properties[1],this._properties[2]="rotation"in a?!!a.rotation:this._properties[2],this._properties[3]="uvs"in a?!!a.uvs:
this._properties[3],this._properties[4]="alpha"in a?!!a.alpha:this._properties[4])};b.prototype.updateTransform=function(){this.displayObjectUpdateTransform()};b.prototype.renderWebGL=function(a){var b=this;if(this.visible&&!(0>=this.worldAlpha)&&this.children.length&&this.renderable){if(!this.baseTexture&&(this.baseTexture=this.children[0]._texture.baseTexture,!this.baseTexture.hasLoaded))this.baseTexture.once("update",function(){return b.onChildrenChange(0)});a.setObjectRenderer(a.plugins.particle);
a.plugins.particle.render(this)}};b.prototype.onChildrenChange=function(a){a=Math.floor(a/this._batchSize);a<this._bufferToUpdate&&(this._bufferToUpdate=a)};b.prototype.renderCanvas=function(a){if(this.visible&&!(0>=this.worldAlpha)&&this.children.length&&this.renderable){var b=a.context,c=this.worldTransform,d=!0,f,h,k,m,n=a.blendModes[this.blendMode];n!==b.globalCompositeOperation&&(b.globalCompositeOperation=n);b.globalAlpha=this.worldAlpha;this.displayObjectUpdateTransform();for(n=0;n<this.children.length;++n){var v=
this.children[n];if(v.visible){var r=v.texture.frame;b.globalAlpha=this.worldAlpha*v.alpha;0===v.rotation%(2*Math.PI)?(d&&(b.setTransform(c.a,c.b,c.c,c.d,c.tx*a.resolution,c.ty*a.resolution),d=!1),f=v.anchor.x*-r.width*v.scale.x+v.position.x+.5,h=v.anchor.y*-r.height*v.scale.y+v.position.y+.5,k=r.width*v.scale.x,m=r.height*v.scale.y):(d||(d=!0),v.displayObjectUpdateTransform(),f=v.worldTransform,a.roundPixels?b.setTransform(f.a,f.b,f.c,f.d,f.tx*a.resolution|0,f.ty*a.resolution|0):b.setTransform(f.a,
f.b,f.c,f.d,f.tx*a.resolution,f.ty*a.resolution),f=v.anchor.x*-r.width+.5,h=v.anchor.y*-r.height+.5,k=r.width,m=r.height);var x=v.texture.baseTexture.resolution;b.drawImage(v.texture.baseTexture.source,r.x*x,r.y*x,r.width*x,r.height*x,f*x,h*x,k*x,m*x)}}}};b.prototype.destroy=function(b){a.prototype.destroy.call(this,b);if(this._buffers)for(b=0;b<this._buffers.length;++b)this._buffers[b].destroy();this._buffers=this._properties=null};return b}(k.Container);d["default"]=a},{"../core":62}],162:[function(a,
b,d){d.__esModule=!0;var f=a("./ParticleContainer");Object.defineProperty(d,"ParticleContainer",{enumerable:!0,get:function(){return(f&&f.__esModule?f:{"default":f})["default"]}});var k=a("./webgl/ParticleRenderer");Object.defineProperty(d,"ParticleRenderer",{enumerable:!0,get:function(){return(k&&k.__esModule?k:{"default":k})["default"]}})},{"./ParticleContainer":161,"./webgl/ParticleRenderer":164}],163:[function(a,b,d){d.__esModule=!0;var f=(b=a("pixi-gl-core"))&&b.__esModule?b:{"default":b},k=
(a=a("../../core/utils/createIndicesForQuads"))&&a.__esModule?a:{"default":a};a=function(){function a(b,d,f,c){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.gl=b;this.vertSize=2;this.vertByteSize=4*this.vertSize;this.size=c;this.dynamicProperties=[];this.staticProperties=[];for(b=0;b<d.length;++b)c=d[b],c={attribute:c.attribute,size:c.size,uploadFunction:c.uploadFunction,offset:c.offset},f[b]?this.dynamicProperties.push(c):this.staticProperties.push(c);this.staticStride=
0;this.staticData=this.staticBuffer=null;this.dynamicStride=0;this.dynamicData=this.dynamicBuffer=null;this.initBuffers()}a.prototype.initBuffers=function(){var a=this.gl,b=0;this.indices=(0,k["default"])(this.size);this.indexBuffer=f["default"].GLBuffer.createIndexBuffer(a,this.indices,a.STATIC_DRAW);for(var d=this.dynamicStride=0;d<this.dynamicProperties.length;++d){var c=this.dynamicProperties[d];c.offset=b;b+=c.size;this.dynamicStride+=c.size}this.dynamicData=new Float32Array(this.size*this.dynamicStride*
4);this.dynamicBuffer=f["default"].GLBuffer.createVertexBuffer(a,this.dynamicData,a.STREAM_DRAW);for(d=this.staticStride=b=0;d<this.staticProperties.length;++d)c=this.staticProperties[d],c.offset=b,b+=c.size,this.staticStride+=c.size;this.staticData=new Float32Array(this.size*this.staticStride*4);this.staticBuffer=f["default"].GLBuffer.createVertexBuffer(a,this.staticData,a.STATIC_DRAW);this.vao=(new f["default"].VertexArrayObject(a)).addIndex(this.indexBuffer);for(b=0;b<this.dynamicProperties.length;++b)d=
this.dynamicProperties[b],this.vao.addAttribute(this.dynamicBuffer,d.attribute,a.FLOAT,!1,4*this.dynamicStride,4*d.offset);for(b=0;b<this.staticProperties.length;++b)d=this.staticProperties[b],this.vao.addAttribute(this.staticBuffer,d.attribute,a.FLOAT,!1,4*this.staticStride,4*d.offset)};a.prototype.uploadDynamic=function(a,b,d){for(var c=0;c<this.dynamicProperties.length;c++){var f=this.dynamicProperties[c];f.uploadFunction(a,b,d,this.dynamicData,this.dynamicStride,f.offset)}this.dynamicBuffer.upload()};
a.prototype.uploadStatic=function(a,b,d){for(var c=0;c<this.staticProperties.length;c++){var f=this.staticProperties[c];f.uploadFunction(a,b,d,this.staticData,this.staticStride,f.offset)}this.staticBuffer.upload()};a.prototype.bind=function(){this.vao.bind()};a.prototype.destroy=function(){this.dynamicData=this.dynamicProperties=null;this.dynamicBuffer.destroy();this.staticData=this.staticProperties=null;this.staticBuffer.destroy()};return a}();d["default"]=a},{"../../core/utils/createIndicesForQuads":114,
"pixi-gl-core":12}],164:[function(a,b,d){function f(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}d.__esModule=!0;var k=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=
a[c]);b["default"]=a;return b}(a("../../core")),n=(b=a("./ParticleShader"))&&b.__esModule?b:{"default":b},h=(a=a("./ParticleBuffer"))&&a.__esModule?a:{"default":a};a=function(a){function b(c){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");c=a.call(this,c);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");c=!c||"object"!==typeof c&&"function"!==typeof c?this:c;c.shader=null;c.indexBuffer=null;c.properties=null;c.tempMatrix=
new k.Matrix;c.CONTEXT_UID=0;return c}f(b,a);b.prototype.onContextChange=function(){var a=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID;this.shader=new n["default"](a);this.properties=[{attribute:this.shader.attributes.aVertexPosition,size:2,uploadFunction:this.uploadVertices,offset:0},{attribute:this.shader.attributes.aPositionCoord,size:2,uploadFunction:this.uploadPosition,offset:0},{attribute:this.shader.attributes.aRotation,size:1,uploadFunction:this.uploadRotation,offset:0},{attribute:this.shader.attributes.aTextureCoord,
size:2,uploadFunction:this.uploadUvs,offset:0},{attribute:this.shader.attributes.aColor,size:1,uploadFunction:this.uploadAlpha,offset:0}]};b.prototype.start=function(){this.renderer.bindShader(this.shader)};b.prototype.render=function(a){var b=a.children,d=a._maxSize,e=a._batchSize,f=b.length;if(0!==f){f>d&&(f=d);(d=a._glBuffers[this.renderer.CONTEXT_UID])||(d=a._glBuffers[this.renderer.CONTEXT_UID]=this.generateBuffers(a));this.renderer.setBlendMode(a.blendMode);var g=this.renderer.gl,h=a.worldTransform.copy(this.tempMatrix);
h.prepend(this.renderer._activeRenderTarget.projectionMatrix);this.shader.uniforms.projectionMatrix=h.toArray(!0);this.shader.uniforms.uAlpha=a.worldAlpha;this.renderer.bindTexture(b[0]._texture.baseTexture);for(var k=h=0;h<f;h+=e,k+=1){var m=f-h;m>e&&(m=e);var n=d[k];n.uploadDynamic(b,h,m);a._bufferToUpdate===k&&(n.uploadStatic(b,h,m),a._bufferToUpdate=k+1);n.vao.bind().draw(g.TRIANGLES,6*m).unbind()}}};b.prototype.generateBuffers=function(a){var b=this.renderer.gl,d=[],e=a._maxSize,f=a._batchSize;
a=a._properties;for(var g=0;g<e;g+=f)d.push(new h["default"](b,this.properties,a,f));return d};b.prototype.uploadVertices=function(a,b,d,e,f,g){for(var h,k,m,n,u=0;u<d;++u){n=a[b+u];h=n._texture;var w=n.scale.x,B=n.scale.y;m=h.trim;var G=h.orig;m?(k=m.x-n.anchor.x*G.width,h=k+m.width,n=m.y-n.anchor.y*G.height,m=n+m.height):(h=G.width*(1-n.anchor.x),k=G.width*-n.anchor.x,m=G.height*(1-n.anchor.y),n=G.height*-n.anchor.y);e[g]=k*w;e[g+1]=n*B;e[g+f]=h*w;e[g+f+1]=n*B;e[g+2*f]=h*w;e[g+2*f+1]=m*B;e[g+3*
f]=k*w;e[g+3*f+1]=m*B;g+=4*f}};b.prototype.uploadPosition=function(a,b,d,e,f,g){for(var h=0;h<d;h++){var k=a[b+h].position;e[g]=k.x;e[g+1]=k.y;e[g+f]=k.x;e[g+f+1]=k.y;e[g+2*f]=k.x;e[g+2*f+1]=k.y;e[g+3*f]=k.x;e[g+3*f+1]=k.y;g+=4*f}};b.prototype.uploadRotation=function(a,b,d,e,f,g){for(var h=0;h<d;h++){var k=a[b+h].rotation;e[g]=k;e[g+f]=k;e[g+2*f]=k;e[g+3*f]=k;g+=4*f}};b.prototype.uploadUvs=function(a,b,d,e,f,g){for(var h=0;h<d;++h){var k=a[b+h]._texture._uvs;k?(e[g]=k.x0,e[g+1]=k.y0,e[g+f]=k.x1,e[g+
f+1]=k.y1,e[g+2*f]=k.x2,e[g+2*f+1]=k.y2,e[g+3*f]=k.x3,e[g+3*f+1]=k.y3):(e[g]=0,e[g+1]=0,e[g+f]=0,e[g+f+1]=0,e[g+2*f]=0,e[g+2*f+1]=0,e[g+3*f]=0,e[g+3*f+1]=0);g+=4*f}};b.prototype.uploadAlpha=function(a,b,d,e,f,g){for(var h=0;h<d;h++){var k=a[b+h].alpha;e[g]=k;e[g+f]=k;e[g+2*f]=k;e[g+3*f]=k;g+=4*f}};b.prototype.destroy=function(){this.renderer.gl&&this.renderer.gl.deleteBuffer(this.indexBuffer);a.prototype.destroy.call(this);this.shader.destroy();this.tempMatrix=this.indices=null};return b}(k.ObjectRenderer);
d["default"]=a;k.WebGLRenderer.registerPlugin("particle",a)},{"../../core":62,"./ParticleBuffer":163,"./ParticleShader":165}],165:[function(a,b,d){function f(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}d.__esModule=!0;a=a("../../core/Shader");
a=function(a){function b(d){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");d=a.call(this,d,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute float aColor;\nattribute vec2 aPositionCoord;\nattribute vec2 aScale;\nattribute float aRotation;\nuniform mat3 projectionMatrix;\nvarying vec2 vTextureCoord;\nvarying float vColor;\nvoid main(void){\n   vec2 v = aVertexPosition;\n   v.x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n   v.y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n   v = v + aPositionCoord;\n   gl_Position = vec4((projectionMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vColor = aColor;\n}",
"varying vec2 vTextureCoord;\nvarying float vColor;\nuniform sampler2D uSampler;\nuniform float uAlpha;\nvoid main(void){\n  vec4 color = texture2D(uSampler, vTextureCoord) * vColor * uAlpha;\n  if (color.a == 0.0) discard;\n  gl_FragColor = color;\n}");if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!d||"object"!==typeof d&&"function"!==typeof d?this:d}f(b,a);return b}((a&&a.__esModule?a:{"default":a})["default"]);d["default"]=a},{"../../core/Shader":42}],
166:[function(a,b,d){Math.sign||(Math.sign=function(a){a=Number(a);return 0===a||isNaN(a)?a:0<a?1:-1})},{}],167:[function(a,b,d){a=(a=a("object-assign"))&&a.__esModule?a:{"default":a};Object.assign||(Object.assign=a["default"])},{"object-assign":5}],168:[function(a,b,d){a("./Object.assign");a("./requestAnimationFrame");a("./Math.sign");window.ArrayBuffer||(window.ArrayBuffer=Array);window.Float32Array||(window.Float32Array=Array);window.Uint32Array||(window.Uint32Array=Array);window.Uint16Array||
(window.Uint16Array=Array)},{"./Math.sign":166,"./Object.assign":167,"./requestAnimationFrame":169}],169:[function(a,b,d){(function(a){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()});a.performance&&a.performance.now||function(){var b=Date.now();a.performance||(a.performance={});a.performance.now=function(){return Date.now()-b}}();for(var b=Date.now(),d=["ms","moz","webkit","o"],h=0;h<d.length&&!a.requestAnimationFrame;++h){var e=d[h];a.requestAnimationFrame=a[e+
"RequestAnimationFrame"];a.cancelAnimationFrame=a[e+"CancelAnimationFrame"]||a[e+"CancelRequestAnimationFrame"]}a.requestAnimationFrame||(a.requestAnimationFrame=function(a){if("function"!==typeof a)throw new TypeError(a+"is not a function");var c=Date.now(),d=16+b-c;0>d&&(d=0);b=c;return setTimeout(function(){b=Date.now();a(performance.now())},d)});a.cancelAnimationFrame||(a.cancelAnimationFrame=function(a){return clearTimeout(a)})}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?
self:"undefined"!==typeof window?window:{})},{}],170:[function(a,b,d){function f(a,b){if(b instanceof n.BaseTexture){var c=b.source;a.ctx.drawImage(c,0,0,0===c.width?a.canvas.width:Math.min(a.canvas.width,c.width),0===c.height?a.canvas.height:Math.min(a.canvas.height,c.height),0,0,a.canvas.width,a.canvas.height);return!0}return!1}function k(a,b){if(a instanceof n.BaseTexture)return-1===b.indexOf(a)&&b.push(a),!0;if(a._texture&&a._texture instanceof n.Texture){var c=a._texture.baseTexture;-1===b.indexOf(c)&&
b.push(c);return!0}return!1}d.__esModule=!0;var n=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b["default"]=a;return b}(a("../../core")),h=n.ticker.shared;a=function(){function a(b){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.renderer=b;this.canvas=document.createElement("canvas");this.canvas.width=16;this.canvas.height=16;this.ctx=this.canvas.getContext("2d");this.queue=
[];this.addHooks=[];this.uploadHooks=[];this.completes=[];this.ticking=!1;this.register(k,f)}a.prototype.upload=function(b,c){"function"===typeof b&&(c=b,b=null);b&&this.add(b);this.queue.length?(this.numLeft=a.UPLOADS_PER_FRAME,c&&this.completes.push(c),this.ticking||(this.ticking=!0,h.add(this.tick,this))):c&&c()};a.prototype.tick=function(){for(;this.queue.length&&0<this.numLeft;){for(var b=this.queue[0],c=!1,d=0,f=this.uploadHooks.length;d<f;d++)if(this.uploadHooks[d](this,b)){this.numLeft--;
this.queue.shift();c=!0;break}c||this.queue.shift()}if(this.queue.length)this.numLeft=a.UPLOADS_PER_FRAME;else for(this.ticking=!1,h.remove(this.tick,this),b=this.completes.slice(0),c=this.completes.length=0,d=b.length;c<d;c++)b[c]()};a.prototype.register=function(a,b){a&&this.addHooks.push(a);b&&this.uploadHooks.push(b);return this};a.prototype.add=function(a){for(var b=0,d=this.addHooks.length;b<d&&!this.addHooks[b](a,this.queue);b++);if(a instanceof n.Container)for(b=a.children.length-1;0<=b;b--)this.add(a.children[b]);
return this};a.prototype.destroy=function(){this.ticking&&h.remove(this.tick,this);this.ticking=!1;this.canvas=this.ctx=this.queue=this.completes=this.renderer=this.uploadHooks=this.addHooks=null};return a}();d["default"]=a;a.UPLOADS_PER_FRAME=4;n.CanvasRenderer.registerPlugin("prepare",a)},{"../../core":62}],171:[function(a,b,d){d.__esModule=!0;var f=a("./webgl/WebGLPrepare");Object.defineProperty(d,"webgl",{enumerable:!0,get:function(){return(f&&f.__esModule?f:{"default":f})["default"]}});var k=
a("./canvas/CanvasPrepare");Object.defineProperty(d,"canvas",{enumerable:!0,get:function(){return(k&&k.__esModule?k:{"default":k})["default"]}})},{"./canvas/CanvasPrepare":170,"./webgl/WebGLPrepare":172}],172:[function(a,b,d){function f(a,b){return b instanceof e.BaseTexture?(a.textureManager.updateTexture(b),!0):!1}function k(a,b){return b instanceof e.Graphics?(a.plugins.graphics.updateGraphics(b),!0):!1}function n(a,b){if(a instanceof e.BaseTexture)return-1===b.indexOf(a)&&b.push(a),!0;if(a._texture&&
a._texture instanceof e.Texture){var d=a._texture.baseTexture;-1===b.indexOf(d)&&b.push(d);return!0}return!1}function h(a,b){return a instanceof e.Graphics?(b.push(a),!0):!1}d.__esModule=!0;var e=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b["default"]=a;return b}(a("../../core")),g=e.ticker.shared;a=function(){function a(b){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.renderer=
b;this.queue=[];this.addHooks=[];this.uploadHooks=[];this.completes=[];this.ticking=!1;this.register(n,f).register(h,k)}a.prototype.upload=function(b,d){"function"===typeof b&&(d=b,b=null);b&&this.add(b);this.queue.length?(this.numLeft=a.UPLOADS_PER_FRAME,d&&this.completes.push(d),this.ticking||(this.ticking=!0,g.add(this.tick,this))):d&&d()};a.prototype.tick=function(){for(;this.queue.length&&0<this.numLeft;){for(var b=this.queue[0],d=!1,e=0,f=this.uploadHooks.length;e<f;e++)if(this.uploadHooks[e](this.renderer,
b)){this.numLeft--;this.queue.shift();d=!0;break}d||this.queue.shift()}if(this.queue.length)this.numLeft=a.UPLOADS_PER_FRAME;else for(this.ticking=!1,g.remove(this.tick,this),b=this.completes.slice(0),d=this.completes.length=0,e=b.length;d<e;d++)b[d]()};a.prototype.register=function(a,b){a&&this.addHooks.push(a);b&&this.uploadHooks.push(b);return this};a.prototype.add=function(a){for(var b=0,c=this.addHooks.length;b<c&&!this.addHooks[b](a,this.queue);b++);if(a instanceof e.Container)for(b=a.children.length-
1;0<=b;b--)this.add(a.children[b]);return this};a.prototype.destroy=function(){this.ticking&&g.remove(this.tick,this);this.ticking=!1;this.queue=this.completes=this.renderer=this.uploadHooks=this.addHooks=null};return a}();d["default"]=a;a.UPLOADS_PER_FRAME=4;e.WebGLRenderer.registerPlugin("prepare",a)},{"../../core":62}],173:[function(a,b,d){(function(b){function k(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b["default"]=
a;return b}d.__esModule=!0;d.loader=d.prepare=d.particles=d.mesh=d.loaders=d.interaction=d.filters=d.extras=d.extract=d.accessibility=void 0;var m=a("./deprecation");Object.keys(m).forEach(function(a){"default"!==a&&"__esModule"!==a&&Object.defineProperty(d,a,{enumerable:!0,get:function(){return m[a]}})});var h=a("./core");Object.keys(h).forEach(function(a){"default"!==a&&"__esModule"!==a&&Object.defineProperty(d,a,{enumerable:!0,get:function(){return h[a]}})});a("./polyfill");var e=a("./accessibility"),
e=k(e),g=a("./extract"),g=k(g),c=a("./extras"),c=k(c),p=a("./filters"),p=k(p),y=a("./interaction"),y=k(y),q=a("./loaders"),q=k(q),A=a("./mesh"),A=k(A),z=a("./particles"),z=k(z),t=a("./prepare"),t=k(t);d.accessibility=e;d.extract=g;d.extras=c;d.filters=p;d.interaction=y;d.loaders=q;d.mesh=A;d.particles=z;d.prepare=t;e=new q.Loader;d.loader=e;b.PIXI=d}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./accessibility":41,"./core":62,
"./deprecation":119,"./extract":121,"./extras":130,"./filters":141,"./interaction":147,"./loaders":150,"./mesh":159,"./particles":162,"./polyfill":168,"./prepare":171}]},{},[173])(173)});PIXI.TransparencyHitArea=function(b){this.sprite=b};PIXI.TransparencyHitArea.create=function(b,a){var m;m=a?new PIXI.WebGLTransparencyHitArea(b):new PIXI.CanvasTransparencyHitArea(b);m.init();return m};PIXI.TransparencyHitArea.prototype.init=function(){};
PIXI.TransparencyHitArea.prototype.contains=function(b,a){if(0===Math.abs(this.sprite.width)||0===Math.abs(this.sprite.height))return!1;var m=this.sprite.texture.frame.width,d=this.sprite.texture.frame.height;b+=this.sprite.anchor.x*m;a+=this.sprite.anchor.y*d;return 0<=b&&b<=m&&0<=a&&a<=d?!this.isTextureTransparentAt(Math.round(b+this.sprite.texture.frame.x),Math.round(a+this.sprite.texture.frame.y)):!1};PIXI.TransparencyHitArea.prototype.getTexture=function(){return this.sprite.texture};
PIXI.CanvasTransparencyHitArea=function(b){PIXI.TransparencyHitArea.call(this,b);this.textureWidth=this.textureData=null};PIXI.CanvasTransparencyHitArea.prototype=Object.create(PIXI.TransparencyHitArea.prototype);PIXI.CanvasTransparencyHitArea.constructor=PIXI.CanvasTransparencyHitArea;PIXI.CanvasTransparencyHitArea.prototype.clone=function(){return new PIXI.CanvasTransparencyHitArea(this.sprite)};
PIXI.CanvasTransparencyHitArea.prototype.init=function(){PIXI.TransparencyHitArea.prototype.init.call(this);null===PIXI.CanvasTransparencyHitArea.cachedRenderer&&(PIXI.CanvasTransparencyHitArea.cachedRenderer=new PIXI.CanvasRenderer(1,1));this.initTextureData()};
PIXI.CanvasTransparencyHitArea.prototype.initTextureData=function(){if(!this.textureData){var b=this.getTexture(),a=b.baseTexture.source;this.textureWidth=a.width;a=a.src;void 0===PIXI.CanvasTransparencyHitArea.TextureData[a]&&(b=this.createTextureData(b),PIXI.CanvasTransparencyHitArea.TextureData[a]=b);this.textureData=PIXI.CanvasTransparencyHitArea.TextureData[a]}};
PIXI.CanvasTransparencyHitArea.prototype.createTextureData=function(b){b=b.baseTexture.source;var a=PIXI.CanvasTransparencyHitArea.cachedRenderer,m=a.view;m.width=b.width;m.height=b.height;a=a.view.getContext("2d");a.clearRect(0,0,b.width,b.height);a.drawImage(b,0,0);return a.getImageData(0,0,b.width,b.height).data};
PIXI.CanvasTransparencyHitArea.prototype.isTextureTransparentAt=function(b,a){if(!this.textureData)throw Error("CanvasTransparencyHitArea#init() not called.");return 1>this.textureData[4*(b+a*this.textureWidth)+3]};PIXI.CanvasTransparencyHitArea.TextureData=[];PIXI.CanvasTransparencyHitArea.cachedRenderer=null;PIXI.WebGLTransparencyHitArea=function(b){PIXI.TransparencyHitArea.call(this,b);this.textureWidth=this.textureData=null};PIXI.WebGLTransparencyHitArea.prototype=Object.create(PIXI.TransparencyHitArea.prototype);
PIXI.WebGLTransparencyHitArea.constructor=PIXI.WebGLTransparencyHitArea;PIXI.WebGLTransparencyHitArea.prototype.clone=function(){return new PIXI.WebGLTransparencyHitArea(this.sprite)};PIXI.WebGLTransparencyHitArea.prototype.init=function(){PIXI.TransparencyHitArea.prototype.init.call(this);null===PIXI.WebGLTransparencyHitArea.cachedRenderer&&(PIXI.WebGLTransparencyHitArea.cachedRenderer=new PIXI.WebGLRenderer(1,1));this.initTextureData()};
PIXI.WebGLTransparencyHitArea.prototype.initTextureData=function(){if(!this.textureData){var b=this.getTexture(),a=b.baseTexture.source;this.textureWidth=a.width;a=a.src;void 0===PIXI.WebGLTransparencyHitArea.TextureData[a]&&(b=this.createTextureData(b),PIXI.WebGLTransparencyHitArea.TextureData[a]=b);this.textureData=PIXI.WebGLTransparencyHitArea.TextureData[a]}};
PIXI.WebGLTransparencyHitArea.prototype.createTextureData=function(b){var a=b.baseTexture.source,m=PIXI.WebGLTransparencyHitArea.cachedRenderer.view;m.width=a.width;m.height=a.height;var m=PIXI.WebGLTransparencyHitArea.cachedRenderer.gl,d=m.createFramebuffer();m.bindFramebuffer(m.FRAMEBUFFER,d);void 0===b.baseTexture._glTextures[m.id]&&PIXI.WebGLTransparencyHitArea.cachedRenderer.updateTexture(b.baseTexture);m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,b.baseTexture._glTextures[m.id],
0);b=new Uint8Array(a.width*a.height*4);try{m.readPixels(0,0,a.width,a.height,m.RGBA,m.UNSIGNED_BYTE,b)}catch(f){console.log(error)}m.bindFramebuffer(m.FRAMEBUFFER,null);return b};PIXI.WebGLTransparencyHitArea.prototype.isTextureTransparentAt=function(b,a){if(!this.textureData)throw Error("WebGLTransparencyHitArea#init() not called.");return 255>this.textureData[4*(b+a*this.textureWidth)+3]};PIXI.WebGLTransparencyHitArea.TextureData=[];PIXI.WebGLTransparencyHitArea.cachedRenderer=null;function getCurvePoints(b,a,m,d){function f(a,b,c,d){for(var f=2,h;f<c;f+=2){var k=a[f],n=a[f+1],p=a[f+2],q=a[f+3],y=(p-a[f-2])*d,t=(q-a[f-1])*d,z=(a[f+4]-k)*d,A=(a[f+5]-n)*d,O=0,N,R,E,D;for(h=0;h<m;h++)N=b[O++],R=b[O++],E=b[O++],D=b[O++],g[e++]=N*k+R*p+E*y+D*z,g[e++]=N*n+R*q+E*t+D*A}}a="number"===typeof a?a:.5;m="number"===typeof m?m:25;var k,n=1,h=b.length,e=0,g=new Float32Array((h-2)*m+2+(d?2*m:0)),c=new Float32Array(4*(m+2)),p=4;k=b.slice(0);d?(k.unshift(b[h-1]),k.unshift(b[h-2]),k.push(b[0],
b[1])):(k.unshift(b[1]),k.unshift(b[0]),k.push(b[h-2],b[h-1]));for(c[0]=1;n<m;n++){var y=n/m,q=y*y,A=q*y,z=2*A,t=3*q;c[p++]=z-t+1;c[p++]=t-z;c[p++]=A-2*q+y;c[p++]=A-q}c[++p]=1;f(k,c,h,a);d&&(k=[],k.push(b[h-4],b[h-3],b[h-2],b[h-1],b[0],b[1],b[2],b[3]),f(k,c,4,a));h=d?0:b.length-2;g[e++]=b[h++];g[e]=b[h];return g}"undefined"!==typeof exports&&(exports.getCurvePoints=getCurvePoints);var servers=$("#socket_io_servers").attr("data-socket_io_servers").split(","),game=$("meta[name=game]").attr("content"),is_video_replay=!1;-1!=location.pathname.indexOf(game+"3")&&(is_video_replay=!0);var image_host;function is_safari(){return navigator.vendor&&-1<navigator.vendor.indexOf("Apple")}var static_host=$("#static_host").attr("data-static_host");image_host=is_safari()?"http://"+location.host+"/icons/":static_host+"/icons/";var asset_host=static_host+"/",loader=PIXI.loader,assets=[];
"wows"==game?(assets.push(image_host+"rotate.png"),assets.push(image_host+"bb.png",image_host+"cv.png",image_host+"ca.png",image_host+"dd.png"),assets.push(image_host+"circle.png",image_host+"recticle.png",image_host+"dot.png",image_host+"note.png",image_host+"cursor.png",image_host+"grid.png")):"blitz"==game?(assets.push(image_host+"rotate.png"),assets.push(image_host+"light.png",image_host+"medium.png",image_host+"heavy.png",image_host+"td.png",image_host+"arty.png"),assets.push(image_host+"circle.png",
image_host+"recticle.png",image_host+"dot.png",image_host+"note.png",image_host+"cursor.png",image_host+"grid.png")):"aw"==game?(assets.push(image_host+"rotate.png"),loader.add("aw_assets.png",asset_host+"aw_assets.png"),loader.add("aw_assets.json",asset_host+"aw_assets.json")):"lol"==game?(assets.push(image_host+"rotate.png"),assets.push(image_host+"circle.png",image_host+"recticle.png",image_host+"dot.png",image_host+"note.png",image_host+"cursor.png",image_host+"grid.png")):"hots"==game?(assets.push(image_host+
"rotate.png"),loader.add("hots_assets.png",asset_host+"hots_assets.png"),loader.add("hots_assets.json",asset_host+"hots_assets.json")):(assets.push(image_host+"rotate.png"),loader.add("wot_assets.png",asset_host+"wot_assets.png"),loader.add("wot_assets.json",asset_host+"wot_assets.json"));for(var i in assets)loader.add(assets[i],assets[i]);loader.load(setup_assets);var texture_atlas;
function setup_assets(){texture_atlas={};for(var b in loader.resources)if("json"==b.slice(-4))for(var a in loader.resources[b].data.tiles)texture_atlas[a]=loader.resources[b].data.tiles[a]}var room=location.search.split("room=")[1].split("&")[0],nowebgl=-1!=location.search.indexOf("nowebgl"),wot_live=-1!=location.search.indexOf("wot_live"),adjust_all_zoom=-1!=location.search.indexOf("adjust_zoom");function hashstring(b){var a=0;for(i=0;i<b.length;i++)a+=b.charCodeAt(i);return a}
var server=servers[hashstring(room)%servers.length];console.log("connecting to server: ",server);function parse_domain(b){b=b.split(".");2<b.length&&(b=b.slice(1));return"."+b.join(".")}var sid=$("#sid").attr("data-sid"),socket;try{socket=io.connect(server,{reconnectionDelay:100,reconnectionDelayMax:500,"reconnection limit":1E3,"max reconnection attempts":Infinity,query:"connect_sid="+sid+"&host="+parse_domain(location.hostname)})}catch(b){console.log(b)}var valid_chars="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";
function newUid(){for(var b="",a=0;14>a;a++)b+=valid_chars.charAt(Math.floor(Math.random()*valid_chars.length));return b}function is_chrome(){return-1<navigator.userAgent.toLowerCase().indexOf("chrome")}function is_firefox(){return-1<navigator.userAgent.toLowerCase().indexOf("firefox")}function is_ie(){return-1<navigator.userAgent.toLowerCase().indexOf("msie")||-1<navigator.userAgent.toLowerCase().indexOf("trident")}function is_edge(){return-1<navigator.userAgent.toLowerCase().indexOf("edge")}
var last=function(b){return b[b.length-1]};function random_darkish_color(){var b=Math.round(127*Math.random()).toString(16),a=Math.round(127*Math.random()).toString(16),m=Math.round(127*Math.random()).toString(16);return"#"+b+a+m}function random_color(){var b=Math.round(256*Math.random()).toString(16),a=Math.round(256*Math.random()).toString(16),m=Math.round(256*Math.random()).toString(16);return"#"+("00"+b.toString(16)).slice(-2)+("00"+a.toString(16)).slice(-2)+("00"+m.toString(16)).slice(-2)}
var ARROW_LOOKBACK=4,MOUSE_DRAW_SMOOTHING=.5,LEFT_BAR_MIN_WIDTH=340,RIGHT_BAR_MIN_WIDTH=302,SINGLE_SIDE_BAR_MIN_WIDTH;SINGLE_SIDE_BAR_MIN_WIDTH="blitz"==game?350:630;
var MIN_POLYGON_END_DISTANCE=.01,MIN_POLYGON_END_DISTANCE_TOUCH=.025,MIN_TRACK_MOVE_DISTANCE_SQ=1E-4,ICON_SCALE=.00125,NOTE_SCALE=.03,THICKNESS_SCALE=1,FONT_SCALE=.002,TEXT_QUALITY=8,DRAW_QUALITY=2,ARROW_SCALE=.008,ARROW_SCALE2=1.7,TEND_SCALE=.008,TEND_SCALE2=1.5,MAGIC_NUMBER=25,EPSILON=1E-9,ROTATE_ARROW_SCALE=.05,ROTATE_ARROW_MARGIN=.02,TEXT_BOX_QUALITY=4,VIDEO_EXTENSIONS=["mp4","webgl","avi"],VIDEO_SYNC_DELAY=1E4,MOUSE_IDLE_HIDE_TIME=5E3,MAX_CANVAS_SIZE=4096,ICON_LABEL_SCALE=1,TEXT_SCALE=.8,BACKGROUND_TEXT_SCALE=
.8,PING_TIME=500,dpi,chat_color=random_darkish_color(),room_data,active_slide=0,active_context="ping_context",active_menu="ping_context",userlist={},selected_icon,selected_icon_no_color=!1,label_position="pos_bottom",icon_extra_scale=1,icon_color=16711680,draw_color=16711680,ping_color=16711680,track_color=16711680,line_color=16711680,curve_color=16711680,text_color=16777215,background_text_color=0,rectangle_outline_color=16711680,rectangle_fill_color=16711680,circle_outline_color=16711680,circle_fill_color=
16711680,polygon_outline_color=16711680,polygon_fill_color=16711680,area_outline_color=16711680,area_fill_color=16711680,background,draw_thickness,curve_thickness,line_thickness,icon_size,ping_size,track_size,draw_end_size,line_end_size,curve_end_size,rectangle_outline_thickness,rectangle_outline_transparancy,rectangle_fill_transparancy,circle_outline_thickness,circle_outline_transparancy,circle_fill_transparancy,polygon_outline_thickness,polygon_outline_transparancy,polygon_fill_transparancy,area_outline_thickness,
area_outline_transparancy,area_fill_transparancy,my_user,undo_list=[],redo_list=[],is_room_locked,tactic_name="",graphics,new_drawing,left_click_origin,selected_entities=[],previously_selected_entities=[],label_font_size=30,last_ping_time,trackers={},my_tracker,last_track_position,tracker_width=.05,tracker_height=.05,my_user_id,clipboard=[],slide_name,assets_loaded=!1,select_alpha=.6,resources_loading=0,circle_draw_style="edge",drag_delay_running=!1,current_text_element,last_mouse_location,ping_texture,
just_activated,select_box,rotate_arrow0,rotate_arrow1,rotate_arrow2,rotate_arrow3,select_box_dirty=!1,select_center,objectContainer,fast_container,background_sprite,renderer,size,size_x,size_y,useWebGL,last_pan_loc,panning,last_move_func,last_end_func,draw_canvas,temp_draw_canvas,draw_context,temp_draw_context,grid_layer,zoom_level=1,control_camera=!1,dragging_enabled=!0,temp_canvas=document.createElement("canvas"),offset=0,sync_start_time,progress=0,progress_update=Date.now(),video_layer,manual_pause=
!1,sync_seek=!1,sync_event,clock_sync_event,last_video_sync=null,timeline,timeline_entities={},video_ready=!1,video_paused=!0,initiated_play=!1,im_syncing=!1,idleMouseTimer,playback_rate=1,base_playback_rate=1,mouse_down_interrupted;document.body.onmouseup=function(){mouse_down_interrupted=!0};var shifted;
$(document).on("keyup keydown",function(b){can_edit()&&(shifted=b.shiftKey,"input"!=document.activeElement.localName&&("keydown"==b.type?b.ctrlKey?90==b.keyCode?undo():89==b.keyCode?redo():65==b.keyCode?(select_all(),b.preventDefault()):83==b.keyCode?my_user.logged_in&&tactic_name&&""!=tactic_name&&socket&&socket.emit("store",room,tactic_name):67==b.keyCode?copy():88==b.keyCode?cut():86==b.keyCode&&paste():32==b.keyCode&&video_layer&&can_edit()&&(toggle_play(),b.preventDefault()):"keyup"==b.type&&
(46==b.keyCode?clear_selected():16==b.keyCode&&"line_context"==active_context&&new_drawing&&on_line_end(b))))});function cut(){copy();clear_selected()}function copy(){clipboard=[];for(var b in selected_entities){var a=selected_entities[b].container;selected_entities[b].container=null;clipboard.push(JSON.parse(JSON.stringify(selected_entities[b])));selected_entities[b].container=a}}
function paste(){if(0!=clipboard.length){deselect_all();var b=renderer.plugins.interaction.eventData.data.global,a=from_x_local(b.x),b=from_y_local(b.y);if(1<Math.abs(a)||1<Math.abs(b))a=b=0;var m=1,d=1,f;for(f in clipboard)m=Math.min(m,clipboard[f].y),d=Math.min(d,clipboard[f].x);var k=[];for(f in clipboard){var n=JSON.parse(JSON.stringify(clipboard[f]));n.uid=newUid();n.x=a+(n.x-d);n.y=b+(n.y-m);k.push(n);create_entity(n);snap_and_emit_entity(n);selected_entities.push(n);render_scene()}select_entities();
undo_list.push(clone_action(["add",k]))}}
function adjust_zoom(b){if(b.draw_zoom_level&&(adjust_all_zoom||"icon"==b.type)){var a=zoom_level/b.draw_zoom_level;switch(b.type){case "icon":case "note":b.container.scale.x=b.container.orig_scale[0]*a;b.container.scale.y=b.container.orig_scale[1]*a;break;case "text":case "background_text":set_anchor(b.container,0,0);b.container.scale.x=b.container.orig_scale[0]*a;b.container.scale.y=b.container.orig_scale[1]*a;set_anchor(b.container,.5,.5);break;case "drawing":remove(b.uid);create_drawing2(b,1*
DRAW_QUALITY/a,a);break;case "curve":remove(b.uid);create_curve2(b,1*DRAW_QUALITY/a,a);break;case "line":remove(b.uid);create_line2(b,1*DRAW_QUALITY/a,a);break;case "rectangle":remove(b.uid);create_rectangle2(b,1*DRAW_QUALITY/a,a);break;case "circle":remove(b.uid);create_circle2(b,1*DRAW_QUALITY/a,a);break;case "polygon":remove(b.uid);create_polygon2(b,1*DRAW_QUALITY/a,a);break;case "area":remove(b.uid),create_area2(b,1*DRAW_QUALITY/a,a)}}}
function zoom(b,a,m,d){b=1+b*(a?1:-1);objectContainer.scale.x*=b;objectContainer.scale.y*=b;objectContainer.x-=x_abs(m[0]*(1-1/b)*objectContainer.scale.x);objectContainer.y-=y_abs(m[1]*(1-1/b)*objectContainer.scale.y);correct();zoom_level=size_y/(background_sprite.height*objectContainer.scale.y);if(room_data)for(var f in room_data.slides[active_slide].entities)m=room_data.slides[active_slide].entities[f],m.container&&m.draw_zoom_level&&adjust_zoom(m)}
function emit_pan_zoom(){socket.emit("pan_zoom",room,zoom_level,from_x_local_vect(objectContainer.x),from_y_local_vect(objectContainer.y))}function pan_zoom(b,a,m){b=zoom_level/b;objectContainer.scale.x*=b;objectContainer.scale.y*=b;objectContainer.x=to_x_local_vect(a);objectContainer.y=to_y_local_vect(m);zoom_level=size_y/(background_sprite.height*objectContainer.scale.y);$("#zoom_level").text((1/zoom_level).toFixed(2));render_scene()}
function correct(){objectContainer.x=Math.min(0,objectContainer.x);objectContainer.y=Math.min(0,objectContainer.y);background_sprite.width*objectContainer.scale.x+objectContainer.x<renderer.view.width&&(objectContainer.x=Math.min(0,renderer.view.width-background_sprite.width*objectContainer.scale.x),0==objectContainer.x&&(objectContainer.scale.x=renderer.view.width/background_sprite.width));background_sprite.height*objectContainer.scale.y+objectContainer.y<renderer.view.height&&(objectContainer.y=
Math.min(0,renderer.view.height-background_sprite.height*objectContainer.scale.y),0==objectContainer.y&&(objectContainer.scale.y=renderer.view.height/background_sprite.height));objectContainer.scale.y!=objectContainer.scale.x&&(objectContainer.scale.x=Math.max(objectContainer.scale.x,objectContainer.scale.y),objectContainer.scale.y=Math.max(objectContainer.scale.x,objectContainer.scale.y));if(room_data)for(var b in room_data.slides[active_slide].entities)room_data.slides[active_slide].entities[b]&&
"note"==room_data.slides[active_slide].entities[b].type&&align_note_text(room_data.slides[active_slide].entities[b]);my_tracker&&on_track_move();render_scene()}var pan_state={};function on_pan(b){limit_rate(15,pan_state,function(){var a=renderer.plugins.interaction.eventData.data.global,b=a.x-last_pan_loc[0],d=a.y-last_pan_loc[1];last_pan_loc=[a.x,a.y];objectContainer.x+=b;objectContainer.y+=d;correct()})}
function resize_renderer(b,a){if(video_layer){var m=b*(1-(0<video_layer[0].videoWidth?video_layer[0].videoWidth/video_layer[0].videoHeight:16/9)/(b/a))/2;$("#edit_window").css("left",""+m+"px");b-=2*m;video_layer.width(b);video_layer.height(a)}else $("#edit_window").css("left","0px");m=size_y;size_x=b;size_y=a;draw_canvas.width=b*DRAW_QUALITY;draw_canvas.height=a*DRAW_QUALITY;temp_draw_canvas.width=b*DRAW_QUALITY;temp_draw_canvas.height=a*DRAW_QUALITY;$(draw_canvas).css("width",""+b+"px");$(draw_canvas).css("height",
""+a+"px");$(temp_draw_canvas).css("width",""+b+"px");$(temp_draw_canvas).css("height",""+a+"px");objectContainer.scale.x*=size_y/m;objectContainer.scale.y*=size_y/m;$("#edit_window").css("width",""+b+"px");$("#edit_window").css("height",""+a+"px");renderer.resize(b,a);grid_layer.width=background_sprite.width;grid_layer.height=background_sprite.height;renderer.plugins.interaction.eventData.data&&(m=renderer.plugins.interaction.eventData.data.global,zoom(0,!0,[from_x_local(m.x),from_y_local(m.y)]))}
window.onresize=function(){change_background_dim(renderer.view.height);if(is_video_replay)resize_renderer($(window).width(),$(window).height());else{var b=1;background_sprite.texture&&(b=background_sprite.texture.width/background_sprite.texture.height);var a;a=$("#single_side_bar").length?SINGLE_SIDE_BAR_MIN_WIDTH:LEFT_BAR_MIN_WIDTH+RIGHT_BAR_MIN_WIDTH;if(a<window.innerWidth/2){var m;$("#left_side_bar").length&&($("#left_side_bar").detach().prependTo($("body")),$("#map_select_box").prependTo($("#map_select_section")),
$("#home_button").prependTo($("#left_navbar")));m=window.innerHeight-5;var d=m*b;d+a+MAGIC_NUMBER>window.innerWidth&&(d=window.innerWidth-a-MAGIC_NUMBER,m=d/b)}else $("#left_side_bar").length&&($("#left_side_bar").detach().appendTo($("body")),$("#map_select_box").prependTo($(".left_column")),$("#home_button").prependTo($("#right-buttons")),a=RIGHT_BAR_MIN_WIDTH),d=window.innerWidth-a,m=d/b,d<RIGHT_BAR_MIN_WIDTH&&(d=window.innerWidth,m=d/b),m>window.innerHeight&&(m=window.innerHeight,d=m*b);resize_renderer(d,
m);render_scene()}};function x_rel(b){return b/background_sprite.height}function x_abs(b){return b*background_sprite.height}function y_rel(b){return b/background_sprite.height}function y_abs(b){return b*background_sprite.height}function to_x_local(b){return objectContainer.x+b*background_sprite.height*objectContainer.scale.x}function to_x_local_vect(b){return b*background_sprite.height*objectContainer.scale.x}
function from_x_local(b){return(b-objectContainer.x)/objectContainer.scale.x/background_sprite.height}function from_x_local_vect(b){return b/objectContainer.scale.x/background_sprite.height}function to_y_local(b){return objectContainer.y+b*background_sprite.height*objectContainer.scale.y}function to_y_local_vect(b){return b*background_sprite.height*objectContainer.scale.y}function from_y_local(b){return(b-objectContainer.y)/objectContainer.scale.y/background_sprite.height}
function from_y_local_vect(b){return b/objectContainer.scale.y/background_sprite.height}function mouse_x_abs(b){return b}function mouse_y_abs(b){return b}function mouse_x_rel(b){return b/(background_sprite.height/background_sprite.scale.x)}function mouse_y_rel(b){return b/(background_sprite.height/background_sprite.scale.y)}function is_video(b){return""!=get_video_type(b)}
function get_video_type(b){for(var a=b.split(".").pop(),m=0;m<VIDEO_EXTENSIONS.length;m++)if(a.startsWith(VIDEO_EXTENSIONS[m]))return"video/"+VIDEO_EXTENSIONS[m];return-1!=b.toUpperCase().indexOf("YOUTUBE")?"video/youtube":-1!=b.toUpperCase().indexOf("VIMEO")?"video/vimeo":""}
function reset_background(){background_sprite.alpha=1;video_ready=!1;video_media&&video_media.setCurrentTime(0);video_player&&(video_player.pause(),video_player.remove());$("#video_player")&&$("#video_player").remove();video_layer=null;$("#left_detect").unbind("mouseenter");$("#right_detect").unbind("mouseenter");$("#left_side_bar").unbind("mouseleave");$("#right_side_bar").unbind("mouseleave");$("#left_side_bar").show();$("#right_side_bar").show();clearTimeout(idleMouseTimer)}var video_player,video_media;
function init_video_controls(){$("#left_detect").mouseenter(function(){$("#left_side_bar").show()});$("#right_detect").mouseenter(function(){$("#right_side_bar").show()});$("#left_side_bar").mouseleave(function(){$("#left_side_bar").hide()});$("#right_side_bar").mouseleave(function(){$("#right_side_bar").hide()});$("#left_side_bar").hide();$("#right_side_bar").hide()}
function start_syncing(){clearInterval(sync_event);im_syncing=!0;for(var b=0;5>b;b++)setTimeout(function(){var a=video_progress();socket.emit("sync_video",room,a,get_server_time())},2E3*b);sync_event=setInterval(function(){var a=video_progress();socket.emit("sync_video",room,a,get_server_time())},1E4)}
function play_video_controls(){$(".mejs-controls").mouseenter(function(){$(".mejs-controls").css("opacity",1)});$(".mejs-controls").mouseleave(function(){$(".mejs-controls").css("opacity",0)});$(".mejs-controls").css("opacity",0);can_edit()?$(".mejs-controls").show():$(".mejs-controls").hide()}function pause_video_controls(){$(".mejs-controls").unbind("mouseenter");$(".mejs-controls").unbind("mouseleave");$(".mejs-controls").css("opacity",1)}
function toggle_play(){if(background.is_video)if(video_paused){var b=video_progress();socket.emit("play_video",room,b,base_playback_rate);initiated_play=!0;play_video_controls();start_syncing()}else manual_pause=!0,video_player.pause(),pause_video_controls()}var ignore_jump=!1;
function init_video_triggers(){video_media.addEventListener("pause",function(b){manual_pause&&(clearInterval(sync_event),im_syncing=!1,video_paused=!0,socket.emit("pause_video",room,video_progress()),manual_pause=!1)});video_media.addEventListener("play",function(b){window.onresize();initiated_play?(start_syncing(),initiated_play=!1):stop_syncing();video_paused&&(video_player.pause(),video_media.currentTime=last_video_sync?last_video_sync[0]:0,video_player.pause())});video_media.addEventListener("ended",
function(b){im_syncing&&socket.emit("pause_video",room,0)});video_media.addEventListener("canplay",function(b){window.onresize()});video_media.addEventListener("timeupdate",function(b){progress=video_media.currentTime;progress_update=Date.now()});$(".mejs-playpause-button").unbind("click");$(".mejs-playpause-button").click(function(b){toggle_play();b.preventDefault();return!1});$(".mejs-time-rail").on("mousedown",function(){wait_for_seek(function(){socket.emit("seek_video",room,video_progress(),get_server_time());
video_paused||start_syncing();rebuild_timeline()})})}function wait_for_seek(b){var a=Date.now(),m=video_progress(),d=setInterval(function(){video_progress();.05<Math.abs(video_progress()-(m+(Date.now()-a)/1E3))&&(b(),clearInterval(d));1E4<Date.now()-a&&clearInterval(d)},5)}
function change_background_dim(b){var a=zoom_level,m=background_sprite.texture.width/background_sprite.texture.height,d=background_sprite.height;background_sprite.width=b*m;background_sprite.height=b;grid_layer.width=background_sprite.width;grid_layer.height=background_sprite.height;m=b/d;if(1!=m&&room_data)for(var f in room_data.slides[active_slide].entities)b=room_data.slides[active_slide].entities[f],b.container&&(b.container.x*=m,b.container.y*=m,b.container.width*=m,b.container.height*=m);zoom_level=
size_y/(background_sprite.height*objectContainer.scale.y);pan_zoom(a,from_x_local_vect(objectContainer.x),from_y_local_vect(objectContainer.y))}
function set_background(b,a){if(""!=b.path)if(b.is_video){reset_background();background_sprite.alpha=0;background=b;history[background.uid]=background;add_custom_map(background.path);$("#wotbase_map_select_container").hide();$("#map_select_container").show();var m=get_video_type(b.path);video_layer=$("<video />",{id:"video_player",autoplay:!1,controls:!0});$("<source />",{type:m,src:b.path}).appendTo(video_layer);video_layer.appendTo($("#video_div"));video_layer.mediaelementplayer({videoHeight:"100%",
loop:!1,autoPlay:!1,enableAutosize:!0,alwaysShowControls:!0,speeds:"0.25 0.50 1.00 1.25 1.50 2.00".split(" "),defaultSpeed:"1.00",speedChar:"x",features:"playpause speed progress current duration tracks volume".split(" "),success:function(b,d,e){video_media=b;video_paused=!room_data.playing;video_player=e;"video/youtube"==m&&video_media.pluginApi.pauseVideo();init_video_controls();$(".mejs-controls").css("z-index",9);$(".mejs-controls").css("position","fixed");$(".mejs-controls").css("left","0px");
$(".mejs-controls").css("bottom","0px");$(".mejs-controls").css("height","3%");init_video_triggers();timeline=new FastPriorityQueue;video_ready=!0;room_data.playing?room_data.last_sync?handle_play(room_data.last_sync[0],Date.now()):handle_play(0,Date.now()):room_data.last_sync&&(video_media.setCurrentTime(room_data.last_sync[0]),video_player.pause());"youtube"==video_media.pluginType&&(b=video_media.pluginType,video_player.options.speeds=video_media.pluginApi.getAvailablePlaybackRates().map(function(a){return a.toFixed(2)}),
video_player.options.defaultSpeed="1.00",video_media.pluginType="native",video_player.buildspeed(e,e.controls,e.layers,e.media),$(".mejs-playpause-button").after($(".mejs-speed-button")),video_media.pluginType=b);playback_rate=base_playback_rate=1;$(".mejs-speed-button").find(".mejs-speed-selector").on("click",'input[type="radio"]',function(){var a=parseFloat($(this).attr("value"));socket.emit("change_rate",room,a);set_playback_rate(a,a);start_syncing()});var f=!1;$(renderer.view).css("cursor","none");
$(renderer.view).mousemove(function(a){f||($(renderer.view).css("cursor","default"),clearTimeout(idleMouseTimer),idleMouseTimer=setTimeout(function(){$(renderer.view).css("cursor","none");f=!0;setTimeout(function(){f=!1},200)},MOUSE_IDLE_HIDE_TIME))});socket.emit("request_sync",room);window.onresize();render_scene();a&&a(!0)}})}else{resources_loading++;var d=PIXI.Texture.fromImage(b.path),f=function(){reset_background();background=b;history[background.uid]=background;background_sprite.texture=d;room_data.slides[active_slide].entities[b.uid]=
b;resources_loading--;0<$("#map_select option[value='"+background.path+"']").length?($("#map_select").val(background.path).change(),$("#select_hd").prop("checked",!0),$("#map_select_container").show(),$("#wotbase_select_container").hide(),$("#new_minimap_select_container").hide()):0<$("#wotbase_select option[value='"+background.path+"']").length?($("#wotbase_select").val(background.path).change(),$("#select_wotbase").prop("checked",!0),$("#map_select_container").hide(),$("#wotbase_select_container").show(),
$("#new_minimap_select_container").hide()):0<$("#new_minimap_select option[value='"+background.path+"']").length?($("#new_minimap_select").val(background.path).change(),$("#select_new_minimap").prop("checked",!0),$("#map_select_container").hide(),$("#wotbase_select_container").hide(),$("#new_minimap_select_container").show()):(add_custom_map(background.path),$("#select_hd").prop("checked",!0),$("#map_select_container").show(),$("#wotbase_select_container").hide(),$("#new_minimap_select_container").hide());
background.size_x&&background.size_y&&0<background.size_x&&0<background.size_y?$("#map_size").text("("+background.size_x+" x "+background.size_y+")"):$("#map_size").text("");window.onresize();render_scene();a&&a(!0)};d.baseTexture.hasLoaded?f():(d.baseTexture.on("loaded",function(){f()}),d.baseTexture.on("error",function(b){alert("Image exists, but the host does not allow embedding. Try uploading your map to a service such as http://imgur.com.");resources_loading--;a&&a(!1)}))}else{reset_background();
background=b;history[background.uid]=background;$("#map_select").val(background.path).change();$("#select_hd").prop("checked",!0);$("#map_select_container").show();$("#wotbase_select_container").hide();$("#new_minimap_select_container").hide();var k=new PIXI.Graphics;k.beginFill(16777215,1);k.moveTo(0,0);is_video_replay?(k.lineTo($(window).width(),0),k.lineTo($(window).width(),$(window).height()),k.lineTo(0,$(window).height())):(k.lineTo(renderer.width,0),k.lineTo(renderer.width,renderer.height),
k.lineTo(0,renderer.height));k.lineTo(0,0);k.endFill();background_sprite.texture=renderer.generateTexture(k);$("#map_size").text("");window.onresize();render_scene();a&&a(!0)}}var context_before_drag,move_selected,drag_timeout,last_drag_position,last_drag_update,dragged_entity;
function on_drag_start(b){this==select_box&&(limit_rate(15,select_box_move_state,function(){}),select_box.mousemove=void 0,select_box.mouseover=void 0,select_box.mouseout=void 0);drag_delay_running=!0;drag_timeout&&clearTimeout(drag_timeout);_this=this;var a=b.data.getLocalPosition(background_sprite);last_mouse_location=[mouse_x_rel(a.x),mouse_y_rel(a.y)];mouse_down_interrupted=!1;a=0;if("ping_context"!=active_context||_this.entity&&"note"==_this.entity.type){if("remove_context"==active_context||
"eraser_context"==active_context){_this.entity&&(deselect_all(),remove(_this.entity.uid),undo_list.push(clone_action(["remove",[_this.entity]])),socket.emit("remove",room,_this.entity.uid,active_slide),"eraser_context"==active_context&&on_left_click(b));_this==select_box&&clear_selected();b.stopPropagation();return}"drag_context"!=active_context&&(context_before_drag=active_context);active_context="drag_context";b.stopPropagation()}else a=300;drag_timeout=setTimeout(function(){if(mouse_down_interrupted)drag_delay_running=
!1,deselect_all();else if(is_room_locked&&!my_user.role)_this.entity&&"note"==_this.entity.type&&(_this.mouseup=toggle_note,_this.touchend=toggle_note,_this.mouseupoutside=toggle_note,_this.touchendoutside=toggle_note);else{var a=renderer.plugins.interaction.eventData.data.global;last_drag_update=Date.now();last_drag_position=[from_x_local(a.x),from_y_local(a.y)];dragged_entity=_this;objectContainer.buttonMode=!0;"drag_context"!=active_context&&(context_before_drag=active_context);active_context=
"drag_context";_this.mouseup=on_drag_end;_this.touchend=on_drag_end;_this.mouseupoutside=on_drag_end;_this.touchendoutside=on_drag_end;_this.mousemove=on_drag_move;_this.touchmove=on_drag_move;$("html,body").css("cursor","pointer");move_selected=!1;if(_this.entity)for(var b in selected_entities){if(selected_entities[b].uid==_this.entity.uid){move_selected=!0;break}}else move_selected=!0;move_selected||deselect_all();for(b in selected_entities)selected_entities[b].origin_x=selected_entities[b].x,selected_entities[b].origin_y=
selected_entities[b].y,objectContainer.removeChild(selected_entities[b].container),objectContainer.addChild(selected_entities[b].container);_this.entity&&(_this.entity.origin_x=_this.entity.x,_this.entity.origin_y=_this.entity.y);drag_delay_running=!1;select_box&&(objectContainer.removeChild(select_box),objectContainer.addChild(select_box));render_scene()}},a)}function toggle_note(b){this.entity.is_open=this.entity.is_open?!1:!0;align_note_text(this.entity)}
function move_entity(b,a,m){b.container&&(a=b.container.x+x_abs(a),m=b.container.y+y_abs(m),drag_entity(b,b.x+x_rel(a-b.container.x),b.y+y_rel(m-b.container.y)))}function limit_rate(b,a,m){clearTimeout(a.timeout);a.last_trigger||(a.last_trigger=Date.now());Date.now()-a.last_trigger>b?(m(),a.last_trigger=Date.now()):a.timeout=setTimeout(function(){m();a.last_trigger=Date.now()},b+5)}var drag_state={};
function on_drag_move(b){_this=this;limit_rate(15,drag_state,function(){var a=b.data.getLocalPosition(background_sprite),a=[mouse_x_rel(a.x),mouse_y_rel(a.y)],m=a[0]-last_mouse_location[0],d=a[1]-last_mouse_location[1];if(move_selected)for(var f in selected_entities)move_entity(selected_entities[f],m,d);else move_entity(_this.entity,m,d);select_box&&(select_box.x+=x_abs(m),select_box.y+=y_abs(d));select_box&&(objectContainer.removeChild(select_box),objectContainer.addChild(select_box));last_mouse_location=
a;render_scene()})}
function on_drag_end(b){limit_rate(15,drag_state,function(){});if(this.entity&&Math.abs(this.entity.origin_x-this.entity.x)<EPSILON&&Math.abs(this.entity.origin_y-this.entity.y)<EPSILON)"remove_context"==context_before_drag?(remove(this.entity.uid),undo_list.push(clone_action(["remove",[this.entity]])),socket.emit("remove",room,this.entity.uid,active_slide)):"note"==this.entity.type&&(toggle_note.call(this,b),deselect_all());else{b=["drag",[]];if(0<selected_entities.length)for(var a in selected_entities){var m=[selected_entities[a].origin_x,
selected_entities[a].origin_y];b[1].push([m,selected_entities[a].uid]);delete selected_entities[a].origin_x;delete selected_entities[a].origin_y;socket.emit("drag",room,selected_entities[a].uid,active_slide,selected_entities[a].x,selected_entities[a].y)}else m=[this.entity.origin_x,this.entity.origin_y],b[1].push([m,this.entity.uid]),delete this.entity.origin_x,delete this.entity.origin_y,socket.emit("drag",room,this.entity.uid,active_slide,this.entity.x,this.entity.y);undo_list.push(clone_action(b))}cancel_drag();
render_scene()}
function remove(b,a){var m=room_data.slides[active_slide].entities[b];if(m&&m.container&&(dragged_entity&&dragged_entity.entity&&dragged_entity.entity.uid==b&&cancel_drag(!0),"note"==m.type&&m.container.menu.remove(),objectContainer.removeChild(m.container),delete m.container,"icon"==m.type))try{var d=$('button[id*="'+room_data.slides[active_slide].entities[b].tank+'"]').find("span");d[0].innerHTML=parseInt(d[0].innerHTML)-1;d=$("#icon_context").find("span").first();d.text((parseInt(d.text())-1).toString())}catch(f){}for(m=
selected_entities.length;m--;)if(selected_entities[m].uid==b){selected_entities.splice(m,1);"drag_context"==active_context&&move_selected&&cancel_drag(!0);break}a||delete room_data.slides[active_slide].entities[b];select_box_dirty=!0;render_scene()}function move_tracker(b,a,m){var d=.1*a,f=.1*m,k=10,n=setInterval(function(){trackers[b]&&(trackers[b].x+=d,trackers[b].y+=f,trackers[b].container.x+=x_abs(d),trackers[b].container.y+=y_abs(f),render_scene());k--;0==k&&clearInterval(n)},15)}
var scene_dirty=!1;function render_scene(){scene_dirty=!0}function get_offset(){return offset}function get_server_time(){return Date.now()+offset}function get_local_time(b){return b-offset}var ping_container_atlas={},ping_texture_atlas={},active_pings=[];
function ping(b,a,m,d){var f;if(ping_container_atlas[m])f=ping_container_atlas[m];else{f=new PIXI.particles.ParticleContainer(500,{scale:!0,alpha:!0});ping_container_atlas[m]=f;var k=new PIXI.Sprite(ping_texture),k=PIXI.CanvasTinter.getTintedTexture(k,m);ping_texture_atlas[m]=new PIXI.Texture.fromCanvas(k);objectContainer.addChild(f)}m=new PIXI.Sprite(ping_texture_atlas[m]);m.anchor.set(.5);m.start_size=y_abs(.01)*(d/10)*zoom_level;m.height=m.start_size;m.width=m.start_size;m.x=x_abs(b);m.y=y_abs(a);
m.container=f;f.addChild(m);m.stop_time=Date.now()+PING_TIME;m.growth=5*m.height;render_scene();active_pings.push(m)}function update_pings(){var b=Date.now();active_pings=active_pings.filter(function(a){var m=a.stop_time-b,d=1-m/PING_TIME,f=a.start_size+d*a.growth;a.height=f;a.width=f;a.alpha=.5+.5*(1-d);if(0>=m)return a.container.removeChild(a),render_scene(),!1;render_scene();return!0})}
function setup_mouse_events(b,a){objectContainer.mouseup=a;objectContainer.touchend=a;objectContainer.mouseupoutside=a;objectContainer.touchendoutside=a;objectContainer.mousemove=b;objectContainer.touchmove=b}
function align_note_text(b){if(b.container)if(b.is_open){var a=$("#edit_window")[0].getBoundingClientRect(),m=a.left+to_x_local(b.x)+b.container.width*objectContainer.scale.x,a=a.top+to_y_local(b.y);b.container.menu.attr("style","top:"+a+"px; left:"+m+"px; display:block; z-index:20")}else b.container.menu.css("visibility","hidden")}
var drawArrow=function(b,a,m,d,f,k,n,h,e,g){a*=g;m*=g;d*=g;f*=g;e*=1.2;k=[d-a,f-m];var c=Math.atan2(k[1],k[0]);n=Math.abs(e*g/Math.cos(h));var p=c+Math.PI+h;g=d+Math.cos(p)*n;p=f+Math.sin(p)*n;h=c+Math.PI-h;d+=Math.cos(h)*n;f+=Math.sin(h)*n;b.beginPath();b.moveTo(g,p);b.lineTo(a+e/3*k[0],m+e/3*k[1]);b.lineTo(d,f);b.quadraticCurveTo((g+a+d)/3,(p+m+f)/3,g,p);b.fill()};
function hexToRGBA(b,a){var m=parseInt(b.slice(1,3),16),d=parseInt(b.slice(3,5),16),f=parseInt(b.slice(5,7),16);return"rgba("+m+", "+d+", "+f+", "+a+")"}
function init_canvas_simple(b,a,m,d,f){f||(f=[10,10]);m="#"+("00000"+(m|0).toString(16)).substr(-6);b.lineWidth=size_y/1E3*a*THICKNESS_SCALE;b.strokeStyle=m;b.fillStyle=m;b.shadowBlur=b.lineWidth/2;b.shadowColor="#000000";"setLineDash"in b&&("dashed"==d?(b.setLineDash(f),b.lineJoin=b.lineCap="round"):"dotted"==d?(b.setLineDash([a,a]),b.lineJoin=b.lineCap="butt"):b.lineJoin=b.lineCap="round")}
function init_canvas(b,a,m,d,f,k,n,h){init_canvas_simple(b,a,m,d,h);m="#"+("00000"+(m|0).toString(16)).substr(-6);"undefined"!==typeof f&&(k="#"+("00000"+(k|0).toString(16)).substr(-6),a=hexToRGBA(k,f),b.fillStyle=a,("00000"+(k|0).toString(16)).substr(-6),m=hexToRGBA(m,n),b.strokeStyle=m)}
function init_canvases(b,a,m,d,f,k){start_drawing();init_canvas(draw_context,b*DRAW_QUALITY,a,m,d,f,k,[10*DRAW_QUALITY,10*DRAW_QUALITY]);init_canvas(temp_draw_context,b*DRAW_QUALITY,a,m,d,f,k,[10*DRAW_QUALITY,10*DRAW_QUALITY]);draw_context.beginPath();temp_draw_context.beginPath()}function can_edit(){return!is_room_locked||my_user.role}function t2o(b){return 1-b/100}var last_point;
function on_left_click(b){"drag_context"==active_context&&cancel_drag(!0);var a=renderer.plugins.interaction.eventData.data.global;if(can_edit()){try{document.activeElement.blur()}catch(d){}if("drag_context"!=active_context)if("ping_context"!=active_context&&deselect_all(),"draw_context"==active_context){setup_mouse_events(on_draw_move,on_draw_end);b=from_x_local(a.x);var m=from_y_local(a.y);new_drawing={uid:newUid(),type:"drawing",x:b,y:m,scale:[1,1],color:draw_color,alpha:1,thickness:parseFloat(draw_thickness)*
zoom_level,end:$("#draw_end_type").find(".active").attr("data-end"),style:$("#draw_type").find(".active").attr("data-style"),path:[[0,0]],end_size:draw_end_size*zoom_level,draw_zoom_level:zoom_level};init_canvases(parseFloat(draw_thickness),new_drawing.color,new_drawing.style);point_buffer=[a.x,a.y];last_point=[a.x,a.y]}else"ruler_context"==active_context?(setup_mouse_events(on_ruler_move,on_ruler_end),init_canvases(.1,16777215,"full"),left_click_origin=[from_x_local(a.x),from_y_local(a.y)]):"line_context"==
active_context?new_drawing||(setup_mouse_events(on_line_move,on_line_end),new_drawing={uid:newUid(),type:"line",x:from_x_local(a.x),y:from_y_local(a.y),scale:[1,1],color:line_color,alpha:1,thickness:parseFloat(line_thickness)*zoom_level,path:[[0,0]],end:$("#line_end_type").find(".active").attr("data-end"),style:$("#line_type").find(".active").attr("data-style"),end_size:line_end_size*zoom_level,draw_zoom_level:zoom_level},init_canvases(parseFloat(line_thickness),new_drawing.color,new_drawing.style),
draw_context.moveTo(a.x*DRAW_QUALITY,a.y*DRAW_QUALITY),just_activated=!0):"polygon_context"==active_context?new_drawing||(setup_mouse_events(on_line_move,on_polygon_end),new_drawing={uid:newUid(),type:"polygon",x:from_x_local(a.x),y:from_y_local(a.y),scale:[1,1],outline_thickness:polygon_outline_thickness*zoom_level,outline_color:polygon_outline_color,outline_opacity:t2o(polygon_outline_transparancy),fill_color:polygon_fill_color,fill_opacity:t2o(polygon_fill_transparancy),alpha:1,path:[[0,0]],style:$("#polygon_type").find(".active").attr("data-style"),
draw_zoom_level:zoom_level},init_canvases(polygon_outline_thickness,new_drawing.outline_color,new_drawing.style,new_drawing.fill_opacity,new_drawing.fill_color,new_drawing.outline_opacity),draw_context.moveTo(a.x*DRAW_QUALITY,a.y*DRAW_QUALITY),b="touchstart"==b.type?MIN_POLYGON_END_DISTANCE_TOUCH:MIN_POLYGON_END_DISTANCE,graphics=new PIXI.Graphics,graphics.lineStyle(new_drawing.outline_thickness*THICKNESS_SCALE,new_drawing.outline_color,new_drawing.outline_opacity),graphics.moveTo(x_abs(from_x_local(a.x)),
y_abs(from_y_local(a.y))),graphics.drawShape(new PIXI.Circle(x_abs(from_x_local(a.x)),y_abs(from_y_local(a.y)),size_y*b*zoom_level)),objectContainer.addChild(graphics),just_activated=!0,render_scene()):"curve_context"==active_context?new_drawing||(new_drawing={uid:newUid(),type:"curve",x:from_x_local(a.x),y:from_y_local(a.y),scale:[1,1],color:curve_color,alpha:1,thickness:parseFloat(curve_thickness)*zoom_level,path:[[0,0]],end:$("#curve_end_type").find(".active").attr("data-end"),style:$("#curve_type").find(".active").attr("data-style"),
end_size:curve_end_size*zoom_level,draw_zoom_level:zoom_level},point_buffer=[a.x,a.y],init_canvases(parseFloat(curve_thickness),new_drawing.color,new_drawing.style),draw_context.moveTo(a.x*DRAW_QUALITY,a.y*DRAW_QUALITY),setup_mouse_events(on_curve_move,on_curve_end),just_activated=!0):"area_context"==active_context?new_drawing||(new_drawing={uid:newUid(),type:"area",x:from_x_local(a.x),y:from_y_local(a.y),scale:[1,1],outline_thickness:parseFloat(area_outline_thickness)*zoom_level,outline_color:area_outline_color,
outline_opacity:t2o(area_outline_transparancy),fill_color:area_fill_color,fill_opacity:t2o(area_fill_transparancy),alpha:1,path:[[0,0]],style:$("#area_type").find(".active").attr("data-style"),draw_zoom_level:zoom_level},point_buffer=[a.x,a.y],init_canvases(parseFloat(area_outline_thickness),new_drawing.outline_color,new_drawing.style,new_drawing.fill_opacity,new_drawing.fill_color,new_drawing.outline_opacity),draw_context.moveTo(a.x*DRAW_QUALITY,a.y*DRAW_QUALITY),b="touchstart"==b.type?MIN_POLYGON_END_DISTANCE_TOUCH:
MIN_POLYGON_END_DISTANCE,graphics=new PIXI.Graphics,graphics.lineStyle(new_drawing.outline_thickness*THICKNESS_SCALE,new_drawing.outline_color,new_drawing.outline_opacity),graphics.moveTo(x_abs(from_x_local(a.x)),y_abs(from_y_local(a.y))),graphics.drawShape(new PIXI.Circle(x_abs(from_x_local(a.x)),y_abs(from_y_local(a.y)),size_y*b*zoom_level)),objectContainer.addChild(graphics),setup_mouse_events(on_curve_move,on_area_end),just_activated=!0,render_scene()):"icon_context"==active_context?setup_mouse_events(void 0,
on_icon_end):"eraser_context"==active_context?setup_mouse_events(on_eraser_move,on_eraser_end):"ping_context"==active_context?(drag_delay_running||deselect_all(),last_ping_time=new Date,setup_mouse_events(on_ping_move,on_ping_end)):"select_context"==active_context?(setup_mouse_events(on_select_move,on_select_end),init_canvases(2,12303291,"dotted",.25,12303291,1),left_click_origin=[from_x_local(a.x),from_y_local(a.y)],deselect_all()):"text_context"==active_context?setup_mouse_events(void 0,on_text_end):
"background_text_context"==active_context?setup_mouse_events(void 0,on_background_text_end):"rectangle_context"==active_context?new_drawing||(setup_mouse_events(on_rectangle_move,on_rectangle_end),left_click_origin=[from_x_local(a.x),from_y_local(a.y)],init_canvases(rectangle_outline_thickness,rectangle_outline_color,$("#rectangle_type").find(".active").attr("data-style"),t2o(rectangle_fill_transparancy),rectangle_fill_color,t2o(rectangle_outline_transparancy)),just_activated=new_drawing=!0):"circle_context"==
active_context?new_drawing||(setup_mouse_events(on_circle_move,on_circle_end),left_click_origin=[from_x_local(a.x),from_y_local(a.y)],init_canvases(circle_outline_thickness,circle_outline_color,$("#circle_type").find(".active").attr("data-style"),t2o(circle_fill_transparancy),circle_fill_color,t2o(circle_outline_transparancy)),circle_draw_style=$("#circle_draw_style").find(".active").attr("data-draw_style"),just_activated=new_drawing=!0):"track_context"==active_context?my_tracker?stop_tracking():
(start_tracking(a),on_track_move(b)):"note_context"==active_context&&setup_mouse_events(void 0,on_note_end)}else setup_mouse_events(on_ruler_move,on_ruler_end),init_canvases(.1,16777215,"full"),left_click_origin=[from_x_local(a.x),from_y_local(a.y)]}var eraser_state={};
function on_eraser_move(b){var a=renderer.plugins.interaction.eventData.data.global;limit_rate(5,eraser_state,function(){renderer.plugins.interaction.processInteractive(a,objectContainer,function(a,b){if(b&&a.entity&&"background"!=a.entity.type){var f=a.entity;remove(f.uid);undo_list.push(clone_action(["remove",[f]]));socket.emit("remove",room,f.uid,active_slide)}},!0)})}function on_eraser_end(b){setup_mouse_events(void 0,void 0)}
function stop_tracking(){limit_rate(15,track_state,function(){});setup_mouse_events(void 0,void 0);socket.emit("stop_track",room,my_tracker.uid);objectContainer.removeChild(my_tracker.container);my_tracker=void 0;render_scene()}
function start_tracking(b){setup_mouse_events(on_track_move);var a=$("#track_shape .active").attr("data-cursor"),m;m="dot"==a||"cursor"==a?.025:.05;my_tracker={uid:newUid(),shape:a,size:track_size/10*m,color:track_color,x:from_x_local(b.x),y:from_y_local(b.y),owner:my_user.id};last_track_position=[my_tracker.x,my_tracker.y];socket.emit("track",room,my_tracker);create_tracker(my_tracker)}
function on_note_end(b){setup_mouse_events(void 0,void 0);var a=b.data.getLocalPosition(background_sprite);b=mouse_x_rel(a.x);a=mouse_y_rel(a.y);b={uid:newUid(),type:"note",x:b,y:a,scale:[1,1],color:text_color,alpha:1,text:"",font_size:font_size,font:"Arial",height:zoom_level,draw_zoom_level:zoom_level};undo_list.push(clone_action(["add",[b]]));create_note(b);b.container.is_open=!0;align_note_text(b);snap_and_emit_entity(b)}
function create_note(b){var a;texture_atlas["note.png"]&&!is_safari()?(a=texture_atlas["note.png"],a=new PIXI.Texture(loader.resources[a.sprite].texture,new PIXI.Rectangle(a.x,a.y,a.width,a.height))):a=PIXI.Texture.fromImage(image_host+"note.png");a=new PIXI.Sprite(a);var m=a.width/a.height;a.height=x_abs(NOTE_SCALE)*b.height;a.width=a.height*m;a.x=x_abs(b.x);a.y=y_abs(b.y);b.container=a;b.container.entity=b;b.container.is_open=!1;b.container.menu=$('<div class="popover fade right in" role="tooltip"><h3 style="display: none;" class="popover-title"></h3><div class="popover-content"><textarea style="height:400px; width:300px;" id="note_box"></textarea><br /><span id="notification_area" style="float: left;" hidden>Saved</span><div style="float:right; padding:3px;"></div></div></div>');
$("#note_box",b.container.menu).val(b.text);is_room_locked&&!my_user.role&&($("textarea",b.container.menu).prop("readonly",!0),$("button",b.container.menu).hide());$("body").append(b.container.menu);$("#note_box",b.container.menu).on("blur",function(){can_edit()&&(b.text=$("#note_box",b.container.menu).val(),$("#notification_area",b.container.menu).show(),$("#notification_area",b.container.menu).fadeOut("slow"),snap_and_emit_entity(b))});align_note_text(b);init_dragging(b.container);objectContainer.addChild(b.container);
render_scene();a.texture.on("update",function(){render_scene()});room_data.slides[active_slide].entities[b.uid]=b}
function create_tracker(b){var a;texture_atlas[b.shape+".png"]&&!is_safari()?(a=texture_atlas[b.shape+".png"],a=new PIXI.Texture(loader.resources[a.sprite].texture,new PIXI.Rectangle(a.x,a.y,a.width,a.height))):a=PIXI.Texture.fromImage(image_host+b.shape+".png");b.container=new PIXI.Sprite(a);b.container.tint=b.color;"cursor"!=b.shape&&b.container.anchor.set(.5);b.container.x=x_abs(b.x);b.container.y=y_abs(b.y);a=b.container.width/b.container.height;b.container.height=y_abs(b.size);b.container.width=
b.container.height*a;trackers[b.uid]=b;objectContainer.addChild(trackers[b.uid].container);render_scene()}function remove_tracker(b){objectContainer.removeChild(trackers[b].container);render_scene();delete trackers[b]}var last_track_update=Date.now(),count,track_timeout,track_state={};
function on_track_move(b){limit_rate(15,track_state,function(){clearTimeout(track_timeout);var a=renderer.plugins.interaction.eventData.data.global,b=from_x_local(a.x),a=from_y_local(a.y);my_tracker.x=b;my_tracker.y=a;my_tracker.container.x=x_abs(b);my_tracker.container.y=y_abs(a);b=(last_track_position[0]-my_tracker.x)*(last_track_position[0]-my_tracker.x)+(last_track_position[1]-my_tracker.y)*(last_track_position[1]-my_tracker.y);render_scene();a=Date.now()-last_track_update;b>MIN_TRACK_MOVE_DISTANCE_SQ||
50<a?(last_track_update=Date.now(),0<Math.abs(my_tracker.x-last_track_position[0]+my_tracker.y-last_track_position[1])&&(socket.emit("track_move",room,my_tracker.uid,my_tracker.x-last_track_position[0],my_tracker.y-last_track_position[1]),last_track_position=[my_tracker.x,my_tracker.y])):track_timeout=setTimeout(function(){my_tracker&&(last_track_update=Date.now(),socket.emit("track_move",room,my_tracker.uid,my_tracker.x-last_track_position[0],my_tracker.y-last_track_position[1]),last_track_position=
[my_tracker.x,my_tracker.y],render_scene())},55)})}
function on_area_end(b){var a=renderer.plugins.interaction.eventData.data.global,m=a.x,d=a.y,f=Math.pow(new_drawing.x-from_x_local(m),2)+Math.pow(new_drawing.y-from_y_local(d),2),k="touchend"==b.type||"touchendoutside"==b.type?MIN_POLYGON_END_DISTANCE_TOUCH:MIN_POLYGON_END_DISTANCE;if(just_activated&&(just_activated=!1,f<EPSILON))return;f<k*k*zoom_level?(create_area2(new_drawing,DRAW_QUALITY),emit_entity(new_drawing),undo_list.push(clone_action(["add",[new_drawing]])),objectContainer.removeChild(graphics),
render_scene(),stop_drawing(),setup_mouse_events(void 0,void 0),new_drawing=null):(point_buffer.push(a.x,a.y),new_drawing.path.push([from_x_local(m)-new_drawing.x,from_y_local(d)-new_drawing.y]),on_curve_move(b))}var curve_state={},point_buffer=[];
function on_curve_move(b){limit_rate(20,curve_state,function(){var a=renderer.plugins.interaction.eventData.data.global,b=a.x,d=a.y;temp_draw_context.clearRect(0,0,temp_draw_canvas.width*DRAW_QUALITY,temp_draw_canvas.height*DRAW_QUALITY);point_buffer.push(b,d);var f=smooth_draw(temp_draw_context,point_buffer,!1,DRAW_QUALITY);point_buffer.pop();point_buffer.pop();new_drawing.path.push([from_x_local(a.x)-new_drawing.x,from_y_local(a.y)-new_drawing.y]);draw_end(temp_draw_context,new_drawing,f[0],f[1],
1/zoom_level,DRAW_QUALITY);new_drawing.path.pop();last_point=[b,d]})}
function on_curve_end(b){var a=renderer.plugins.interaction.eventData.data.global,m=a.x,d=a.y,f=Math.pow(from_x_local(m)-new_drawing.x-new_drawing.path[new_drawing.path.length-1][0],2)+Math.pow(from_y_local(d)-new_drawing.y-new_drawing.path[new_drawing.path.length-1][1],2);if(just_activated&&(just_activated=!1,f<EPSILON))return;var k="touchend"==b.type||"touchendoutside"==b.type||"touchstart"==b.type||"touchstartoutside"==b.type?MIN_POLYGON_END_DISTANCE_TOUCH:MIN_POLYGON_END_DISTANCE;f<k*k*zoom_level?
(create_curve2(new_drawing,DRAW_QUALITY),emit_entity(new_drawing),undo_list.push(clone_action(["add",[new_drawing]])),objectContainer.removeChild(graphics),render_scene(),stop_drawing(),setup_mouse_events(void 0,void 0),new_drawing=null):(point_buffer.push(a.x,a.y),new_drawing.path.push([from_x_local(m)-new_drawing.x,from_y_local(d)-new_drawing.y]),objectContainer.removeChild(graphics),graphics=new PIXI.Graphics,graphics.lineStyle(new_drawing.thickness*THICKNESS_SCALE,new_drawing.color,1),graphics.moveTo(x_abs(from_x_local(a.x)),
y_abs(from_y_local(a.y))),graphics.drawShape(new PIXI.Circle(x_abs(from_x_local(a.x)),y_abs(from_y_local(a.y)),size_y*k*zoom_level)),objectContainer.addChild(graphics),render_scene(),on_curve_move(b))}
function on_polygon_end(b){try{var a=b.data.getLocalPosition(background_sprite),m=mouse_x_rel(a.x),d=mouse_y_rel(a.y),m=m-new_drawing.x,d=d-new_drawing.y}catch(n){}a=m*m+d*d;b="touchend"==b.type||"touchendoutside"==b.type?MIN_POLYGON_END_DISTANCE_TOUCH:MIN_POLYGON_END_DISTANCE;var f;f=1==new_drawing.path.length?[to_x_local(new_drawing.x),to_y_local(new_drawing.y)]:[to_x_local(new_drawing.path[new_drawing.path.length-2][0]+new_drawing.x),to_y_local(new_drawing.path[new_drawing.path.length-2][1]+new_drawing.y)];
var k=[to_x_local(m+new_drawing.x),to_y_local(d+new_drawing.y)];if(just_activated&&(f=Math.pow(f[0]-k[0],2)+Math.pow(f[1]-k[1],2),just_activated=!1,.01>f))return;a<b*b*zoom_level?(new_drawing.path.push([0,0]),create_polygon2(new_drawing,DRAW_QUALITY),emit_entity(new_drawing),undo_list.push(clone_action(["add",[new_drawing]])),objectContainer.removeChild(graphics),render_scene(),setup_mouse_events(void 0,void 0),stop_drawing(),new_drawing=null):(0!=new_drawing.path.length&&m==last(new_drawing.path)[0]&&
d==last(new_drawing.path)[1]||new_drawing.path.push([m,d]),draw_context.lineTo(k[0]*DRAW_QUALITY,k[1]*DRAW_QUALITY),draw_context.stroke())}function draw_shape(b,a,m,d,f,k){var n=new PIXI.Graphics;n.lineStyle(b*THICKNESS_SCALE,m,a);n.beginFill(f,d);n.drawShape(k);n.endFill();n.boundsPadding=1;return new PIXI.Sprite(renderer.generateTexture(n))}var ruler_state={};
function on_ruler_move(b){limit_rate(15,ruler_state,function(){var a=b.data.getLocalPosition(background_sprite),m=background.size_x?background.size_x:0,d=background.size_y?background.size_y:0;temp_draw_context.lineWidth=size_x/1E3*2*DRAW_QUALITY;temp_draw_context.strokeStyle="#FFFFFF";temp_draw_context.fillStyle="#FFFFFF";var f=to_x_local(left_click_origin[0]),k=to_y_local(left_click_origin[1]),n=to_x_local(mouse_x_rel(a.x)),h=to_y_local(mouse_y_rel(a.y)),e=Math.sqrt(Math.pow(f-n,2)+Math.pow(k-h,
2));temp_draw_context.clearRect(0,0,temp_draw_canvas.width*DRAW_QUALITY,temp_draw_canvas.height*DRAW_QUALITY);temp_draw_context.beginPath();temp_draw_context.moveTo(n*DRAW_QUALITY,h*DRAW_QUALITY);temp_draw_context.lineTo(f*DRAW_QUALITY,k*DRAW_QUALITY);temp_draw_context.moveTo((f+e)*DRAW_QUALITY,k*DRAW_QUALITY);temp_draw_context.arc(f*DRAW_QUALITY,k*DRAW_QUALITY,e*DRAW_QUALITY,0,2*Math.PI);temp_draw_context.stroke();f=(f+to_x_local(mouse_x_rel(a.x)))/2;k=(k+to_y_local(mouse_y_rel(a.y)))/2;temp_draw_context.font=
"44px Arial";a=Math.sqrt(Math.pow(m*(left_click_origin[0]-mouse_x_rel(a.x)),2)+Math.pow(d*(left_click_origin[1]-mouse_y_rel(a.y)),2));temp_draw_context.lineWidth=to_x_local(.5)/1E3*DRAW_QUALITY;temp_draw_context.strokeStyle="#000000";temp_draw_context.fillStyle="#FFFFFF";m="";m="lol"==game?m+(Math.round(10*a)/10+"u"):"wows"==game?m+(Math.round(.01*a)/10+"km"):m+(Math.round(10*a)/10+"m");temp_draw_context.fillText(m,f*DRAW_QUALITY,k*DRAW_QUALITY)})}
function on_ruler_end(b){setup_mouse_events(void 0,void 0);limit_rate(15,ruler_state,function(){temp_draw_context.clearRect(0,0,temp_draw_canvas.width*DRAW_QUALITY,temp_draw_canvas.height*DRAW_QUALITY)})}var circle_state={};
function on_circle_move(b){limit_rate(15,circle_state,function(){var a=renderer.plugins.interaction.eventData.data.global,b=from_x_local(a.x),d=from_y_local(a.y),f,k,n;"edge"==circle_draw_style?(f=(left_click_origin[0]+b)/2,k=(left_click_origin[1]+d)/2,n=Math.sqrt(Math.pow(to_x_local(left_click_origin[0])-to_x_local(b),2)+Math.pow(to_y_local(left_click_origin[1])-to_y_local(d),2)),n/=2):"radius"==circle_draw_style&&(f=left_click_origin[0],k=left_click_origin[1],n=Math.sqrt(Math.pow(to_x_local(left_click_origin[0])-
to_x_local(b),2)+Math.pow(to_y_local(left_click_origin[1])-to_y_local(d),2)));temp_draw_context.clearRect(0,0,temp_draw_canvas.width*DRAW_QUALITY,temp_draw_canvas.height*DRAW_QUALITY);temp_draw_context.beginPath();temp_draw_context.arc(to_x_local(f)*DRAW_QUALITY,to_y_local(k)*DRAW_QUALITY,n*DRAW_QUALITY,0,2*Math.PI);temp_draw_context.fill();temp_draw_context.stroke();"radius"==circle_draw_style&&background.size_x&&0<background.size_x&&background.size_y&&0<background.size_y&&(temp_draw_context.save(),
temp_draw_context.lineWidth=size_x/1E3*2*DRAW_QUALITY,temp_draw_context.strokeStyle="#FFFFFF",temp_draw_context.fillStyle="#FFFFFF",temp_draw_context.shadowBlur=0,temp_draw_context.beginPath(),temp_draw_context.moveTo(to_x_local(f)*DRAW_QUALITY,to_y_local(k)*DRAW_QUALITY),temp_draw_context.lineTo(to_x_local(b)*DRAW_QUALITY,to_y_local(d)*DRAW_QUALITY),temp_draw_context.stroke(),n=to_x_local((f+b)/2),a=to_y_local((k+d)/2),temp_draw_context.font="33px Arial",b=Math.sqrt(Math.pow(background.size_x*(f-
b),2)+Math.pow(background.size_y*(k-d),2)),temp_draw_context.lineWidth=to_x_local(.5)/1E3*DRAW_QUALITY,temp_draw_context.strokeStyle="#000000",temp_draw_context.fillStyle="#FFFFFF",f="",f="lol"==game?f+(Math.round(10*b)/10+"u"):"wows"==game?f+(Math.round(.01*b)/10+"km"):f+(Math.round(10*b)/10+"m"),temp_draw_context.fillText(f,n*DRAW_QUALITY,a*DRAW_QUALITY),temp_draw_context.stroke(),temp_draw_context.restore())})}
function on_circle_end(b){limit_rate(15,circle_state,function(){});var a=renderer.plugins.interaction.eventData.data.global;b=from_x_local(a.x);var a=from_y_local(a.y),m,d,f;"edge"==circle_draw_style?(m=(left_click_origin[0]+b)/2,d=(left_click_origin[1]+a)/2,f=Math.sqrt(Math.pow(to_x_local(left_click_origin[0])-to_x_local(b),2)+Math.pow(to_y_local(left_click_origin[1])-to_y_local(a),2)),f/=2):"radius"==circle_draw_style&&(m=left_click_origin[0],d=left_click_origin[1],f=Math.sqrt(Math.pow(to_x_local(left_click_origin[0])-
to_x_local(b),2)+Math.pow(to_y_local(left_click_origin[1])-to_y_local(a),2)));m={uid:newUid(),type:"circle",x:m,y:d,radius:from_y_local_vect(f),outline_thickness:circle_outline_thickness*zoom_level,outline_color:circle_outline_color,outline_opacity:t2o(circle_outline_transparancy),fill_opacity:t2o(circle_fill_transparancy),fill_color:circle_fill_color,alpha:1,style:$("#circle_type").find(".active").attr("data-style"),draw_zoom_level:zoom_level};"radius"==circle_draw_style&&background.size_x&&0<background.size_x&&
background.size_y&&0<background.size_y&&(m.draw_radius=[b-m.x,a-m.y]);new_drawing=void 0;create_circle2(m,DRAW_QUALITY);emit_entity(m);undo_list.push(clone_action(["add",[m]]));stop_drawing();setup_mouse_events(void 0,void 0)}var rectangle_state={};
function on_rectangle_move(b){limit_rate(15,rectangle_state,function(){var a=b.data.getLocalPosition(background_sprite),m=Math.min(left_click_origin[0],mouse_x_rel(a.x)),d=Math.min(left_click_origin[1],mouse_y_rel(a.y)),f=Math.max(left_click_origin[0],mouse_x_rel(a.x)),a=Math.max(left_click_origin[1],mouse_y_rel(a.y));temp_draw_context.clearRect(0,0,temp_draw_canvas.width*DRAW_QUALITY,temp_draw_canvas.height*DRAW_QUALITY);temp_draw_context.fillRect(to_x_local(m)*DRAW_QUALITY,to_y_local(d)*DRAW_QUALITY,
(to_x_local(f)-to_x_local(m))*DRAW_QUALITY,(to_y_local(a)-to_y_local(d))*DRAW_QUALITY);temp_draw_context.strokeRect(to_x_local(m)*DRAW_QUALITY,to_y_local(d)*DRAW_QUALITY,(to_x_local(f)-to_x_local(m))*DRAW_QUALITY,(to_y_local(a)-to_y_local(d))*DRAW_QUALITY)})}
function on_rectangle_end(b){limit_rate(15,rectangle_state,function(){});var a=b.data.getLocalPosition(background_sprite);b=Math.min(left_click_origin[0],mouse_x_rel(a.x));var m=Math.min(left_click_origin[1],mouse_y_rel(a.y)),d=Math.max(left_click_origin[0],mouse_x_rel(a.x)),a=Math.max(left_click_origin[1],mouse_y_rel(a.y));if(just_activated){var f=Math.pow(to_x_local(b-d),2)+Math.pow(to_y_local(m-a),2);just_activated=!1;if(.01>f)return}new_drawing=void 0;b={uid:newUid(),type:"rectangle",x:b,y:m,
width:d-b,height:a-m,outline_thickness:rectangle_outline_thickness*zoom_level,outline_color:rectangle_outline_color,outline_opacity:t2o(rectangle_outline_transparancy),fill_opacity:t2o(rectangle_fill_transparancy),fill_color:rectangle_fill_color,alpha:1,style:$("#rectangle_type").find(".active").attr("data-style"),draw_zoom_level:zoom_level};create_rectangle2(b,DRAW_QUALITY);emit_entity(b);undo_list.push(clone_action(["add",[b]]));stop_drawing();setup_mouse_events(void 0,void 0)}
function on_ping_move(b){limit_rate(60,drag_state,function(){var a=Date.now();if(!(10>a-last_ping_time)){var b=renderer.plugins.interaction.eventData.data.global,d=from_x_local(b.x),b=from_y_local(b.y);last_ping_time=a;ping(d,b,ping_color,ping_size);socket.emit("ping_marker",room,d,b,ping_color,ping_size)}})}
function on_ping_end(b){limit_rate(0,drag_state,function(){});var a=renderer.plugins.interaction.eventData.data.global;b=from_x_local(a.x);a=from_y_local(a.y);ping(b,a,ping_color,ping_size);socket.emit("ping_marker",room,b,a,ping_color,ping_size);setup_mouse_events(void 0,void 0)}var select_state={};
function on_select_move(b){limit_rate(15,select_state,function(){var a=b.data.getLocalPosition(background_sprite),m=Math.min(left_click_origin[0],mouse_x_rel(a.x)),d=Math.min(left_click_origin[1],mouse_y_rel(a.y)),f=Math.max(left_click_origin[0],mouse_x_rel(a.x)),a=Math.max(left_click_origin[1],mouse_y_rel(a.y));temp_draw_context.clearRect(0,0,temp_draw_canvas.width*DRAW_QUALITY,temp_draw_canvas.height*DRAW_QUALITY);temp_draw_context.fillRect(to_x_local(m)*DRAW_QUALITY,to_y_local(d)*DRAW_QUALITY,
(to_x_local(f)-to_x_local(m))*DRAW_QUALITY,(to_y_local(a)-to_y_local(d))*DRAW_QUALITY);temp_draw_context.strokeRect(to_x_local(m)*DRAW_QUALITY,to_y_local(d)*DRAW_QUALITY,(to_x_local(f)-to_x_local(m))*DRAW_QUALITY,(to_y_local(a)-to_y_local(d))*DRAW_QUALITY)})}
function on_select_end(b){limit_rate(15,select_state,function(){temp_draw_context.clearRect(0,0,temp_draw_canvas.width*DRAW_QUALITY,temp_draw_canvas.height*DRAW_QUALITY)});setup_mouse_events(void 0,void 0);var a=b.data.getLocalPosition(background_sprite);b=Math.min(x_abs(mouse_x_rel(a.x)),x_abs(left_click_origin[0]));var m=Math.min(y_abs(mouse_y_rel(a.y)),y_abs(left_click_origin[1])),d=Math.max(x_abs(mouse_x_rel(a.x)),x_abs(left_click_origin[0])),a=Math.max(y_abs(mouse_y_rel(a.y)),y_abs(left_click_origin[1])),
f;for(f in room_data.slides[active_slide].entities)if(room_data.slides[active_slide].entities.hasOwnProperty(f)&&room_data.slides[active_slide].entities[f].container){var k=room_data.slides[active_slide].entities[f].container.getBounds();k.width/=objectContainer.scale.x;k.height/=objectContainer.scale.y;k.x=(-objectContainer.x+k.x)/objectContainer.scale.x;k.y=(-objectContainer.y+k.y)/objectContainer.scale.y;var n=k.y,h=k.x+k.width,e=k.y+k.height;k.x>b&&n>m&&h<d&&e<a&&selected_entities.push(room_data.slides[active_slide].entities[f])}select_entities();
undo_list.push(clone_action(["select",selected_entities,previously_selected_entities]));render_scene()}function measure_text(b){return[x_rel(b.container.width),x_rel(b.container.height)]}
function select_box_mousemove(b,a,m,d,f,k,n){limit_rate(15,select_box_move_state,function(){var b=renderer.plugins.interaction.eventData.data.global;b.x=x_abs(from_x_local(b.x));b.y=y_abs(from_y_local(b.y));var e=Math.abs((b.x-a)/d),g=Math.abs((b.y-m)/f),c;for(c in selected_entities){var p=selected_entities[c];k||(p.container.scale.x=e*p.container.start_scale[0],p.container.x=(p.container.x_orig-a)*e+a);n||(p.container.scale.y=g*p.container.start_scale[1],p.container.y=(p.container.y_orig-m)*g+m)}k||
(select_box.width=Math.abs(a-b.x),select_box.left_x=Math.min(a,b.x),select_box.x=select_box.left_x+select_box.width/2);n||(select_box.height=Math.abs(m-b.y),select_box.upper_y=Math.min(m,b.y),select_box.y=select_box.upper_y+select_box.height/2);render_scene()});b.stopPropagation()}
function select_box_mouseup(b,a,m,d,f,k,n){limit_rate(15,select_box_move_state,function(){});setup_mouse_events(void 0,void 0);var h=renderer.plugins.interaction.eventData.data.global;h.x=x_abs(from_x_local(h.x));h.y=y_abs(from_y_local(h.y));d=Math.abs((h.x-a)/d);f=Math.abs((h.y-m)/f);var e=["drag",[]],g;for(g in selected_entities){var c=selected_entities[g],p=[1,1];c.scale&&(p=[c.scale[0],c.scale[1]]);e[1].push([[c.x,c.y,[p[0],p[1]]],c.uid]);var y=c.x,q=c.y;k||(y=x_rel((c.container.x_orig-a)*d+a-
c.container.x_orig)+c.x,p[0]=d*c.container.start_scale[0]/c.container.orig_scale[0]);n||(q=y_rel((c.container.y_orig-m)*f+m-c.container.y_orig)+c.y,p[1]=f*c.container.start_scale[1]/c.container.orig_scale[1]);c.container.x=c.container.x_orig;c.container.y=c.container.y_orig;drag_entity(c,y,q,p);socket.emit("drag",room,c.uid,active_slide,y,q,p)}undo_list.push(clone_action(e));select_box.mouseover=on_select_over;select_box.mousemove=on_selectbox_move;k||(select_box.width=Math.abs(a-h.x),select_box.left_x=
Math.min(a,h.x),select_box.x=select_box.left_x+select_box.width/2);n||(select_box.height=Math.abs(m-h.y),select_box.upper_y=Math.min(m,h.y),select_box.y=select_box.upper_y+select_box.height/2);render_scene();b.stopPropagation()}
function prepare_resize(b,a,m,d,f,k,n){for(var h in selected_entities){var e=selected_entities[h];e.container.x_orig=e.container.x;e.container.y_orig=e.container.y;e.container.start_scale=[e.container.scale.x,e.container.scale.y]}objectContainer.removeChild(rotate_arrow0);objectContainer.removeChild(rotate_arrow1);objectContainer.removeChild(rotate_arrow2);objectContainer.removeChild(rotate_arrow3);setup_mouse_events(function(b){select_box_mousemove(b,a,m,d,f,k,n)},function(b){select_box_mouseup(b,
a,m,d,f,k,n)});select_box.mouseover=void 0;select_box.mousemove=void 0;b.stopPropagation()}var select_box_move_state={};
function on_selectbox_move(b){limit_rate(15,select_box_move_state,function(){var a=renderer.plugins.interaction.eventData.data.global;a.x=x_abs(from_x_local(a.x));a.y=y_abs(from_y_local(a.y));a.x-=select_box.left_x;a.y-=select_box.upper_y;a.x/=select_box.width;a.y/=select_box.height;var m=y_abs(ROTATE_ARROW_MARGIN)*zoom_level,d=m/select_box.width,m=m/select_box.height,f=select_box.left_x,k=select_box.upper_y,n=f+select_box.width,h=k+select_box.height;a.x<0-d||a.x>1+d||a.y<0-m||a.y>1+m?(on_select_out(b),
b&&b.stopPropagation()):(d=Math.min(d,.25),m=Math.min(m,.25),a.x<d?(a.y<m?($("html,body").css("cursor","nw-resize"),objectContainer.mousedown=function(a){prepare_resize(a,n,h,select_box.width,select_box.height,!1,!1)}):a.y>1-m?($("html,body").css("cursor","sw-resize"),objectContainer.mousedown=function(a){prepare_resize(a,n,k,select_box.width,select_box.height,!1,!1)}):($("html,body").css("cursor","w-resize"),objectContainer.mousedown=function(a){prepare_resize(a,n,0,select_box.width,select_box.height,
!1,!0)}),select_box.mousedown=objectContainer.mousedown):a.x>1-d?(a.y<m?($("html,body").css("cursor","ne-resize"),objectContainer.mousedown=function(a){prepare_resize(a,f,h,select_box.width,select_box.height,!1,!1)}):a.y>1-m?($("html,body").css("cursor","se-resize"),objectContainer.mousedown=function(a){prepare_resize(a,f,k,select_box.width,select_box.height,!1,!1)}):($("html,body").css("cursor","e-resize"),objectContainer.mousedown=function(a){prepare_resize(a,f,0,select_box.width,select_box.height,
!1,!0)}),select_box.mousedown=objectContainer.mousedown):a.y<m?($("html,body").css("cursor","n-resize"),objectContainer.mousedown=function(a){prepare_resize(a,0,h,select_box.width,select_box.height,!0,!1)},select_box.mousedown=objectContainer.mousedown):a.y>1-m?($("html,body").css("cursor","s-resize"),objectContainer.mousedown=function(a){prepare_resize(a,0,k,select_box.width,select_box.height,!0,!1)},select_box.mousedown=objectContainer.mousedown):($("html,body").css("cursor","move"),select_box.mousedown=
on_drag_start,objectContainer.mousedown=on_left_click))});b&&b.stopPropagation()}function on_select_over(b){select_box.mousemove=on_selectbox_move;select_box.mouseout=on_select_out}function on_select_out(b){limit_rate(15,select_box_move_state,function(){});$("html,body").css("cursor","default");select_box.mousemove=void 0;select_box.mousedown=void 0;objectContainer.mousedown=on_left_click;select_box.mouseout=void 0}function make_resizable(b){b.interactive=!0;b.mouseover=on_select_over}
function redraw_select_box(){if(select_box)if(select_box.rotation=0,0<selected_entities.length){var b=99999,a=-99999,m=99999,d=-99999,f;for(f in selected_entities){var k=selected_entities[f].container,n,h,e;h=-k.rotation;n=Math.abs(k.width*Math.cos(h))+Math.abs(k.height*Math.sin(h));h=Math.abs(k.width*Math.sin(h))+Math.abs(k.height*Math.cos(h));e=k.x-k.anchor.x*n;k=k.y-k.anchor.y*h;b=Math.min(e,b);m=Math.min(k,m);a=Math.max(e+n,a);d=Math.max(k+h,d)}select_center=[x_rel(b+(a-b)/2),y_rel(m+(d-m)/2)];
select_box.left_x=b;select_box.upper_y=m;select_box.width=a-b;select_box.height=d-m;select_box.x=b+select_box.width/2;select_box.y=m+select_box.height/2;rotate_arrow0.x=b+select_box.width+rotate_arrow0.width/2+y_abs(ROTATE_ARROW_MARGIN)*zoom_level;rotate_arrow0.y=m+select_box.height/2;rotate_arrow1.x=b+select_box.width/2;rotate_arrow1.y=m-rotate_arrow1.width/2-y_abs(ROTATE_ARROW_MARGIN)*zoom_level;rotate_arrow2.x=b-rotate_arrow2.width/2-y_abs(ROTATE_ARROW_MARGIN)*zoom_level;rotate_arrow2.y=m+select_box.height/
2;rotate_arrow3.x=b+select_box.width/2;rotate_arrow3.y=m+rotate_arrow3.width/2+select_box.height+y_abs(ROTATE_ARROW_MARGIN)*zoom_level;objectContainer.removeChild(rotate_arrow0);objectContainer.removeChild(rotate_arrow1);objectContainer.removeChild(rotate_arrow2);objectContainer.removeChild(rotate_arrow3);objectContainer.addChild(rotate_arrow0);objectContainer.addChild(rotate_arrow1);objectContainer.addChild(rotate_arrow2);objectContainer.addChild(rotate_arrow3);objectContainer.removeChild(select_box);
objectContainer.addChild(select_box)}else remove_select_box();select_box_dirty=!1}
function start_rotate_selection(b,a){limit_rate(15,drag_state,function(){});objectContainer.buttonMode=!0;setup_mouse_events(rotate_selection.bind(void 0,this,b),stop_rotate_selection.bind(void 0,this,b));var m=a.data.getLocalPosition(background_sprite);last_mouse_location=[mouse_x_rel(m.x),mouse_y_rel(m.y)];for(var d in selected_entities)m=room_data.slides[active_slide].entities[selected_entities[d].uid].container,m.x_orig=m.x,m.y_orig=m.y,m.rotation_orig=m.rotation;objectContainer.removeChild(rotate_arrow0);
objectContainer.removeChild(rotate_arrow1);objectContainer.removeChild(rotate_arrow2);objectContainer.removeChild(rotate_arrow3);objectContainer.addChild(this);a.stopPropagation()}
function rotate_selection(b,a,m){limit_rate(15,drag_state,function(){var d=m.data.getLocalPosition(background_sprite),d=[mouse_x_rel(d.x),mouse_y_rel(d.y)],f=d[1]-last_mouse_location[1];b.x+=x_abs(d[0]-last_mouse_location[0]);b.y+=y_abs(f);a=Math.atan2(-(d[1]-select_center[1]),d[0]-select_center[0])-a;var f=Math.sin(-a),k=Math.cos(-a),n;for(n in selected_entities){var h=room_data.slides[active_slide].entities[selected_entities[n].uid].container;h.x=h.x_orig;h.y=h.y_orig;h.x-=x_abs(select_center[0]);
h.y-=y_abs(select_center[1]);var e=h.x;h.x=h.x*k-h.y*f;h.y=e*f+h.y*k;h.x+=x_abs(select_center[0]);h.y+=y_abs(select_center[1]);h.rotation=h.rotation_orig-a}select_box.rotation=-a;last_mouse_location=d;render_scene()})}
function stop_rotate_selection(b,a,m){limit_rate(15,drag_state,function(){});objectContainer.buttonMode=!1;setup_mouse_events(void 0,void 0);m=m.data.getLocalPosition(background_sprite);m=[mouse_x_rel(m.x),mouse_y_rel(m.y)];var d=m[1]-last_mouse_location[1];b.x+=x_abs(m[0]-last_mouse_location[0]);b.y+=y_abs(d);a=Math.atan2(-(m[1]-select_center[1]),m[0]-select_center[0])-a;b=Math.sin(-a);m=Math.cos(-a);var d=["drag",[]],f;for(f in selected_entities){var k=room_data.slides[active_slide].entities[selected_entities[f].uid],
n=k.container,n=room_data.slides[active_slide].entities[selected_entities[f].uid].container;n.x=n.x_orig;n.y=n.y_orig;n.x-=x_abs(select_center[0]);n.y-=y_abs(select_center[1]);var h=n.x;n.x=n.x*m-n.y*b;n.y=h*b+n.y*m;n.x+=x_abs(select_center[0]);n.y+=y_abs(select_center[1]);h=[1,1];k.scale&&(h=[k.scale[0],k.scale[1]]);var e=0;k.rotation&&(e=k.rotation);d[1].push([[k.x,k.y,[h[0],h[1]],e],k.uid]);h=n.x-n.x_orig;e=n.y-n.y_orig;n.x=n.x_orig;n.y=n.y_orig;k.rotation||(k.rotation=0);n=(k.rotation+a)%(2*Math.PI);
socket.emit("drag",room,k.uid,active_slide,x_rel(x_abs(k.x)+h),y_rel(y_abs(k.y)+e),k.scale,n);drag_entity(k,x_rel(x_abs(k.x)+h),y_rel(y_abs(k.y)+e),k.scale,n)}undo_list.push(clone_action(d));select_box_dirty=!0;render_scene()}
function select_entities(){remove_select_box();var b=99999,a=-99999,m=99999,d=-99999,f;for(f in selected_entities){var k=room_data.slides[active_slide].entities[selected_entities[f].uid].container,n,h,e;h=-k.rotation;n=Math.abs(k.width*Math.cos(h))+Math.abs(k.height*Math.sin(h));h=Math.abs(k.width*Math.sin(h))+Math.abs(k.height*Math.cos(h));e=k.x-k.anchor.x*n;k=k.y-k.anchor.y*h;b=Math.min(x_rel(e),b);m=Math.min(y_rel(k),m);a=Math.max(x_rel(e)+x_rel(n),a);d=Math.max(y_rel(k)+y_rel(h),d);room_data.slides[active_slide].entities[selected_entities[f].uid].container.alpha=
select_alpha}if(0<selected_entities.length){select_center=[b+(a-b)/2,m+(d-m)/2];f=new PIXI.Rectangle(0,0,x_abs(a-b),y_abs(d-m),5);select_box=draw_select_box(f);select_box.anchor.x=.5;select_box.anchor.y=.5;f=x_abs(b);n=y_abs(m);select_box.left_x=f;select_box.upper_y=n;select_box.x=f+x_abs(a-b)/2;select_box.y=n+y_abs(d-m)/2;make_resizable(select_box);var g=new PIXI.Texture.fromImage(image_host+"rotate.png"),b=g.width/g.height,c=y_abs(ROTATE_ARROW_SCALE)*zoom_level,p=c*b,b=function(a,b,d){var e=new PIXI.Sprite(g);
e.anchor.x=.5;e.anchor.y=.5;e.width=p;e.height=c;e.interactive=!0;e.buttonMode=!0;e.draggable=!0;e.mousedown=start_rotate_selection.bind(e,d);e.rotation=-d;e.x=a;e.y=b;objectContainer.addChild(e);return e};rotate_arrow0=b(f+select_box.width+p/2+y_abs(ROTATE_ARROW_MARGIN)*zoom_level,n+select_box.height/2,0);rotate_arrow1=b(f+select_box.width/2,n-p/2-y_abs(ROTATE_ARROW_MARGIN)*zoom_level,Math.PI/2);rotate_arrow2=b(f-p/2-y_abs(ROTATE_ARROW_MARGIN)*zoom_level,n+select_box.height/2,Math.PI);rotate_arrow3=
b(f+select_box.width/2,n+p/2+select_box.height+y_abs(ROTATE_ARROW_MARGIN)*zoom_level,-Math.PI/2);objectContainer.addChild(select_box)}render_scene()}function draw_select_box(b){var a=new PIXI.Graphics;a.lineStyle(1*zoom_level,16777215,.2);a.beginFill(16777215,.2);a.drawShape(b);a.endFill();return new PIXI.Sprite(renderer.generateTexture(a))}
function select_all(){previously_selected_entities=selected_entities;selected_entities=[];for(var b in room_data.slides[active_slide].entities)room_data.slides[active_slide].entities.hasOwnProperty(b)&&room_data.slides[active_slide].entities[b].container&&selected_entities.push(room_data.slides[active_slide].entities[b]);select_entities();undo_list.push(clone_action(["select",selected_entities,previously_selected_entities]))}
function remove_select_box(){limit_rate(15,select_box_move_state,function(){});select_box&&(select_box.mousedown=void 0,select_box.mousemove=void 0,select_box.mouseup=void 0,select_box.mouseout=void 0,select_box.mouseover=void 0,select_box.mouseupoutside=void 0,objectContainer.mousedown=on_left_click,objectContainer.removeChild(select_box),objectContainer.removeChild(rotate_arrow0),objectContainer.removeChild(rotate_arrow1),objectContainer.removeChild(rotate_arrow2),objectContainer.removeChild(rotate_arrow3),
select_box=void 0,render_scene());$("html,body").css("cursor","default")}function deselect_all(){remove_select_box();previously_selected_entities=selected_entities;for(var b in selected_entities)selected_entities[b].container.filters=void 0,selected_entities[b].container.alpha=selected_entities[b].alpha;selected_entities=[]}var INTERPOLATION_RESOLUTION=25,INTERPOLATION_TENSION=.5,INTERPOLATION_LOOKBACK=10;
function smooth_draw(b,a,m,d){a=getCurvePoints(a,INTERPOLATION_TENSION,INTERPOLATION_RESOLUTION,m);b.beginPath();b.moveTo(a[0]*d,a[1]*d);for(m=2;m<a.length;m+=2)b.lineTo(a[m]*d,a[m+1]*d);b.stroke();b=a[a.length-2]-a[a.length-20];d=a[a.length-1]-a[a.length-19];m=Math.sqrt(Math.pow(b,2)+Math.pow(d,2));return[[a[a.length-2]-b/m,a[a.length-1]-d/m],[a[a.length-2],a[a.length-1]]]}var draw_state={},point_buffer=[];
function on_draw_move(b){limit_rate(15,draw_state,function(){var a=renderer.plugins.interaction.eventData.data.global,b=last_point[0]*MOUSE_DRAW_SMOOTHING+(1-MOUSE_DRAW_SMOOTHING)*a.x,d=last_point[1]*MOUSE_DRAW_SMOOTHING+(1-MOUSE_DRAW_SMOOTHING)*a.y;new_drawing.path.push([from_x_local(b)-new_drawing.x,from_y_local(d)-new_drawing.y]);temp_draw_context.clearRect(0,0,temp_draw_canvas.width*DRAW_QUALITY,temp_draw_canvas.height*DRAW_QUALITY);point_buffer.push(b,d,a.x,a.y);smooth_draw(temp_draw_context,
point_buffer,!1,DRAW_QUALITY);point_buffer.pop();point_buffer.pop();new_drawing.path.push([from_x_local(a.x)-new_drawing.x,from_y_local(a.y)-new_drawing.y]);draw_end_path(temp_draw_context,new_drawing);new_drawing.path.pop();last_point=[b,d]})}
function on_draw_end(b){limit_rate(15,draw_state,function(){});b=renderer.plugins.interaction.eventData.data.global;new_drawing.path.push([from_x_local(b.x)-new_drawing.x,from_y_local(b.y)-new_drawing.y]);create_drawing2(new_drawing,DRAW_QUALITY);emit_entity(new_drawing);undo_list.push(clone_action(["add",[new_drawing]]));temp_draw_context.clearRect(0,0,temp_draw_canvas.width*DRAW_QUALITY,temp_draw_canvas.height*DRAW_QUALITY);temp_draw_context.beginPath();setup_mouse_events(void 0,void 0);new_drawing=
null}function drawRotatedImage(b,a,m){b.save();b.translate(a.width/2,a.height/2);b.rotate(m);b.translate(-(a.width/2),-(a.height/2));b.drawImage(a,0,0);b.restore()}function draw_end_path(b,a){if(a.path.length>=ARROW_LOOKBACK){var m=Math.max(0,a.path.length-ARROW_LOOKBACK),m=[to_x_local(a.x+a.path[m][0]),to_y_local(a.y+a.path[m][1])],d=[to_x_local(a.x+a.path[a.path.length-1][0]),to_y_local(a.y+a.path[a.path.length-1][1])];draw_end(b,a,m,d,1/zoom_level,DRAW_QUALITY)}}
function draw_end(b,a,m,d,f,k){var n=size_y/1E3*10*f;a.end_size&&(n=size_y/1E3*a.end_size*f);b.stroke();b.beginPath();"arrow"==a.end?draw_arrow(b,m,d,n,k):"T"==a.end&&draw_T(b,m,d,n,k)}function draw_arrow(b,a,m,d,f){var k=m[0]-a[0];a=m[1]-a[1];l=Math.sqrt(Math.pow(k,2)+Math.pow(a,2));k/=l;a/=l;drawArrow(b,m[0],m[1],m[0]+k,m[1]+a,3,1,Math.PI/8,d*ARROW_SCALE2,f)}
function draw_T(b,a,m,d,f){d*=TEND_SCALE2;var k=m[0]-a[0];a=m[1]-a[1];l=Math.sqrt(Math.pow(k,2)+Math.pow(a,2));k/=l;a/=l;a=-a;b.stroke();var n=b.getLineDash();b.setLineDash([]);b.beginPath();b.moveTo((m[0]-d*a)*f,(m[1]-d*k)*f);b.lineTo((m[0]+d*a)*f,(m[1]+d*k)*f);b.stroke();b.setLineDash(n)}function init_shape_canvas(b,a,m,d){void 0===m&&(m=1);init_canvas(b,a.outline_thickness*m,a.outline_color,a.style,a.fill_opacity,a.fill_color,a.outline_opacity,[10*d,10*d])}
function canvas2container2(b,a,m,d,f){b=PIXI.Texture.fromCanvas(a);b=new PIXI.Sprite(b);f.container=b;b.texture.baseTexture.source.src=f.uid;b.hitArea=new PIXI.TransparencyHitArea.create(b,!1);init_dragging(b);b.entity=f;room_data.slides[active_slide].entities[f.uid]=f;return!0}
function draw_entity(b,a,m,d,f){("00000"+(b.color|0).toString(16)).substr(-6);var k=background_sprite.height;b.draw_zoom_level&&(a/=b.draw_zoom_level);m*=background_sprite.height/renderer.view.height*a;d=20+d*m;var n=[];if(0<b.path.length){for(var h=9999,e=9999,g=-9999,c=-9999,p=0;p<b.path.length;p++){var y=b.path[p][0],q=b.path[p][1],h=Math.min(h,y),e=Math.min(e,q),g=Math.max(g,y),c=Math.max(c,q);n.push(k*y*a,k*q*a)}if("curve"==b.type||"area"==b.type)d+=Math.max(g-h,c-e)*k*a*.3;g=Math.ceil(k*(g-
h)*a+d);c=Math.ceil(k*(c-e)*a+d);y=document.createElement("canvas");y.width=g;y.height=c;for(var q=y.getContext("2d"),A=-h*k*a+d/2,k=-e*k*a+d/2,p=0;p<n.length;p+=2)n[p]+=A,n[p+1]+=k;f(q,n,a,m);canvas2container2(q,y,g,c,b);b.container.height/=a;b.container.width/=a;b.container.x=x_abs(b.x)+x_abs(h)-d/2/a;b.container.y=y_abs(b.y)+y_abs(e)-d/2/a;b.container.orig_scale=[b.container.scale.x,b.container.scale.y];objectContainer.addChild(b.container);render_scene()}}
function create_drawing2(b,a,m){a||(a=1);m||(m=1);var d=b.thickness;b.end_size&&(d=2*b.end_size);draw_entity(b,a,m,d,function(a,d,m,h){init_canvas_simple(a,b.thickness*h,b.color,b.style,[10*m,10*m]);m=smooth_draw(a,d,!1,1);if(b.end){if(b.path.length>=ARROW_LOOKBACK){var e=Math.max(0,b.path.length-ARROW_LOOKBACK);m[0]=[d[2*e],d[2*e+1]]}draw_end(a,b,m[0],m[1],h,1)}})}
function create_curve2(b,a,m){a||(a=1);m||(m=1);var d=b.thickness;b.end_size&&(d=2*b.end_size);draw_entity(b,a,m,d,function(a,d,m,h){init_canvas_simple(a,b.thickness*h,b.color,b.style,[10*m,10*m]);d=smooth_draw(a,d,!1,1);b.end&&draw_end(a,b,d[0],d[1],h,1)})}
function create_line2(b,a,m){a||(a=1);m||(m=1);var d=b.thickness;b.end_size&&(d=2*b.end_size);draw_entity(b,a,m,d,function(a,d,m,h){init_canvas_simple(a,b.thickness*h,b.color,b.style,[10*m,10*m]);a.moveTo(d[0],d[1]);for(m=2;m<d.length;m+=2)a.lineTo(d[m],d[m+1]);a.stroke();draw_end(a,b,[d[d.length-4],d[d.length-3]],[d[d.length-2],d[d.length-1]],h,1)})}
function create_area2(b,a,m){a||(a=1);m||(m=1);var d=b.outline_thickness;b.path[b.path.length-1]==[0,0]&&b.path.pop();draw_entity(b,a,m,d,function(a,d,m,h){init_shape_canvas(a,b,h,m);smooth_draw(a,d,!0,1);a.fill()})}function create_polygon2(b,a,m){a||(a=1);m||(m=1);draw_entity(b,a,m,b.outline_thickness,function(a,f,k,m){init_shape_canvas(a,b,m,k);a.moveTo(f[0],f[1]);for(k=2;k<f.length;k+=2)a.lineTo(f[k],f[k+1]);a.lineTo(f[0],f[1]);a.stroke();a.fill()})}
function create_rectangle2(b,a,m){a||(a=1);m||(m=1);var d=b.outline_thickness,f=background_sprite.height;b.draw_zoom_level&&(a/=b.draw_zoom_level);m*=background_sprite.height/renderer.view.height*a;var d=20+d*m,k=Math.ceil(f*b.width*a+d),n=Math.ceil(f*b.height*a+d),h=document.createElement("canvas");h.width=k;h.height=n;var e=h.getContext("2d");init_shape_canvas(e,b,m,a);e.fillRect(d/2,d/2,f*b.width*a,f*b.height*a);e.strokeRect(d/2,d/2,f*b.width*a,f*b.height*a);canvas2container2(e,h,k,n,b);b.container.x=
x_abs(b.x)-d/2/a;b.container.y=y_abs(b.y)-d/2/a;b.container.width/=a;b.container.height/=a;b.container.orig_scale=[b.container.scale.x,b.container.scale.y];objectContainer.addChild(b.container);render_scene()}
function create_circle2(b,a,m){a||(a=1);m||(m=1);var d=b.outline_thickness,f=background_sprite.height;b.draw_zoom_level&&(a/=b.draw_zoom_level);var k=background_sprite.height/renderer.view.height*a*m,d=20+d*k;m=Math.ceil(2*f*b.radius*a+d);var n=Math.ceil(2*f*b.radius*a+d),h=document.createElement("canvas");h.width=m;h.height=n;var e=h.getContext("2d");init_shape_canvas(e,b,k,a);to_x_local_vect(b.radius);var g=f*b.radius*a+d/2;e.beginPath();e.arc(g,g,f*b.radius*a,0,2*Math.PI);e.fill();e.stroke();if(b.draw_radius){e.save();
e.lineWidth=size_y/1E3*2;e.strokeStyle="#FFFFFF";e.fillStyle="#FFFFFF";e.beginPath();e.moveTo(g,g);e.lineTo(g+f*a*b.draw_radius[0],g+f*a*b.draw_radius[1]);e.stroke();k=g+f*a*b.draw_radius[0]/2;g+=f*a*b.draw_radius[1]/2;e.font="33px Arial";var c=Math.sqrt(Math.pow(background.size_x*b.draw_radius[0],2)+Math.pow(background.size_y*b.draw_radius[1],2));e.lineWidth=to_y_local(.5)/1E3;e.strokeStyle="#000000";e.fillStyle="#FFFFFF";var p="",p="lol"==game?p+(Math.round(10*c)/10+"u"):"wows"==game?p+(Math.round(.01*
c)/10+"km"):p+(Math.round(10*c)/10+"m");e.fillText(p,k,g);e.restore()}canvas2container2(e,h,m,n,b);b.container.x=x_abs(b.x)-f*b.radius-d/2/a;b.container.y=y_abs(b.y)-f*b.radius-d/2/a;b.container.width/=a;b.container.height/=a;b.container.orig_scale=[b.container.scale.x,b.container.scale.y];objectContainer.addChild(b.container);render_scene()}
function start_drawing(){draw_context.clearRect(0,0,draw_canvas.width*DRAW_QUALITY,draw_canvas.height*DRAW_QUALITY);temp_draw_context.clearRect(0,0,temp_draw_canvas.width*DRAW_QUALITY,temp_draw_canvas.height*DRAW_QUALITY);"setLineDash"in temp_draw_context&&temp_draw_context.setLineDash([]);"setLineDash"in draw_context&&draw_context.setLineDash([]);$(temp_draw_canvas).show();$(draw_canvas).show()}function stop_drawing(){$(temp_draw_canvas).hide();$(draw_canvas).hide()}
function snap_and_emit_entity(b){move_entity(b,0,0);emit_entity(b);render_scene()}function update_timeline(b){if(b.start_time){for(var a=b.start_time;timeline_entities[a];)a+=EPSILON;timeline.add(a);timeline_entities[a]=b;for(a=b.end_time;timeline_entities[a];)a+=EPSILON;timeline.add(a);timeline_entities[a]=b}}
function rebuild_timeline(b){timeline=new FastPriorityQueue;timeline_entities={};for(var a in room_data.slides[active_slide].entities)room_data.slides[active_slide].entities.hasOwnProperty(a)&&room_data.slides[active_slide].entities[a].container&&(update_timeline(room_data.slides[active_slide].entities[a]),remove(a,!0))}
function progress_timeline(){if(!timeline.isEmpty())for(var b=video_progress(),a=timeline.peek();b>=a;){a=timeline_entities[a];video_progress()>=a.end_time?a.container&&remove(a.uid,!0):a.start_time<=b&&(a.container||create_entity(a));timeline.poll();if(timeline.isEmpty())break;a=timeline.peek()}}
function emit_entity(b){var a=b.container;background.is_video&&(b.start_time=video_progress(),b.end_time=video_progress()+delay,update_timeline(b));b.container=void 0;socket.emit("create_entity",room,b,active_slide);room_data.slides[active_slide].z_top++;b.z_index=room_data.slides[active_slide].z_top;b.container=a;set_anchor(b.container,.5,.5);render_scene()}
function on_icon_end(b){setup_mouse_events(void 0,void 0);var a=b.data.getLocalPosition(background_sprite);b=icon_color;selected_icon_no_color&&(b=16777215);var m=icon_size*icon_extra_scale*ICON_SCALE,m=m*zoom_level,d=mouse_x_rel(a.x)-m/2,a=mouse_y_rel(a.y)-m/2;b={uid:newUid(),type:"icon",tank:selected_icon,x:d,y:a,size:m,color:b,alpha:1,label:$("#icon_label").val(),label_font_size:label_font_size*zoom_level,label_color:"#ffffff",label_font:"Arial",label_pos:label_position,label_background:$("#label_background").get(0).checked,
draw_zoom_level:zoom_level};b.label_background&&(b.label_color="#000000");undo_list.push(clone_action(["add",[b]]));create_icon(b,snap_and_emit_entity)}
function on_text_end(b){var a=$("#text_tool_text").val();setup_mouse_events(void 0,void 0);if(""!=a){var m=b.data.getLocalPosition(background_sprite);b=mouse_x_rel(m.x);m=mouse_y_rel(m.y);a={uid:newUid(),type:"text",x:b,y:m,scale:[1,1],color:text_color,alpha:1,text:a,font_size:font_size*zoom_level,font:"Arial",draw_zoom_level:zoom_level};undo_list.push(clone_action(["add",[a]]));current_text_element=a;create_text2(a);snap_and_emit_entity(a)}}
function on_background_text_end(b){setup_mouse_events(void 0,void 0);var a=b.data.getLocalPosition(background_sprite);b=mouse_x_rel(a.x);a=mouse_y_rel(a.y);b={uid:newUid(),type:"background_text",x:b,y:a,scale:[1,1],color:background_text_color,alpha:1,text:$("#text_tool_background_text").val(),font_size:background_font_size*zoom_level,font:"Arial",draw_zoom_level:zoom_level};undo_list.push(clone_action(["add",[b]]));create_background_text2(b);snap_and_emit_entity(b)}var line_state={};
function on_line_move(b){limit_rate(15,line_state,function(){var a=b.data.getLocalPosition(background_sprite),m;m=0==new_drawing.path.length?[to_x_local(new_drawing.x),to_y_local(new_drawing.y)]:[to_x_local(new_drawing.path[new_drawing.path.length-1][0]+new_drawing.x),to_y_local(new_drawing.path[new_drawing.path.length-1][1]+new_drawing.y)];a=[to_x_local(mouse_x_rel(a.x)),to_y_local(mouse_y_rel(a.y))];temp_draw_context.clearRect(0,0,temp_draw_canvas.width*DRAW_QUALITY,temp_draw_canvas.height*DRAW_QUALITY);
temp_draw_context.beginPath();temp_draw_context.moveTo(m[0]*DRAW_QUALITY,m[1]*DRAW_QUALITY);temp_draw_context.lineTo(a[0]*DRAW_QUALITY,a[1]*DRAW_QUALITY);temp_draw_context.stroke();draw_end(temp_draw_context,new_drawing,m,a,1/zoom_level,DRAW_QUALITY)})}
function on_line_end(b){limit_rate(15,line_state,function(){});try{var a=renderer.plugins.interaction.eventData.data.global,m=from_x_local(a.x)-new_drawing.x,d=from_y_local(a.y)-new_drawing.y;0!=new_drawing.path.length&&m==last(new_drawing.path)[0]&&d==last(new_drawing.path)[1]||new_drawing.path.push([m,d]);shifted?(temp_draw_context.clearRect(0,0,temp_draw_canvas.width*DRAW_QUALITY,temp_draw_canvas.height*DRAW_QUALITY),draw_context.clearRect(0,0,draw_canvas.width*DRAW_QUALITY,draw_canvas.height*
DRAW_QUALITY),draw_context.lineTo(a.x*DRAW_QUALITY,a.y*DRAW_QUALITY),draw_context.stroke()):(create_line2(new_drawing,DRAW_QUALITY),emit_entity(new_drawing),undo_list.push(clone_action(["add",[new_drawing]])),setup_mouse_events(void 0,void 0),stop_drawing(),new_drawing=null)}catch(f){}render_scene()}
function create_text_sprite(b,a,m,d,f,k,n){void 0===n&&(n="");var h=document.createElement("canvas"),e=objectContainer.scale.y,g=h.getContext("2d"),c=TEXT_QUALITY;g.font=n+" "+Math.round(2*m*e*c)+"px "+d;g.textBaseline="top";for(var p=g.measureText(b);p.width>MAX_CANVAS_SIZE;)c/=2,g.font=n+" "+Math.round(2*m*e*c)+"px "+d,p=g.measureText(b);p=g.measureText(b);h.height=m*e*c*2.7;f?(h.width=p.width+.2*h.height,g.fillStyle="#ffffff",g.lineWidth=.1*h.height,g.fillRect(0,0,p.width+.2*h.height,h.height),
g.strokeRect(0,0,p.width+.2*h.height,h.height)):h.width=p.width;g.fillStyle=a;g.font=n+" "+Math.round(2*m*e*c)+"px "+d;g.textBaseline="top";k&&(g.shadowColor="black",g.shadowOffsetX=c,g.shadowOffsetY=c,g.shadowBlur=5);f?g.fillText(b,.1*h.height,.1*h.height):g.fillText(b,0,0);b=PIXI.Texture.fromCanvas(h);b=new PIXI.Sprite(b);a=b.width/b.height;b.height=Math.round(2*m*e)/objectContainer.scale.x;b.width=b.height*a;b.x=0;b.y=0;return b}
function create_text2(b){var a="#"+("00000"+(b.color|0).toString(16)).substr(-6),a=create_text_sprite(b.text,a,TEXT_SCALE*b.font_size,b.font,!1,!0),m=a.width/a.height;a.height=x_abs(b.font_size/390);a.width=a.height*m;a&&(b.container=a,a.x=x_abs(b.x),a.y=y_abs(b.y),objectContainer.addChild(a),a.texture.baseTexture.source.src=b.uid,init_dragging(a),a.entity=b,room_data.slides[active_slide].entities[b.uid]=b,render_scene())}
function create_background_text2(b){var a="#"+("00000"+(b.color|0).toString(16)).substr(-6),a=create_text_sprite(b.text,a,BACKGROUND_TEXT_SCALE*b.font_size,b.font,!0,!1),m=a.width/a.height;a.height=x_abs(b.font_size/420);a.width=a.height*m;a&&(b.container=a,a.x=x_abs(b.x),a.y=y_abs(b.y),objectContainer.addChild(a),a.texture.baseTexture.source.src=b.uid,init_dragging(a),a.entity=b,room_data.slides[active_slide].entities[b.uid]=b,render_scene())}
function nearestPow2(b){return Math.pow(2,Math.round(Math.log(b)/Math.log(2)))}
function create_icon_cont(b,a){var m=new PIXI.Sprite(a);m.tint=b.color;var d=m.width/m.height;b.container=m;b.container.x=x_abs(b.x);b.container.y=y_abs(b.y);m.height=x_abs(b.size);m.width=m.height*d;set_anchor(m,.5,.5);if(b.label&&""!=b.label){var f=create_text_sprite(b.label,b.label_color,ICON_LABEL_SCALE*b.label_font_size,b.label_font,b.label_background,!b.label_background,b.label_font_modifier),k=b.label_pos;k||(k="pos_bottom");b.container.addChild(f);var n;n=b.label_background?450:470;d=f.width/
f.height;f.height=x_abs(b.label_font_size/n)/b.container.scale.y;f.width=f.height*d;d=m.width/m.scale.x;m=m.height/m.scale.y;"pos_bottom"==k?(f.x-=f.width/2,f.y+=m/2):"pos_top"==k?(f.x-=f.width/2,f.y-=f.height+m/2):"pos_left"==k?(f.x-=f.width+d/2,f.y-=f.height/2):"pos_right"==k?(f.x+=d/2,f.y-=f.height/2):"pos_top_left"==k?(f.x-=f.width+d/2,f.y-=m/2+f.height/2):"pos_top_right"==k?(f.x+=d/2,f.y-=m/2+f.height/2):"pos_bottom_left"==k?f.x-=f.width+d/2:"pos_bottom_right"==k&&(f.x+=d/2)}b.container.entity=
b;b.container.alpha=b.alpha;init_dragging(b.container);objectContainer.addChild(b.container);render_scene();room_data.slides[active_slide].entities[b.uid]=b}
function create_icon(b,a){try{var m=$('button[id*="'+b.tank+'"]').find("span");m[0].innerHTML=parseInt(m[0].innerHTML)+1;m=$("#icon_counter");m.text((parseInt(m.text())+1).toString())}catch(n){}var m=b.tank,d=b.tank.slice(-3);"png"!=d&&"jpg"!=d&&(m+=".png");var f;texture_atlas[m]&&!is_safari()?(m=texture_atlas[m],f=new PIXI.Texture(loader.resources[m.sprite].texture,new PIXI.Rectangle(m.x,m.y,m.width,m.height))):f=PIXI.Texture.fromImage(image_host+m);resources_loading++;var k=function(){create_icon_cont(b,
f);a&&a(b);resources_loading--};if(f.baseTexture.hasLoaded)k();else f.baseTexture.on("loaded",function(){k()})}function init_dragging(b){dragging_enabled?make_draggable(b):make_undraggable(b);b.orig_scale=[b.scale.x,b.scale.y]}function make_draggable(b){b.interactive=!0;b.buttonMode=!0;b.draggable=!0;b.mousedown=on_drag_start;b.touchstart=on_drag_start}function make_undraggable(b){b.interactive=!1;b.buttonMode=!1;b.draggable=!1;delete b.mousedown;delete b.touchstart}
function set_anchor(b,a,m){var d=a-b.anchor.x,f=m-b.anchor.y;b.anchor.x=a;b.anchor.y=m;b.x+=d*b.width;b.y+=f*b.height}
function create_entity(b){room_data.slides[active_slide].entities[b.uid]&&remove(b.uid);"background"==b.type?set_background(b):"icon"==b.type?create_icon(b):"drawing"==b.type?create_drawing2(b,DRAW_QUALITY):"curve"==b.type?create_curve2(b,DRAW_QUALITY):"line"==b.type?create_line2(b,DRAW_QUALITY):"text"==b.type?create_text2(b):"background_text"==b.type?create_background_text2(b):"note"==b.type?create_note(b):"rectangle"==b.type?create_rectangle2(b,DRAW_QUALITY):"circle"==b.type?create_circle2(b,DRAW_QUALITY):
"polygon"==b.type?create_polygon2(b,DRAW_QUALITY):"area"==b.type&&create_area2(b,DRAW_QUALITY);b.container&&(b.scale&&(b.container.scale.x=b.container.orig_scale[0]*b.scale[0],b.container.scale.y=b.container.orig_scale[1]*b.scale[1]),b.container.anchor&&set_anchor(b.container,.5,.5),b.rotation&&(b.container.rotation=-b.rotation),adjust_zoom(b),background.is_video&&update_timeline(b))}
function update_username(b){""!=b&&b!=my_user.name&&(my_user.name=b,socket.emit("update_user",room,my_user));b=$("#"+my_user.id).find("input");b.attr("placeholder",my_user.name);b.val("")}
function add_user(b){my_user_id==b.id&&(my_user=b);if(b.id in userlist){var a=$("#"+b.id);b.id==my_user_id?a.find("input").attr("placeholder",b.name):a.text(b.name)}else b.id==my_user_id?(a="<div class='btn' style='text-align:left;' id='"+b.id+"'><input maxlength='30' type='text' placeholder='"+escapeHtml(b.name)+"'></div>",$("#userlist").prepend(a),a=$("#userlist").find("input"),a.on("blur",function(){update_username(this.value)}),a.onkeypress=function(a){a||(a=window.event);keyCode=a.keyCode||a.which;
"13"==keyCode&&update_username(this.value)}):(a="<button class='btn' style='text-align:left;' data-toggle='tooltip' title='Click to toggle this user&#39;s permission.' id='"+b.id+"'>"+escapeHtml(b.name)+"</button>",$("#userlist").append(a));userlist[b.id]=b;b.role?"owner"==b.role?$("#"+b.id).css("background-color","lime"):"driver"==b.role&&$("#"+b.id).css("background-color","yellow"):$("#"+b.id).css("background-color","#EEEEEE");b.id==my_user_id&&update_my_user();$("#user_count").text(Object.keys(userlist).length.toString())}
function update_my_user(){my_user.logged_in?($("#store_tactic_popover").show(),tactic_name&&""!=tactic_name&&$("#save").show(),$("#sign_in_text").text(my_user.name.substring(0,9)),$("#login_dropdown").removeClass("btn-warning"),$("#login_dropdown").addClass("btn-success")):($("#store_tactic_popover").hide(),$("#save").hide());update_lock()}
function update_lock(){var b=$("#lock div");is_room_locked?b.removeClass("icon-unlock").addClass("icon-lock"):b.removeClass("icon-lock").addClass("icon-unlock");if(is_room_locked&&!my_user.role){$(".mejs-controls").hide();$(".left_column").hide();$("#slide_interactive").hide();$("#slide_static").show();$("#slide_table1").hide();$("#can_not_edit").show();$("#map_select_box").hide();for(var a in room_data.slides[active_slide].entities)room_data.slides[active_slide].entities[a]&&"note"==room_data.slides[active_slide].entities[a].type&&
room_data.slides[active_slide].entities[a].container&&($("textarea",room_data.slides[active_slide].entities[a].container.menu).prop("readonly",!0),$("button",room_data.slides[active_slide].entities[a].container.menu).hide());my_tracker&&stop_tracking();"ping_context"==active_context&&(objectContainer.mousemove=void 0)}else for(a in $(".mejs-controls").show(),$(".left_column").show(),$("#slide_interactive").show(),$("#slide_static").hide(),$("#slide_table1").show(),$("#can_not_edit").hide(),$("#map_select_box").show(),
room_data.slides[active_slide].entities)room_data.slides[active_slide].entities[a]&&"note"==room_data.slides[active_slide].entities[a].type&&room_data.slides[active_slide].entities[a].container&&($("textarea",room_data.slides[active_slide].entities[a].container.menu).prop("readonly",!1),$("button",room_data.slides[active_slide].entities[a].container.menu).show());"owner"!=my_user.role&&is_room_locked?($("#store_tactic_popover").hide(),$("#save").hide(),$("#export_tab_button").hide()):(my_user.logged_in?
($("#store_tactic_popover").show(),tactic_name&&""!=tactic_name&&$("#save").show()):($("#store_tactic_popover").hide(),$("#save").hide()),$("#export_tab_button").show());"owner"==my_user.role?($("#lock").show(),$("#nuke_room").show(),$("#lock_camera").show()):($("#lock").hide(),$("#nuke_room").hide(),$("#lock_camera").hide())}function remove_user(b){$("#"+b).remove();delete userlist[b];$("#user_count").text(Object.keys(userlist).length.toString())}
function escapeHtml(b){return b.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function chat(b,a){b=escapeHtml(b);b=b.split(":");$("#chat_box").append('<div class="chatmsg"><b style="color:'+a+';">'+b[0]+"</b>: "+b.slice(1).join(":")+"<br/></div>");$("#chat_box").scrollTop($("#chat_box")[0].scrollHeight)}
function supports_color_input(){var b=document.createElement("input"),a,m=document.documentElement;b.setAttribute("type","color");if(a="text"!==b.type)b.value=":)",b.style.cssText="position:absolute;visibility:hidden;",m.appendChild(b),m.offsetWidth,a=":)"!=b.value,m.removeChild(b);return a}
function initialize_color_picker(b,a){supports_color_input()?$("#"+b+" ~ input").show():$("#"+b+" ~ input").hide();var m=$('select[id="'+b+'"]').val();window[a]=parseInt("0x"+m.substring(1));$("#"+b+" ~ input").attr("value",m);$("#"+b+" ~ input").val(m);$("#"+b+" ~ input").on("change",function(){var d=$(this).val();window[a]=parseInt("0x"+d.substring(1));$("#"+b+'~ span span[data-selected=""]').removeAttr("data-selected")});$('select[id="'+b+'"]').simplecolorpicker().on("change",function(){var d=
$('select[id="'+b+'"]').val();window[a]=parseInt("0x"+d.substring(1));$("#"+b+" ~ input").first().val(d);"track_color"==a&&(my_tracker&&stop_tracking(),start_tracking({x:2E3,y:2E3}))})}
function initialize_slider(b,a,m){var d=$("#"+b);$("#"+a).val(d.attr("value"));window[m]=parseFloat(d.attr("value"));d.on("change",function(b){$("#"+a).val(this.value);window[m]=parseFloat(this.value)});d.on("input",function(b){$("#"+a).val(this.value);window[m]=parseFloat(this.value)});$("#"+a).change(function(){var a=parseFloat(this.value);isNaN(a)?this.value=window[m]:(window[m]=a,d.slider("setValue",window[m]))})}
function clear(b){var a=[],m;for(m in room_data.slides[active_slide].entities)if(room_data.slides[active_slide].entities.hasOwnProperty(m)&&(room_data.slides[active_slide].entities[m].type==b||!b)&&"background"!=room_data.slides[active_slide].entities[m].type){var d=room_data.slides[active_slide].entities[m];remove(m);a.push(d);socket.emit("remove",room,m,active_slide)}undo_list.push(clone_action(["remove",a]))}
function clone_action(b){if(b[1].length){temp_containers=[];for(var a=0;a<b[1].length;a++)temp_containers.push(b[1][a].container),b[1][a].container=null}var m=JSON.stringify(b);if(b[1].length)for(a=0;a<b[1].length;a++)b[1][a].container=temp_containers[a];return JSON.parse(m)}
function undo(){var b=undo_list.pop();if(b)if("add"==b[0]){for(var a in b[1])b[1][a].uid&&(remove(b[1][a].uid),delete b[1][a].container,socket.emit("remove",room,b[1][a].uid,active_slide));redo_list.push(clone_action(b))}else if("drag"==b[0]){for(a in b[1]){var m=b[1][a][0][0],d=b[1][a][0][1],f=b[1][a][0][2],k=b[1][a][0][3],n=b[1][a][1];room_data.slides[active_slide].entities[n]&&(b[1][a][0][0]=room_data.slides[active_slide].entities[n].x,b[1][a][0][1]=room_data.slides[active_slide].entities[n].y,
b[1][a][0][2]=room_data.slides[active_slide].entities[n].scale?[room_data.slides[active_slide].entities[n].scale[0],room_data.slides[active_slide].entities[n].scale[1]]:[1,1],"undefined"!==typeof room_data.slides[active_slide].entities[n].rotation&&(b[1][a][0][3]=room_data.slides[active_slide].entities[n].rotation),drag_entity(room_data.slides[active_slide].entities[n],m,d,f,k),socket.emit("drag",room,n,active_slide,m,d,f,k))}redo_list.push(clone_action(b))}else if("remove"==b[0]){for(a in b[1])m=
b[1][a],delete m.container,socket.emit("create_entity",room,m,active_slide),create_entity(m);redo_list.push(clone_action(b))}else if("select"==b[0]){d=[];for(a in b[2])m=b[2][a],room_data.slides[active_slide].entities.hasOwnProperty(m.uid)&&d.push(m);deselect_all();selected_entities=d;select_entities();redo_list.push(clone_action(b))}render_scene()}
function redo(){var b=redo_list.pop();if(b){if("add"==b[0]){for(var a in b[1])b[1][a].uid&&(socket.emit("create_entity",room,b[1][a],active_slide),create_entity(b[1][a]));undo_list.push(clone_action(b))}else if("drag"==b[0]){for(a in b[1]){var m=b[1][a][0][0],d=b[1][a][0][1],f=b[1][a][0][2],k=b[1][a][0][3],n=b[1][a][1];room_data.slides[active_slide].entities[n]&&(b[1][a][0][0]=room_data.slides[active_slide].entities[n].x,b[1][a][0][1]=room_data.slides[active_slide].entities[n].y,b[1][a][0][2]=room_data.slides[active_slide].entities[n].scale?
[room_data.slides[active_slide].entities[n].scale[0],room_data.slides[active_slide].entities[n].scale[1]]:[1,1],"undefined"!==typeof room_data.slides[active_slide].entities[n].rotation&&(b[1][a][0][3]=room_data.slides[active_slide].entities[n].rotation),drag_entity(room_data.slides[active_slide].entities[n],m,d,f,k),socket.emit("drag",room,n,active_slide,m,d,f,k))}undo_list.push(clone_action(b))}else if("remove"==b[0]){for(a in b[1])m=b[1][a],room_data.slides[active_slide].entities.hasOwnProperty(m.uid)&&
(remove(m.uid),delete m.container,socket.emit("remove",room,m.uid,active_slide));undo_list.push(clone_action(b))}else if("select"==b[0]){d=[];for(a in b[1])m=b[1][a],room_data.slides[active_slide].entities.hasOwnProperty(m.uid)&&d.push(m);deselect_all();selected_entities=d;select_entities();undo_list.push(clone_action(b))}render_scene()}}
function clear_selected(){remove_select_box();var b=selected_entities.slice(0),a=[],m;for(m in b){var d=b[m];remove(b[m].uid);a.push(d);socket.emit("remove",room,d.uid,active_slide)}deselect_all();selected_entities=[];undo_list.push(clone_action(["remove",a]));"drag_context"==active_context&&cancel_drag(!0)}
function drag_entity(b,a,m,d,f){if(b.container){b.container.x+=x_abs(a-b.x);b.container.y+=y_abs(m-b.y);b.x=a;b.y=m;b.scale=d;"undefined"!==typeof f&&null!=f&&(b.rotation=f,b.container.rotation=-f);"note"==b.type&&align_note_text(b);b.container&&(objectContainer.removeChild(b.container),objectContainer.addChild(b.container),d&&(b.container.scale.x=b.container.orig_scale[0]*d[0],b.container.scale.y=b.container.orig_scale[1]*d[1]));select_box_dirty=!1;for(var k in selected_entities)selected_entities[k].uid==
b.uid&&(select_box_dirty=!0);render_scene()}}function find_first_slide(){var b=Math.pow(2,52),a=0,m;for(m in room_data.slides){var d=room_data.slides[m].order;d<b&&(b=d,a=m)}return a}function find_previous_slide(b){var a=-9007199254740990,m=0,d;for(d in room_data.slides){var f=room_data.slides[d].order;f<b&&f>a&&(a=f,m=d)}return m}function find_next_slide(b){var a=9007199254740991,m=0,d;for(d in room_data.slides){var f=room_data.slides[d].order;f>b&&f<a&&(a=f,m=d)}return m}
function hash(b){for(var a=0,m=0;m<b.length;m++)a+=b.charCodeAt(m);return a}function resolve_order_conflicts(b){for(var a in room_data.slides)if(room_data.slides[a].order==b.order){if(hash(b.uid)<hash(a)){a=find_previous_slide(b.order);var m=0;0!=a&&(m=room_data.slides[a].order);b.order=Math.floor((b.order-m)/2)}else a=find_next_slide(b.order),m=b.order+4294967296,0!=a&&(m=room_data.slides[a].order),b.order=Math.floor((m-b.order)/2);resolve_order_conflicts(b);break}}
function update_slide_buttons(){var b=find_previous_slide(room_data.slides[active_slide].order),a=find_next_slide(room_data.slides[active_slide].order);0==b?document.getElementById("prev_slide").disabled=!0:document.getElementById("prev_slide").disabled=!1;0==a?document.getElementById("next_slide").disabled=!0:document.getElementById("next_slide").disabled=!1;1==Object.keys(room_data.slides).length?document.getElementById("remove_slide").disabled=!0:document.getElementById("remove_slide").disabled=
!1;grid_layer.visible=room_data.slides[active_slide].show_grid?!0:!1;b=escapeHtml(room_data.slides[active_slide].name);$("#slide_name_field").val(b);$("#slide_name_field2").val(b);var a=find_first_slide(),m=$("#slide_table");m.empty();do b=escapeHtml(room_data.slides[a].name),a==active_slide?m.append("<tr id='"+a+"' style='background-color:#ADD8E6'><td><a id='"+a+"'>"+b+"</a></td></tr>"):m.append("<tr id='"+a+"'><td><a id='"+a+"'>"+b+"</a></td></tr>"),a=find_next_slide(room_data.slides[a].order);
while(0!=a);var d=$("#slide_container").scrollTop();setTimeout(function(){$("#slide_container").scrollTop(d)},0)}
function transition(b){var a=[],m=[],d=[],f;for(f in room_data.slides[active_slide].entities)room_data.slides[b].entities[f]?d.push(f):a.push(f);for(f in room_data.slides[b].entities)room_data.slides[active_slide].entities.hasOwnProperty(f)||m.push(f);for(var k in a)f=a[k],remove(f,!0);var n;for(k in d)f=d[k],"background"==room_data.slides[b].entities[f].type?n=f:(remove(f,!0),m.push(f));active_slide=b;update_slide_buttons();var h=function(){try{m.sort(function(a,c){return room_data.slides[b].entities[a].z_index-
room_data.slides[b].entities[c].z_index})}catch(a){}for(var d in m)create_entity(room_data.slides[b].entities[m[d]])};n?set_background(room_data.slides[b].entities[n],function(){h();render_scene()}):(h(),render_scene())}
function cancel_drag(b){clearTimeout(drag_timeout);objectContainer.buttonMode=!1;context_before_drag&&(active_context=context_before_drag);context_before_drag=null;if(dragged_entity){dragged_entity.mouseup=void 0;dragged_entity.touchend=void 0;dragged_entity.mouseupoutside=void 0;dragged_entity.touchendoutside=void 0;dragged_entity.mousemove=void 0;dragged_entity.touchmove=void 0;if(b)if(move_selected&&0<selected_entities.length)for(var a in selected_entities)drag_entity(selected_entities[a],selected_entities[a].origin_x,
selected_entities[a].origin_y);else drag_entity(dragged_entity.entity,dragged_entity.entity.origin_x,dragged_entity.entity.origin_y);dragged_entity==select_box&&(make_resizable(select_box),on_select_over.bind(select_box)(),on_selectbox_move.bind(select_box)())}dragged_entity=null;move_selected=!1}
function change_slide(b){if(active_slide!=b){"drag_context"==active_context&&cancel_drag(!0);undo_list=[];redo_list=[];deselect_all();transition(b);b=$("#contexts").find(".active");var a=b.attr("id")+"_context";$(this).attr("data-context")&&(a=b.attr("data-context")+"_context");active_context=a}}
function create_new_slide(b){var a={};a.show_grid=room_data.slides[b].show_grid;a.z_top=room_data.slides[b].z_top;a.uid=newUid();var m=room_data.slides[b].name,d=m.split(" ");isNaN(parseFloat(d[d.length-1]))?m+=" 1":(d[d.length-1]=""+(parseFloat(d[d.length-1])+1),m=d.join(" "));a.name=m;a.entities={};for(var f in room_data.slides[b].entities)d=room_data.slides[b].entities[f].container,delete room_data.slides[b].entities[f].container,a.entities[f]=JSON.parse(JSON.stringify(room_data.slides[b].entities[f])),
room_data.slides[b].entities[f].container=d;d=find_next_slide(room_data.slides[b].order);0==d?f=room_data.slides[b].order+4294967296:(f=room_data.slides[b].order+Math.floor((room_data.slides[d].order-room_data.slides[b].order)/2),m==room_data.slides[d].name&&(a.name=room_data.slides[b].name+" - 1"));a.order=f;return a}
function remove_slide(b){if(1<Object.keys(room_data.slides).length){if(b==active_slide){var a=room_data.slides[b].order,m=find_previous_slide(a);0==m&&(m=find_next_slide(a));change_slide(m);active_slide=m}delete room_data.slides[b]}update_slide_buttons()}function rename_slide(b,a){room_data.slides[b].name=a;update_slide_buttons()}function add_slide(b){resolve_order_conflicts(b);room_data.slides[b.uid]=b;update_slide_buttons()}
function initialize_map_select(b){var a=b.find("option").sort(function(a,b){return a.innerHTML<b.innerHTML?-1:a.innerHTML>b.innerHTML?1:0});b.empty().append(a);b.val("");b.selectpicker&&b.selectpicker("refresh");b.change(function(){var a=b.val().trim();background&&background.path==a||try_select_map(b,a)})}function activity_animation(b){var a=$("#userlist #"+b);a.hasClass("sheen")||(a.addClass("sheen"),setTimeout(function(){a.removeClass("sheen")},1E3))}
function try_select_map(b,a,m){b=background?background.uid:newUid();var d=0,f=0,k=$('option[value="'+a+'"]').attr("data-size");k&&(f=k.split("x"),d=parseFloat(f[0]),f=parseFloat(f[1]));m=m?!0:!1;a.split(".").pop().startsWith();var n={uid:b,type:"background",path:a,size_x:d,size_y:f,custom:m};is_video(a)&&(n.is_video=!0);set_background(n,function(a){a&&(socket.emit("create_entity",room,n,active_slide),background.is_video&&(handle_pause(0),socket.emit("pause_video",room,0)))})}
function add_custom_map(b){var a=$("#map_select"),m=$('#map_select option[value="'+b+'"]');0==m.length&&(m=last(b.split("/")),m=$('<option value="'+b+'">'+m+"</option>"),a.append(m));a.val(b)}function cleanup(){deselect_all();undo_list=[];redo_list=[];if(active_slide)for(var b in room_data.slides[active_slide].entities)room_data.slides[active_slide].entities.hasOwnProperty(b)&&remove(b);room_data={}}
function stop_syncing(){im_syncing=!1;clearInterval(sync_event);sync_event=setInterval(function(){im_syncing=!1;video_paused?clearInterval(sync_event):2E4<Date.now()-get_local_time(last_video_sync[1])&&start_syncing()},1E4+5E3*Math.random())}function handle_play(b,a){video_paused=!1;last_video_sync=[b,a];var m=Date.now()-get_local_time(a);video_media.setCurrentTime(b);0>=m?video_player.play():setTimeout(function(){video_player.play()},m);video_player.play();stop_syncing();play_video_controls()}
function handle_pause(b,a){video_paused=!0;clearInterval(sync_event);im_syncing=!1;video_media.setCurrentTime(b);video_player.pause();pause_video_controls()}function sync_video(b,a){var m=Date.now()-get_local_time(a),m=b+m*base_playback_rate/1E3,m=video_progress()-m;console.log("lag: ",m);.1<Math.abs(m)/base_playback_rate?hard_sync_video(b,a):"youtube"!=video_media.pluginType&&set_playback_rate(base_playback_rate,base_playback_rate+m/VIDEO_SYNC_DELAY)}
function video_progress(){return video_paused?video_media.currentTime:progress+(Date.now()-progress_update)*playback_rate/1E3}function enable_dragging(){if(!dragging_enabled){dragging_enabled=!0;for(var b in room_data.slides[active_slide].entities){var a=room_data.slides[active_slide].entities[b];a.container&&"background"!=a.type&&(a.container.interactive=!0,a.container.buttonMode=!0,a.container.draggable=!0,a.container.mousedown=on_drag_start,a.container.touchstart=on_drag_start)}}}
function disable_dragging(){if(dragging_enabled){dragging_enabled=!1;for(var b in room_data.slides[active_slide].entities){var a=room_data.slides[active_slide].entities[b];a.container&&"background"!=a.type&&(a.container.interactive=!1,a.container.buttonMode=!1,a.container.draggable=!1,delete a.container.mousedown,delete a.container.touchstart)}}}var sync_in_progress=!1,press_play_delay=0;
function hard_sync_video(b,a){if(!sync_in_progress){sync_in_progress=!0;var m=Date.now()-get_local_time(a),m=b+m*base_playback_rate/1E3,d=video_progress()-m;0>d||3<d?(video_media.setCurrentTime(m+1),sync_in_progress=!1):(video_progress(),video_player.pause(),setTimeout(function(){sync_in_progress=!1;if(!video_paused){video_player.play();var a=Date.now(),b=function(d){press_play_delay=Date.now()-a;video_media.removeEventListener("play",b)};video_media.addEventListener("play",b)}},Math.max(0,1E3*d/
base_playback_rate-press_play_delay)))}}function handle_sync(b,a,m){video_paused?im_syncing=!1:(m!=my_user.id&&stop_syncing(),last_video_sync=[b,a],sync_video(b,a))}
function set_playback_rate(b,a){base_playback_rate=b;playback_rate=a;var m=b.toFixed(2);$(".mejs-speed-button").find("button").html(m+"x");$(".mejs-speed-button").find(".mejs-speed-selected").removeClass("mejs-speed-selected");$(".mejs-speed-button").find('input[value="'+m+'"]').next().addClass("mejs-speed-selected");"youtube"==video_media.pluginType?video_media.pluginApi.setPlaybackRate(a):video_media.playbackRate=a}
function create_hp_bar(b){void 0===b&&(b=1);var a=to_x_local_vect(.125*b);b=to_y_local_vect(.015*b);var m=document.createElement("canvas"),d=m.getContext("2d");m.width=a;m.height=b;d.fillStyle="#FFFFFF";d.fillRect(0,0,m.width,m.height);m=PIXI.Texture.fromCanvas(m);m=new PIXI.Sprite(m);m.tint=65280;var d=document.createElement("canvas"),f=d.getContext("2d");d.width=a;d.height=b;f.strokeStyle="#000000";f.lineWidth=1;f.strokeRect(0,0,d.width,d.height);var d=PIXI.Texture.fromCanvas(d),d=new PIXI.Sprite(d),
f=document.createElement("canvas"),k=f.getContext("2d");f.width=a;f.height=b;k.fillStyle="#FF0000";k.fillRect(0,0,f.width,f.height);a=PIXI.Texture.fromCanvas(f);a=new PIXI.Sprite(a);b=new PIXI.Container;b.addChild(a);b.addChild(m);b.addChild(d);return b}var icons={};
function wot_connect(){function b(){for(var a in icons)icons[a]&&icons[a].container&&objectContainer.removeChild(icons[a].container);icons={};render_scene()}function a(a){create_icon(a);a.container.x-=x_abs(.012);a.container.y-=y_abs(.012);var b=create_hp_bar();b.scale.x*=zoom_level;b.scale.y*=zoom_level;b.x-=b.width/2;b.y-=a.container.height+b.height;a.container.addChild(b);var d=create_text_sprite(a.player.substring(0,9),a.label_color,8,"Arial",!1,!0,"bold"),e=d.width/d.height;d.height=x_abs(8/
530);d.width=d.height*e;d.x-=d.width/2;d.y-=a.container.height+b.height+d.height;a.container.addChild(d);a.container.scale.x*=zoom_level;a.container.scale.y*=zoom_level}function m(c){c.onclose=function(a){setTimeout(function(){c=new WebSocket("ws://localhost:6412/");m(c)},1E4)};c.onerror=function(a){c.close()};c.onopen=function(a){b()};c.onmessage=function(c){function m(a){return[(parseFloat(a[0])-f)/h,1-(parseFloat(a[2])-d)/e]}var q=new window.FileReader;q.readAsText(c.data);q.onloadend=function(){if("BATTLE_ENDED"==
q.result)b();else{var c=JSON.parse(q.result);if("tank"in c){var p,t;c.team==g?(p=65280,t="#AAFFAA"):(p=16711680,t="#FFAAAA");p={uid:c.id.toString(),type:"icon",tank:c.type,x:-1,y:-1,size:.02,color:p,alpha:1,label:c.tank.substring(0,10),label_font_size:8,label_color:t,label_font:"Arial",label_font_modifier:"bold",label_pos:"pos_bottom",label_background:!1,label_shadow:!0,label_shadow:!1,maxHealth:c.maxHealth,player:c.name};if(c.position){var v=m(c.position);p.x=v[0];p.y=v[1];a(p)}icons[p.uid]=p}else if("map_dimesions"in
c)f=parseFloat(c.map_dimesions[0][0]),n=parseFloat(c.map_dimesions[1][0]),d=parseFloat(c.map_dimesions[0][1]),k=parseFloat(c.map_dimesions[1][1]),h=n-f,e=k-d;else if("player_team"in c)g=c.player_team;else if("map_id"in c)console.log("map id: ",c.map_id),c=c.map_id,(c=$("#map_select").find("[data-mapid='"+c+"']"))&&try_select_map($("#map_select"),c.val(),!1,function(){render_scene()});else if("remove"in c)p=c.remove.toString(),objectContainer.removeChild(icons[p].container),icons[p]=void 0;else{var r=
new Set;for(t in c)p=t.toString(),icons[p]&&(r.add(p),1<=c[t].length?(v=m(c[t][0]),icons[p].container?(drag_entity(icons[p],v[0],v[1]),icons[p].container.alpha=1):(icons[p].x=v[0],icons[p].y=v[1],a(icons[p])),2==c[t].length&&(v=c[t][1],icons[p].hp!=v&&(icons[p].hp=v,v=icons[p].container.children[1],v.children[1].width=c[t][1]/icons[p].maxHealth*v.children[0].width))):icons[p]&&icons[p].container&&(icons[p].container.alpha=.5),2==c[t].length?icons[p].container&&16776960==icons[p].container.children[1].children[1].tint&&
(icons[p].container.children[1].children[1].tint=65280):icons[p].container&&65280==icons[p].container.children[1].children[1].tint&&(icons[p].container.children[1].children[1].tint=16776960));difference=Object.keys(icons).filter(function(a){return!r.has(a)});for(t in difference)icons[t]&&icons[t].container&&(icons[t].container.alpha=.5);render_scene()}}}}}var d,f,k,n,h,e,g=1;websocket=new WebSocket("ws://localhost:6412/");m(websocket)}
$(document).ready(function(){function b(){video_ready&&progress_timeline();update_pings();scene_dirty&&(select_box_dirty&&redraw_select_box(),renderer.render(objectContainer),scene_dirty=!1);requestAnimationFrame(b)}dpi=document.getElementById("dpitest").offsetHeight;initialize_map_select($("#map_select"));initialize_map_select($("#wotbase_select"));initialize_map_select($("#new_minimap_select"));size_y=size_x=size=Math.min(window.innerHeight,window.innerWidth)-30;renderer=PIXI.autoDetectRenderer(size,
size,{transparent:!0});renderer.autoResize=!0;useWebGL=renderer instanceof PIXI.WebGLRenderer;$(renderer.view).attr("style","position:absolute; z-index: 2; padding:0; margin:0; border:0;");$(".edit_window").append(renderer.view);renderer.view.addEventListener("wheel",function(a){var b=renderer.plugins.interaction.eventData.data.global,d=0>a.deltaY;zoom(d?.1:1-1/1.1,d,[from_x_local(b.x),from_y_local(b.y)],a);$("#zoom_level").text((1/zoom_level).toFixed(2));control_camera&&emit_pan_zoom();a.preventDefault()});
background_sprite=new PIXI.Sprite;objectContainer=new PIXI.Container;grid_layer="aw"==game?new PIXI.Sprite.fromImage(image_host+"aw_grid.png"):"squad"==game?new PIXI.Sprite.fromImage(image_host+"squad_grid.png"):new PIXI.Sprite.fromImage(image_host+"grid.png");grid_layer.height=renderer.height;grid_layer.width=renderer.width;objectContainer.addChild(background_sprite);objectContainer.addChild(grid_layer);objectContainer.interactive=!0;objectContainer.mousedown=on_left_click;objectContainer.touchstart=
on_left_click;$(renderer.view).mousedown(function(a){if(3===a.which||2===a.which)last_pan_loc=[renderer.plugins.interaction.eventData.data.global.x,renderer.plugins.interaction.eventData.data.global.y],setup_mouse_events(on_pan),a.preventDefault()});renderer.view.addEventListener("contextmenu",function(a){setup_mouse_events(void 0);$("#zoom_level").text((1/zoom_level).toFixed(2));control_camera&&emit_pan_zoom();a.preventDefault()});$(renderer.view).mouseup(function(a){if(3===a.which||2===a.which)$("#zoom_level").text((1/
zoom_level).toFixed(2)),setup_mouse_events(void 0),control_camera&&emit_pan_zoom(),a.preventDefault()});var a=[],m=0,d=!1,f,k=!1,n,h=function(b){$("#zoom_level").text((1/zoom_level).toFixed(2));d&&control_camera&&(emit_pan_zoom(),d=!1);for(var c=b.changedTouches,e=0;e<c.length;e++){var h=c[e],h=a.map(function(a){return a.id}).indexOf(h.identifier);a.splice(h,1)}2==a.length?(b.preventDefault(),objectContainer.interactive=!1,m=Math.sqrt(Math.pow(a[0].pos[0]-a[1].pos[0],2)+Math.pow(a[0].pos[1]-a[1].pos[1],
2)),f=[a[0].pos[0]+(a[1].pos[0]-a[0].pos[0])/2,a[0].pos[1]+(a[1].pos[1]-a[0].pos[1])/2],k=!1,n=null):objectContainer.interactive=!0},e={};renderer.view.addEventListener("touchstart",function(b){for(var c=b.changedTouches,d=0;d<c.length;d++){var e=c[d],h=[from_x_local(e.pageX),from_y_local(e.pageY)];a.push({id:e.identifier,pos:h})}2==a.length?(b.preventDefault(),objectContainer.interactive=!1,m=Math.sqrt(Math.pow(a[0].pos[0]-a[1].pos[0],2)+Math.pow(a[0].pos[1]-a[1].pos[1],2)),f=[a[0].pos[0]+(a[1].pos[0]-
a[0].pos[0])/2,a[0].pos[1]+(a[1].pos[1]-a[0].pos[1])/2],k=!1,n=null):objectContainer.interactive=!0});renderer.view.addEventListener("touchend",h);renderer.view.addEventListener("touchendoutside",h);renderer.view.addEventListener("touchcancel",h);renderer.view.addEventListener("touchmove",function(b){limit_rate(15,e,function(){for(var c=b.changedTouches,e=0;e<c.length;e++){var h=c[e],q=[from_x_local(h.pageX),from_y_local(h.pageY)],A;for(A in a)a[A].id==h.identifier&&(a[A].pos=q)}2==a.length?(b.preventDefault(),
objectContainer.interactive=!1,c=Math.sqrt(Math.pow(a[1].pos[0]-a[0].pos[0],2)+Math.pow(a[1].pos[1]-a[0].pos[1],2)),e=to_y_local_vect(c)/dpi,h=[a[0].pos[0]+(a[1].pos[0]-a[0].pos[0])/2,a[0].pos[1]+(a[1].pos[1]-a[0].pos[1])/2],k||1.5<e?(e=.9*(c/m-1),n=e=n?.8*n+.2*e:e,zoom(Math.abs(e),0<e,f),k=d=!0):(d=!0,e=[to_x_local(h[0])-to_x_local(f[0]),to_y_local(h[1])-to_y_local(f[1])],objectContainer.x+=e[0],objectContainer.y+=e[1],correct()),m=c):objectContainer.interactive=!0})});draw_canvas=document.createElement("canvas");
$(draw_canvas).attr("style","padding:0px; margin:0px; border:0; position:absolute; z-index:3; pointer-events:none;");draw_canvas.width=renderer.view.width;draw_canvas.height=renderer.view.height;draw_context=draw_canvas.getContext("2d");$(draw_canvas).css("width",""+renderer.view.width+"px");$(draw_canvas).css("height",""+renderer.view.width+"px");temp_draw_canvas=document.createElement("canvas");$(temp_draw_canvas).attr("style","padding:0px; margin:0px; border:0; position:absolute; z-index:4; pointer-events:none");
temp_draw_canvas.width=renderer.view.width;temp_draw_canvas.height=renderer.view.height;temp_draw_context=temp_draw_canvas.getContext("2d");$(temp_draw_canvas).css("width",""+renderer.view.width+"px");$(temp_draw_canvas).css("height",""+renderer.view.width+"px");$(renderer.view).parent().append(temp_draw_canvas);$(renderer.view).parent().append(draw_canvas);$(temp_draw_canvas).hide();$(draw_canvas).hide();b();loader.once("complete",function(){var a=document.querySelectorAll("input[type=range][list]");
Array.prototype.slice.call(a).forEach(function(a){if("list"in a&&"min"in a&&"max"in a&&"step"in a){var b=document.createElement("datalist"),d=parseFloat(a.getAttribute("min")),e=parseFloat(a.getAttribute("step")),f=parseFloat(a.getAttribute("max"));b.id=a.getAttribute("list");if(20>Math.abs(f-d)/e){for(;d<f+e;d+=e)b.innerHTML+="<option value="+d.toFixed(2)+"></option>";a.parentNode.insertBefore(b,a.nextSibling)}}});texture_atlas["circle.png"]&&!is_safari()?(a=texture_atlas["circle.png"],ping_texture=
new PIXI.Texture(loader.resources[a.sprite].texture,new PIXI.Rectangle(a.x,a.y,a.width,a.height))):ping_texture=PIXI.Texture.fromImage(image_host+"circle.png");$("#slide_table1 tbody").sortable({helper:function(a,b){b.children().each(function(){$(this).width($(this).width())});return b},update:function(a,b){var d;b.item[0].previousElementSibling?(d=room_data.slides[b.item[0].previousElementSibling.id].order,b.item[0].nextElementSibling?(d+=room_data.slides[b.item[0].nextElementSibling.id].order,d/=
2):d+=4294967296):d=room_data.slides[find_first_slide()].order-4294967296;room_data.slides[b.item[0].id].order=d;socket.emit("change_slide_order",room,b.item[0].id,d);update_slide_buttons()}}).disableSelection();$("#modal_cancel").click(function(a){$("#myModal").modal("hide")});$("#link_send").click(function(a){a=$("#send_link").val();var b=a.indexOf("room=");-1==b?alert("No room id found in link."):(tactic_uid=a.slice(b+5).split("&")[0],a=servers[hashstring(tactic_uid)%servers.length],b=active_slide,
$("#this_slide_only").get(0).checked||(b=void 0),$.post("http://"+a+"/add_to_room",{target:tactic_uid,source:room,session_id:$("#sid").attr("data-sid"),host:parse_domain(location.hostname),stored:"false",slide:b}).done(function(a){"Success"!=a&&alert(a)}));$("#myModal").modal("hide")});$('input[name="map_type_select"]').on("change",function(){"select_hd"==this.id?($("#map_select_container").show(),$("#wotbase_select_container").hide(),$("#new_minimap_select_container").hide(),$("#map_select").val("").selectpicker("render")):
"select_wotbase"==this.id?($("#map_select_container").hide(),$("#wotbase_select_container").show(),$("#new_minimap_select_container").hide(),$("#wotbase_select").val("").selectpicker("render")):"select_new_minimap"==this.id&&($("#map_select_container").hide(),$("#wotbase_select_container").hide(),$("#new_minimap_select_container").show(),$("#new_minimap_select").val("").selectpicker("render"))});$("#send_to_link").click(function(a){socket.emit("save_room",room);$("#myModal").modal("show");$("#myModal").on("shown.bs.modal",
function(){$("#send_link").focus()})});$("#custom_map").click(function(a){socket.emit("save_room",room);$("#map_modal").modal("show");$("#map_modal").on("shown.bs.modal",function(){$("#send_link").focus()})});$("#map_modal_cancel").click(function(a){$("#map_modal").modal("hide")});$("#set_map").click(function(a){(a=$("#map_url").val().trim())&&""!=a&&try_select_map($("#map_select"),a,!0);$("#map_modal").modal("hide")});$("#contexts ~ div").each(function(){$(this).hide()});$("#ping_context").show();
$("#store_tactic_popover").hide();$("#save").hide();$("#ping").addClass("active");$("#"+label_position).addClass("active");a=$("#icon_context").find("button:first");a.addClass("selected");selected_icon_no_color="true"==a.attr("data-no_color")?!0:!1;selected_icon=a.attr("id");icon_extra_scale=a.attr("data-scale")?parseFloat(a.attr("data-scale")):1;slide_name=$("#slide_interactive").attr("slide_name");$(".nav-pills > li > a").click(function(){$(".nav-pills > li.active").removeClass("active");$(this).parent().addClass("active")});
initialize_color_picker("curve_colorpicker","curve_color");initialize_color_picker("icon_colorpicker","icon_color");initialize_color_picker("draw_colorpicker","draw_color");initialize_color_picker("ping_colorpicker","ping_color");initialize_color_picker("track_colorpicker","track_color");initialize_color_picker("line_colorpicker","line_color");initialize_color_picker("text_colorpicker","text_color");initialize_color_picker("background_text_colorpicker","background_text_color");initialize_color_picker("rectangle_outline_colorpicker",
"rectangle_outline_color");initialize_color_picker("rectangle_fill_colorpicker","rectangle_fill_color");initialize_color_picker("circle_outline_colorpicker","circle_outline_color");initialize_color_picker("circle_fill_colorpicker","circle_fill_color");initialize_color_picker("polygon_outline_colorpicker","polygon_outline_color");initialize_color_picker("polygon_fill_colorpicker","polygon_fill_color");initialize_color_picker("area_outline_colorpicker","area_outline_color");initialize_color_picker("area_fill_colorpicker",
"area_fill_color");initialize_slider("rectangle_outline_thickness","rectangle_outline_thickness_text","rectangle_outline_thickness");rectangle_outline_thickness=parseFloat($("#rectangle_outline_thickness").val());initialize_slider("rectangle_outline_transparancy","rectangle_outline_transparancy_text","rectangle_outline_transparancy");initialize_slider("rectangle_fill_transparancy","rectangle_fill_transparancy_text","rectangle_fill_transparancy");initialize_slider("circle_outline_thickness","circle_outline_thickness_text",
"circle_outline_thickness");initialize_slider("circle_outline_transparancy","circle_outline_transparancy_text","circle_outline_transparancy");initialize_slider("circle_fill_transparancy","circle_fill_transparancy_text","circle_fill_transparancy");initialize_slider("polygon_outline_thickness","polygon_outline_thickness_text","polygon_outline_thickness");initialize_slider("polygon_outline_transparancy","polygon_outline_transparancy_text","polygon_outline_transparancy");initialize_slider("polygon_fill_transparancy",
"polygon_fill_transparancy_text","polygon_fill_transparancy");initialize_slider("area_outline_thickness","area_outline_thickness_text","area_outline_thickness");initialize_slider("area_outline_transparancy","area_outline_transparancy_text","area_outline_transparancy");initialize_slider("area_fill_transparancy","area_fill_transparancy_text","area_fill_transparancy");initialize_slider("line_thickness","line_thickness_text","line_thickness");initialize_slider("draw_thickness","draw_thickness_text","draw_thickness");
initialize_slider("curve_thickness","curve_thickness_text","curve_thickness");initialize_slider("font_size","font_size_text","font_size");initialize_slider("background_font_size","background_font_size_text","background_font_size");initialize_slider("label_font_size","label_font_size_text","label_font_size");initialize_slider("icon_size","icon_size_text","icon_size");initialize_slider("ping_size","ping_size_text","ping_size");initialize_slider("track_size","track_size_text","track_size");initialize_slider("draw_end_size",
"draw_end_size_text","draw_end_size");initialize_slider("line_end_size","line_end_size_text","line_end_size");initialize_slider("curve_end_size","curve_end_size_text","curve_end_size");$("#delay")&&initialize_slider("delay","delay_text","delay");$("html").click(function(a){"tactic_name"!=a.target.id&&$('[data-toggle="popover"]').popover("hide")});$('[data-toggle="popover"]').popover({container:"body",trigger:"manual",html:"true",template:'<div class="popover popover-medium" style="width: 300px;"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"></div></div></div>',
content:function(){return $("#popover-content")}}).click(function(a){$(this).popover("toggle");document.getElementById("tactic_name").setAttribute("value",tactic_name);$(this);$(document).on("click","#store_tactic",function(a){var b=$(document).find("#tactic_name")[0].value,b=escapeHtml(b);""==b?alert("Empty name, tactic not stored"):(tactic_name=b,document.title="Tactic - "+tactic_name,socket.emit("store",room,b),$("#save").show(),alert("Tactic stored as: "+b),a.stopPropagation())});a.stopPropagation()});
$("#slide_table").on("click","tr",function(){var a=$(this).attr("id");active_slide!=a&&(socket.emit("change_slide",room,a),change_slide(a))});$("#prev_slide").click(function(){var a=find_previous_slide(room_data.slides[active_slide].order);0!=a&&(socket.emit("change_slide",room,a),change_slide(a))});$("#next_slide").click(function(){var a=find_next_slide(room_data.slides[active_slide].order);0!=a&&(socket.emit("change_slide",room,a),change_slide(a))});$("#new_slide").click(function(){var a=create_new_slide(active_slide);
socket.emit("new_slide",room,a);add_slide(a);change_slide(a.uid)});$("#remove_slide").click(function(){1<Object.keys(room_data.slides).length&&(socket.emit("remove_slide",room,active_slide),remove_slide(active_slide))});$("#save").click(function(){tactic_name&&""!=tactic_name&&socket.emit("store",room,tactic_name)});$("#slide_name_field").focusout(function(){rename_slide(active_slide,$(this).val());socket.emit("rename_slide",room,active_slide,$(this).val())});$("#slide_name_field").keyup(function(a){13==
a.keyCode&&(rename_slide(active_slide,$(this).val()),socket.emit("rename_slide",room,active_slide,$(this).val()))});$("#link").click(function(){document.queryCommandSupported("copy");var a=document.createElement("textarea"),b="http://"+location.host+location.pathname+"?room="+room;a.value=b;document.body.appendChild(a);window.prompt("Copy to clipboard and share with friends:",b);document.body.removeChild(a)});$("#chat_input").keyup(function(a){13==a.keyCode&&(a=my_user.name+": "+$("#chat_input").val()+
"\n",socket.emit("chat",room,a,chat_color),chat(a,chat_color),$("#chat_input").val(""))});$("#export").click(function(){var a=new PIXI.CanvasRenderer(size_x,size_y,{backgroundColor:12303291});a.render(objectContainer);$.getScript("http://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2014-11-29/FileSaver.min.js",function(){$.getScript("http://cdnjs.cloudflare.com/ajax/libs/javascript-canvas-to-blob/3.3.0/js/canvas-to-blob.min.js",function(){a.view.toBlob(function(a){tactic_name&&""!=tactic_name?saveAs(a,
tactic_name+".jpg"):saveAs(a,"map.jpg")})})})});$("#backup").click(function(){$.getScript("https://cdnjs.cloudflare.com/ajax/libs/jszip/2.5.0/jszip.min.js",function(){var a=active_slide,b=new JSZip,d=new PIXI.CanvasRenderer(size_x,size_y,{backgroundColor:12303291}),e=find_first_slide(),f=1,g=function(e){change_slide(e);var h=setInterval(function(){if(0==resources_loading){d.render(objectContainer);var k=d.view.toDataURL("image/jpeg",.9),k=k.replace("data:image/jpeg;base64,","");b.file(f.toString()+
"-"+room_data.slides[e].name+".jpg",k,{base64:!0});f++;next_slide_uid=find_next_slide(room_data.slides[e].order);if(0!=next_slide_uid)clearInterval(h),g(next_slide_uid);else{clearInterval(h);d.destroy();var k={},m;for(m in room_data.slides[active_slide].entities)room_data.slides[active_slide].entities.hasOwnProperty(m)&&room_data.slides[active_slide].entities[m].container&&(k[m]=room_data.slides[active_slide].entities[m].container,delete room_data.slides[active_slide].entities[m].container);b.file("tactic.json",
JSON.stringify(room_data,null,2));for(m in room_data.slides[active_slide].entities)room_data.slides[active_slide].entities.hasOwnProperty(m)&&k[m]&&(room_data.slides[active_slide].entities[m].container=k[m]);$.getScript("http://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2014-11-29/FileSaver.min.js",function(){var a=b.generate({type:"blob"});tactic_name&&""!=tactic_name?saveAs(a,tactic_name+".zip"):saveAs(a,"backup.zip")});change_slide(a);render_scene()}}},50)};g(e)})});$(".icon_group").each(function(){var a=
this.id;$("#"+a).click(function(){var b=$("#"+a+"_list").text().split("\n"),b=b.map(function(a){return encodeURIComponent(a.trim())}),b=b.filter(function(a){return""==a?!1:!0}),d=$("#"+a+"_list").attr("data-path"),e=parseFloat($("#"+a+"_list").attr("data-scale")),f=parseFloat($("#"+a+"_list").attr("data-height")),g=$("#"+a+"_list").attr("data-no_color"),h=$("#"+a+"_list").attr("data-style");if(!$.trim($("#"+a+"_menu").html()))if(h)for(var k in b)$("#"+a+"_menu").append('<button data-toggle="tooltip" title="'+
b[k]+'" class="tank_select" data-scale="'+e+'" data-no_color="'+g+'" id="'+d+"/"+b[k]+'"><div class="'+d+" "+d+"-"+b[k].slice(0,-4)+' inline"></div></button>');else for(k in b)$("#"+a+"_menu").append("<img height="+f+' class="tank_select" data-scale="'+e+'" data-no_color="'+g+'" id="'+d+"/"+b[k]+'" data-toggle="tooltip" title="'+b[k]+'" src='+image_host+d+"/"+b[k]+"></img>")})});$("[id^=icon][id$=context]").each(function(){$(this).find("a:first").trigger("click")});$("#lock").click(function(){is_room_locked=
$(this).find("div").hasClass("icon-lock")?!1:!0;update_lock();socket.emit("lock_room",room,is_room_locked)});$("#lock_camera").click(function(){var a=$(this).find("div");a.hasClass("icon-lock_camera")?(a.removeClass("icon-lock_camera").addClass("icon-unlock_camera"),emit_pan_zoom(),control_camera=!0):(a.removeClass("icon-unlock_camera").addClass("icon-lock_camera"),control_camera=!1)});$("#grid").click(function(){grid_layer.visible=!grid_layer.visible;room_data.slides[active_slide].show_grid=grid_layer.visible;
can_edit()&&socket.emit("show_grid",room,active_slide,grid_layer.visible);render_scene()});$("#zoom_in").click(function(){zoom(.1,!0,[.5,.5]);$("#zoom_level").text((1/zoom_level).toFixed(2));control_camera&&emit_pan_zoom()});$("#zoom_out").click(function(){zoom(1-1/1.1,!1,[.5,.5]);$("#zoom_level").text((1/zoom_level).toFixed(2));control_camera&&emit_pan_zoom()});$("#contexts").on("click","button",function(a){stop_drawing();setup_mouse_events(void 0,void 0);new_drawing=null;graphics&&objectContainer.removeChild(graphics);
new_drawing&&(new_drawing=void 0);current_text_element=void 0;if("undo"==$(this).attr("id"))undo();else if("redo"==$(this).attr("id"))redo();else if("cut"==$(this).attr("id"))cut();else if("copy"==$(this).attr("id"))copy();else if("paste"==$(this).attr("id"))paste();else if("clear_all_main"==$(this).attr("id"))clear();else{shifted&&objectContainer.mouseup&&(shifted=!1,objectContainer.mouseup(renderer.plugins.interaction.eventData),shifted=!0);$("#contexts").find("button").removeClass("active");$(this).addClass("active");
a=$(this).attr("id")+"_context";var b=$(this).attr("id")+"_context";"sc2"==game&&"icon"==b.substring(0,4)&&$("#icon_options").detach().appendTo($("#"+b));$(this).attr("data-context")&&(a=$(this).attr("data-context")+"_context");my_tracker&&stop_tracking();"track_context"==a&&start_tracking({x:2E3,y:2E3});if(active_menu!=b)switch("remove_context"!=a&&(deselect_all(),render_scene()),$("#"+active_menu).hide(),$("#"+b).show(),active_menu=b,active_context=a,active_context){case "ping_context":case "track_context":case "icon_context":case "note_context":case "text_context":case "remove_context":case "eraser_context":case "background_text_context":case "select_context":enable_dragging();
break;case "draw_context":case "ruler_context":case "rectangle_context":case "circle_context":case "line_context":case "curve_context":case "polygon_context":disable_dragging()}}});$("#label_pos").on("click","button",function(a){$("#label_pos").find("button").removeClass("active");$(this).addClass("active");label_position=this.id});$('#rectangle_type button[data-style="full"]').addClass("active");$("#rectangle_type").on("click","button",function(a){$(this).addClass("active");$(this).siblings().removeClass("active")});
$('#circle_type button[data-style="full"]').addClass("active");$("#circle_type").on("click","button",function(a){$(this).addClass("active");$(this).siblings().removeClass("active")});$('#circle_draw_style button[data-draw_style="edge"]').addClass("active");$("#circle_draw_style").on("click","button",function(a){$(this).addClass("active");$(this).siblings().removeClass("active")});$('#polygon_type button[data-style="full"]').addClass("active");$("#polygon_type").on("click","button",function(a){$(this).addClass("active");
$(this).siblings().removeClass("active")});$('#area_type button[data-style="full"]').addClass("active");$("#area_type").on("click","button",function(a){$(this).addClass("active");$(this).siblings().removeClass("active")});$('#line_type button[data-style="full"]').addClass("active");$("#line_type").on("click","button",function(a){$(this).addClass("active");$(this).siblings().removeClass("active")});$('#line_end_type button[data-end="arrow"]').addClass("active");$("#line_end_type").on("click","button",
function(a){$(this).addClass("active");$(this).siblings().removeClass("active")});$('#curve_type button[data-style="full"]').addClass("active");$("#curve_type").on("click","button",function(a){$(this).addClass("active");$(this).siblings().removeClass("active")});$('#curve_end_type button[data-end="arrow"]').addClass("active");$("#curve_end_type").on("click","button",function(a){$(this).addClass("active");$(this).siblings().removeClass("active")});$('#track_shape button[data-cursor="cursor"]').addClass("active");
$("#track_shape").on("click","button",function(a){$(this).addClass("active");$(this).siblings().removeClass("active");my_tracker&&stop_tracking();start_tracking({x:2E3,y:2E3})});$('#draw_type button[data-style="full"]').addClass("active");$("#draw_type").on("click","button",function(a){$(this).addClass("active");$(this).siblings().removeClass("active")});$('#draw_end_type button[data-end="arrow"]').addClass("active");$("#draw_end_type").on("click","button",function(a){$(this).addClass("active");$(this).siblings().removeClass("active")});
$("#userlist").on("click","button",function(){var a=$(this).attr("id");if(a!=my_user.id&&"owner"==my_user.role)return userlist[a].role?"driver"==userlist[a].role?(userlist[a].role="owner",$(this).css("background-color","lime")):"owner"==userlist[a].role&&(delete userlist[a].role,$(this).css("background-color","")):(userlist[a].role="driver",$(this).css("background-color","yellow")),socket.emit("update_user",room,userlist[a]),!1});$("#clear_all").click(function(){clear()});$("#clear_draw").click(function(){clear("drawing")});
$("#clear_icons").click(function(){clear("icon")});$("#clear_lines").click(function(){clear("line")});$("#clear_text").click(function(){clear("text")});$("#clear_curve").click(function(){clear("curve")});$("#clear_rectangle").click(function(){clear("rectangle")});$("#clear_circle").click(function(){clear("circle")});$("#clear_polygon").click(function(){clear("polygon")});$("#clear_area").click(function(){clear("area")});$("#clear_selected").click(function(){clear_selected()});$("#clear_note").click(function(){clear("note")});
$("#nuke_room").click(function(){1==confirm("Warning: all unsaved data will be lost")&&socket.emit("nuke_room",room,game)});$("body").on("click",".tank_select",function(){$(".tank_select.selected").removeClass("selected");$(this).addClass("selected");selected_icon=$(this).attr("id");selected_icon_no_color="true"==$(this).attr("data-no_color")?!0:!1;icon_extra_scale=$(this).attr("data-scale")?parseFloat($(this).attr("data-scale")):1});assets_loaded=!0;socket.on("connect",function(){console.log("Connecting/Reconnecting");
socket.emit("join_room",room,game)});socket.connected&&socket.emit("join_room",room,game)});socket.on("room_data",function(a,b,d,e){cleanup();room_data=a;video_paused=a.video_paused;active_slide=room_data.active_slide;is_room_locked=room_data.locked;my_user_id=b;(tactic_name=d)&&""!=tactic_name&&(document.title="Tactic - "+tactic_name);for(var f in room_data.userlist)add_user(room_data.userlist[f]);var h=[],k,m;for(m in room_data.slides[active_slide].entities)"background"==room_data.slides[active_slide].entities[m].type?
k=room_data.slides[active_slide].entities[m]:h.push(room_data.slides[active_slide].entities[m]);try{h.sort(function(a,b){return a.z_index-b.z_index})}catch(n){}var v=function(){room_data.pan_zoom?pan_zoom(room_data.pan_zoom[0],room_data.pan_zoom[1],room_data.pan_zoom[2]):pan_zoom(1,0,0);wot_live&&wot_connect()};k?set_background(k,function(){if(background.is_video)rebuild_timeline(),room_data.playback_rate&&set_playback_rate(room_data.playback_rate,room_data.playback_rate);else for(var a in h)create_entity(h[a]);
v()}):v();for(m in room_data.trackers)create_tracker(room_data.trackers[m]);delete room_data.trackers;update_slide_buttons();update_my_user();my_tracker&&(stop_tracking(),start_tracking({x:2E3,y:2E3}));is_video_replay&&(sync_start_time=Date.now(),socket.emit("sync_clock"),clearInterval(clock_sync_event),clock_sync_event=setInterval(function(){sync_start_time=Date.now();socket.emit("sync_clock")},2E4));render_scene()});socket.on("create_entity",function(a,b,d){b!=active_slide?room_data.slides[b].entities[a.uid]=
a:create_entity(a);activity_animation(d)});socket.on("drag",function(a,b,d,e,f,h,k){b!=active_slide?room_data.slides[b].entities[a]&&(room_data.slides[b].entities[a].x=d,room_data.slides[b].entities[a].y=e,f&&(room_data.slides[b].entities[a].scale=f),h&&(room_data.slides[b].entities[a].rotation=h)):room_data.slides[b].entities[a]&&drag_entity(room_data.slides[active_slide].entities[a],d,e,f,h);activity_animation(k)});socket.on("ping_marker",function(a,b,d,e,f){ping(a,b,d,e);activity_animation(f)});
socket.on("chat",function(a,b){chat(a,b)});socket.on("identify",function(a){my_user?(my_user.logged_in=a.logged_in,my_user.name=a.name):my_user=a;update_my_user()});socket.on("remove",function(a,b,d){b!=active_slide?delete room_data.slides[b].entities[a]:remove(a);activity_animation(d)});socket.on("add_user",function(a){add_user(a)});socket.on("remove_user",function(a){remove_user(a)});socket.on("lock_room",function(a,b){is_room_locked=a;update_lock();activity_animation(b)});socket.on("change_slide",
function(a){a!=active_slide&&change_slide(a)});socket.on("new_slide",function(a,b){add_slide(a);activity_animation(b)});socket.on("remove_slide",function(a,b){1>=Object.keys(room_data.slides)?socket.emit("join_room",room,game):(remove_slide(a),activity_animation(b))});socket.on("rename_slide",function(a,b,d){rename_slide(a,b);activity_animation(d)});socket.on("change_slide_order",function(a,b,d){room_data.slides[a].order=b;update_slide_buttons();activity_animation(d)});socket.on("track",function(a,
b){trackers[a.uid]&&remove_tracker(uid);create_tracker(a);activity_animation(b)});socket.on("track_move",function(a,b,d){move_tracker(a,b,d)});socket.on("stop_track",function(a){remove_tracker(a)});socket.on("show_grid",function(a,b,d){room_data.slides[a].show_grid=b;a==active_slide&&(grid_layer.visible=b,render_scene());activity_animation(d)});socket.on("pan_zoom",function(a,b,d,e){activity_animation(a,b,d);pan_zoom(a,b,d)});socket.on("force_reconnect",function(){location.reload()});socket.on("play_video",
function(a,b,d,e){activity_animation(e);set_playback_rate(d,d);handle_play(a,b)});socket.on("pause_video",function(a,b){handle_pause(a);activity_animation(b)});socket.on("sync_video",function(a,b,d){handle_sync(a,b,d)});socket.on("request_sync",function(){if(im_syncing)for(var a=0;5>=a;a++)setTimeout(function(){var a=video_progress();socket.emit("sync_video",room,a,get_server_time())},2E3*a)});socket.on("sync_clock",function(a){var b=Date.now();offset=a+(b-sync_start_time)/2-b});socket.on("seek_video",
function(a,b,d){video_media.setCurrentTime(a);video_paused?video_player.pause():(handle_sync(a,b,d),wait_for_seek(function(){rebuild_timeline()}))});socket.on("change_rate",function(a){set_playback_rate(a,a)})});

//# sourceMappingURL=combined.js.map